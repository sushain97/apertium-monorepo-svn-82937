#!/usr/bin/env python3

import argparse, urllib.request, random, os
from lxml import etree

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="Create UDHR table")
    parser.add_argument('languages', nargs='+', help='list of languages for table')
    parser.add_argument('-p','--paragraph', help='number of paragraph to use in table', type=int, default=0)
    args = parser.parse_args()

    #for reference:
    langIds = {'': '', 'Filipino (Tagalog)': 'tgl', 'Kimbundu': 'mlo', 'Hani': 'hni', 'German (Deutsch)': 'ger', 'Hausa/Haoussa': 'gej', 'Sami/Lappish': 'lpi', 'Caquinte': 'cot', 'Limba': 'lia', 'Sango (Sangho)': 'saj', 'Dzongkha/Bhutanese': 'dzo', 'Mixteco': 'mxv', 'Cymraeg (Welsh)': 'wls', 'Vai': 'vai', 'Japanese (Nihongo)': 'jpn', 'Tshivenda': 'tsh', 'Fijian': 'fji', 'Suomi (Finnish)': 'fin', 'Uzbek (Cyrillic)': 'uzb1', 'Bahasa Indonesia': 'inz', 'Turkmen': 'tck', 'Portuguese': 'por', 'Maldivian (Dhivehi)': 'div', 'Mazahua (Jñatrjo)': 'maz', 'Dari': 'prs1', 'Ashéninca': 'cpu', 'Somali': 'som', 'Persian/Farsi': 'prs', 'Amahuaca': 'amc', 'Rukonzo (Konjo)': 'koo1', 'Shipibo-Conibo': 'shp', 'Pai Koka': '1123', 'Arabela': 'arl', 'Bari': 'bfa', 'Corsican': 'coi', "A'ingae": 'ccc', 'Rundi/Kirundi': 'rud1', 'Italian': 'itn', 'Norwegian (Bokmål) (Norsk, Bokmål)': 'nrr', 'Igbo': 'igr', 'Tetum': 'ttm', 'Bosnian (Cyrillic script)': 'src4', 'Northern Sotho/Pedi/Sepedi': 'srt', 'Inuktitut': 'esb', 'Sarnámi Hindustani': 'hns', 'Bahasa Melayu (Malay)': 'mli', 'Kurdish': 'kdb1', 'Ticuna': 'tca', 'Ndebele': 'nel', 'Kpelewo': 'gkp1', 'Pashto/Pakhto': 'pbu', 'Ladino': 'lad', 'Uighur': 'uig', 'Papiamentu': 'pap', 'Chin Matu (Nga La)': 'hlt', 'Bhojpuri': 'bhj', 'Kasem': 'kas', 'Hungarian': 'hng', 'Sanskrit': 'skt', 'Seereer': 'ses', 'Crioulo (Cabo Verde)': 'kea', 'Hmong (Miao) Northern East-Guizhou': 'hea', 'Serbian (Cyrillic) (Srpski)': 'src5', 'Ewe/Eve': 'ewe', 'Luba-Kasai (Tshiluba)': 'lub', "Q'echi/Kekchi": '1116', 'Tongan (Tonga)': 'tov', 'Tamazight (Beraber)': 'tzm', 'Akuapem Twi': 'tws1', 'Kyrgyz': 'kdo', 'Guen (Mina)': 'hna', 'Toba': 'tob', 'Low German (Niederdeutsche)': 'ige', 'Garhwali': 'gbm', 'Yukagir': 'ykg', 'Bulgarian (Balgarski)': 'blg', 'Español (Spanish)': 'spn', 'Kibushi': 'buc', 'Tonga': 'toi', 'Ao': 'njo', 'Czech (Cesky)': 'czc', 'Rajasthani': 'raj', 'Kazakh': 'kaz', 'Magyar (Hungarian)': 'hng', 'Luvale': 'lue', 'Shuar Chicham': '1125', 'Dangme': 'gac1', 'Mongolian (Khalkha)': 'khk', 'Adyghe': 'ady', 'Tatar': 'ttr', 'Mapudungun (Mapuzgun)': 'aru', 'Basque (Euskara)': 'bsq', 'Maninka': 'mni', 'Komi-Permian': 'koi', 'Kapampangan': 'pmp', 'Tiv': 'tiv', 'Paez': 'pbb', 'Kinyarwanda': 'rua1', 'Rhaeto-Romance (Rumantsch)': 'rhe', 'Lithuanian (Lietuviskai)': 'lit', 'Purhépecha': '1112', 'Tchocwe (Angola)': 'cjk', 'Soninké (Soninkanxaane)': 'snn', 'Xhosa': 'xos', 'Navaho (Dine, Navajo)': 'nav', 'Mayan (Yucateco)': 'yua', 'Hrvatski (Croatian)': 'src2', 'Bosnian (Latin script)': 'src1', 'Achuar Chicham': 'jiv', 'Candoshi-Shapra': 'cbu', 'Quechua de Cajamarca': 'qnt', 'Shilluk': 'shk', 'Afrikaans': 'afk', 'Shan': 'sjn', 'Yagua': 'yad', 'Mizo': 'lus', 'Saraiki': 'skr', 'Nzema': 'nze', 'Dhivehi (Maldivian)': 'div', 'Balochi': 'bgp', 'Marwari': 'mkd', 'Assamese': 'asm', 'Kannada': 'kjv', 'Arabic (Alarabia)': 'arz', 'Ibibio': 'ibb', 'Nanai': 'gld', 'Ga': 'gac2', 'Venetian': 'vec', 'Turkish (Türkçe)': 'trk', 'Bengali': 'bng', 'Haitian Creole (Kreyol)': 'hat', 'Crioulo da Guiné-Bissau (Guinea Bissau Creole)': 'gbc', 'Amuesha-Yanesha': 'ame', 'Waray': 'wry', 'Punjabi/Panjabi': 'pnj1', 'Huastec, Veracruz': 'hus', 'Yakut': 'sah', 'Scottish Gaelic': 'gls', 'Chayahuita': 'cbt', 'Tigrinya (Tigrigna)': 'tgn', 'Achuar-Shiwiar': 'acu', 'Nganasan': 'nio', 'Kharia': 'khr', 'Romanian (Româna)': 'rum', 'Minangkabau': 'mpu', 'Awadhi': 'awa', 'Gonja': 'dum', "Chaa'pala": '1122', 'Evenki': 'evn', 'Assyrian (Atoraya)': 'aii', 'Nivkh': 'Nivkh', 'Yoruba (Yorùbá)': 'yor', 'Umbundu': 'mnf', 'Polish (Polski)': 'pql', 'Albanian': 'aln', 'Wolof': 'wol', 'Chickasaw': 'cic', 'Danish (Dansk)': 'dns', 'Balinese': 'bzc', 'Quechua del Norte de Junin': 'qju', 'Wayuu': 'guc', 'Huitoto Murui': 'huu', 'Gaeilge (Irish Gaelic)': 'gli1', 'Romani': 'rmn1', 'Gondi, Northern': 'gno', 'Kanuri Yerwa': 'kph', 'Quichua': 'qud1', 'Chhattisgarhi': 'hne', 'Nyamwezi (Kinyamwezi)': 'nyz', 'Tibetan': 'tic', 'Walloon/Wallon': 'frn1', 'Galician (Galego)': 'gln', 'Thai': 'thj', 'Kinyamwezi (Nyamwezi)': 'nyz', 'Pulaar': 'fum1', 'Esperanto': '1115', "Greek (Ellinika')": 'grk', 'Mozarabic (Ajami)': 'moz', 'Mende': 'mfy', "Karen (S'gaw)": 'ksw', 'Nigerian Pidgin English': 'pcm', 'Khasi': 'kha', 'Oromiffa (Afaan Oromo)': 'gax', 'Niederdeutsche (Low German)': 'ige', 'Sindhi': 'snd', 'Tének (Huasteco)': '1118', 'Scots': 'sco', 'Miskito': 'miq', 'Diola (Jola-Fogny)': 'dyo', 'Gagauz': 'gag', 'Rarotongan (Maori (Cook Islands))': 'rrt', 'Latin (Latina)': 'ltn1', 'Chechewa (Nyanja)': 'nyj1', 'Oshiwambo (Ndonga)': '1114', 'Dine, Navajo (Navaho)': 'nav', 'Khakas': 'kjh', 'Cebuano': 'ceb', 'Magahi': 'mqm', 'Western Sotho/Tswana/Setswana': 'tsw', 'Sapara Atupama': '1124', 'Fante': 'tws3', 'Yao': 'yao', 'Garifuna': 'cab', 'Chuuk (Trukese)': 'tru1', 'Shqip (Albanian)': 'aln', 'Changane (Mozambique)': 'tso', 'Fon': 'foa', 'Ngangela (Nyemba)': 'nba', 'Tshiluba (Luba-Kasai)': 'lub', 'Farsi/Persian': 'prs', 'Ditammari': 'tbz', 'Marshallese': 'mzm', 'Euskara (Basque)': 'bsq', 'Lunda/Chokwe-lunda': 'mlo1', 'Serbian (Latin) (Srpski)': 'src3', 'Even': 'eve', 'Sardinian': 'srd', 'Nepali': 'nep', 'Swedish (Svenska)': 'swd', 'Wao Tededo': '1127', 'Iloko/Ilocano': 'ilo', 'Pipil': 'ppl', 'Mbundu (Kimbundu)': 'mlo', 'Krio': 'kri', 'Ñahñú (Otomí)': '1111', 'Abkhaz': 'abk', 'Samoan': 'smy', 'Kurmanji': 'kur', 'Kabyè': 'kbp', 'French (Français)': 'frn', 'Edo': 'edo', 'Haitian Creole (popular)': 'hat1', 'Sukuma': 'sua', 'Efik (Ibibio)': 'ibb', 'Yanomamö': 'guu', 'Russian (Russky)': 'rus', 'Maltese': 'mls', 'Deutsch (German)': 'ger', 'Kichwa': 'qug', 'Tahitian': 'tht', 'Bai Coca': '1121', 'Khmer': 'khm', 'Quechua de Pomabamba (Ancash)': 'qed', 'Wama': 'ako', 'Ido': '1120', 'Bichelamar': 'bcy', 'Georgian': 'geo', 'Palauan': 'plu', 'Gujarati': 'gjr', 'Amarakaeri': 'amr', 'Malagasy': 'mex', 'Hawaiian': 'hwi', 'Maithili': 'mai', 'Zapoteco, San Lucas Quiaviní': 'ztu1', 'Themne (Temne)': 'tej', 'Slovenian (Slovenscina)': 'slv', 'Nyanja/Chinyanja': 'nyj', "Kikongo ya L'Etat (Kikongo/Kituba)": 'kon', 'Ivrit (Hebrew)': 'hbr', 'Batonu (Bariba)': 'bba', 'Tamasheq': 'taq', 'Peuhl': 'fum', 'Asháninca': 'cni', 'English': 'http://www.ohchr.org/EN/Pages/WelcomePage.aspx', 'Shimaore': 'swb', 'Tzotzil': 'tzc', 'Telugu': 'tcw', 'Tamil': 'tcv', 'Otomí (Ñahñú)': '1111', 'Sorbian': 'wee', 'Breton': 'brt', 'Lingala': 'lin', 'Jola-Fogny (Diola)': 'dyo', 'Quechua de Margos (Sur de Dios de Mayo, Huanuco)': 'qei', "Ellinika' (Greek)": 'grk', 'Huasteco': 'hva', 'Koits-Sunuwar': 'suz', 'Quechua de Ayacucho': 'quy', 'Santhali': 'sat', 'Sinhala': 'snh', 'Mooré/More': 'mhm', 'Forro': '1128', 'Malayalam': 'mjs', "K'iche' (Quiché)": '1117', 'Bemba': 'bem', 'Pijin (Solomons Pidgin)': 'pis', 'Khalkha (Mongolian)': 'khk', 'Lao': 'nol', 'Burmese/Myanmar': 'bms', 'Yiddish': 'ydd', 'Greenlandic (Inuktikut)': 'esg', 'Afaan Oromo (Oromiffa)': 'gax', 'Swahili/Kiswahili': 'swa', 'Chinanteco': 'csa', 'Asturian (Bable)': 'aub', 'Cashibo-Cacataibo': 'cbr', 'Hmong (Miao), Sichuan-Guizhou-Yunnan': 'blu', 'Totonaco': 'top', 'Latvian': 'lat', 'Guarayo': 'gua', 'Kanauji': 'bjj', 'Norwegian (Nynorsk) (Norsk, Nynorsk)': 'nrn', 'Veps': 'vep', 'Dagaare': 'dga', 'Quechua': 'qec1', 'Chinese (Mandarin)': 'chn', 'Koulango': 'kou', 'Solomons Pidgin (Pijin)': 'pis', 'Faroese': 'fae', 'Kashmiri': 'ksh', 'Nenets': 'yrk', 'Adja': 'ajg', 'Oriya': 'ory', 'Altay': 'alt', 'Tamang (Tam)': 'taj', 'Sharanahua': 'mcd', 'Shona': 'shd', 'Lozi': 'lbm1', 'Occitan Languedocien': 'prv1', 'Mikmaq/Micmac': 'mic', 'Vietnamese': 'vie', 'Kabardian': 'kbd', 'Awapit': 'kwi', 'Nihongo (Japanese)': 'jpn', 'Amharic': 'amh', 'Quechua del Callejon de Huaylas': 'qan', 'Sammarinese': 'eml', 'Zapoteco': 'zam', 'Bora': 'boa', 'Yi': 'iii', 'Nomatsiguenga': 'not', 'Campa pajonalino': 'cpp', 'Makonde': 'kde', 'Icelandic (íslenska)': 'ice', "Tojol-a'b'al": 'toj', 'Bugisnese': 'bpr', 'Dagbani': 'dag', 'Uilta': 'oaa', 'Ho': 'Hoc', 'Inuktikut (Greenlandic)': 'esg', 'Seselwa Creole French': 'crs', 'Macedonian': 'mkj', 'Indonesian': 'inz', 'Picard': 'frn2', 'Maori': 'mbf', 'Cokwe': 'cjk', 'Aymara': 'aym', 'Chin Hakha': 'hak', 'Mazateco': 'mao', 'Chin Falam': 'fal', 'Prouvençau': 'pro', 'Hebrew': 'hbr', 'Dioula': 'dyu', 'Friulian (Friulano)': 'frl', 'Tok Pisin': 'pdg', 'Kreyol (Haitian Creole)': 'hat', 'Armenian': 'arm', 'Guarani': 'gun', 'Vlach': 'rmy1', 'Kaonde': 'kqn', 'Javanese': 'jan', 'Sussu/Soussou/Sosso/Soso/Susu': 'sus', 'Tsafiki': 'cof', 'Karen (Pwo)': 'pwo', 'Bable (Asturian)': 'aub', 'Chin Tiddim': 'tid', 'Interlingua': '1119', 'Urarina': 'ura', 'Dendi': 'den', 'Urdu': 'urd', 'Zhuang': 'ccx', 'Universal declaration': 'http://www.ohchr.org/EN/UDHR/Pages/UDHRIndex.aspx', 'Karelian': 'krl', 'OHCHR': 'http://www.ohchr.org/Pages/VariationRoot.aspx', 'Bikol/Bicolano': 'bkl', 'Slovak (Slovencina)': 'slo', 'Kurug': 'kfa', 'Chamorro': 'cjd', 'Mundari': 'unr', 'Uzbek (Latin)': 'uzb', 'Belorus (Belaruski)': 'ruw', 'Ponapean': 'pnf', 'Matsés': 'mcf', 'Finnish': 'fin', 'Nyanja (Chechewa)': 'nyj1', 'Zulu': 'zuu', 'Runyankore-rukiga/Nkore-kiga': 'nyn1', 'Cashinahua': 'cbs', 'Swampy Cree': 'crm', 'Dinka': 'dinka', "Ukrainian (Ukrayins'ka)": 'ukr', 'Luganda/Ganda': 'lap1', 'Achehnese': 'atj', 'Trukese (Chuuk)': 'tru1', 'Malay (Bahasa Melayu)': 'mli', 'Luxembourgish (Lëtzebuergeusch)': 'lux', 'Korean (Hankuko)': 'kkn', "Lamnso' (Lám nso')": 'nso', 'Frisian': 'fri', 'Marathi': 'mrt', 'Sia Pedee': '1126', 'Nuer': 'nus', 'Aguaruna': 'agr', 'Mam': 'mam', 'Irish Gaelic': 'gli1', 'Shor': 'cjs', 'Quechua de Cotahuasi (Arequipa)': 'qar', 'Azeri/Azerbaijani (Latin)': 'azb', 'Makua (Mozambique)': 'vmw', 'Cakchiquel': 'cak1', 'Maori (Cook Islands) (Rarotongan)': 'rrt', 'Estonian (Eesti)': 'est', 'Madurese': 'mhj', 'Croatian': 'src2', 'Southern Sotho/Sotho/Sesotho/Sutu/Sesutu': 'sso', 'Hankuko (Korean)': 'kkn', 'Pular': 'fuf', 'Tajik': 'pet', 'Quechua del Cusco': 'quz', 'Otuho': 'lot', 'Balanda Viri': 'bvi', 'Talysh': 'tly', 'Jñatrjo (Mazahua)': 'maz', 'Chiquitano': 'cax', 'Azeri/Azerbaijani (Cyrillic)': 'azb1', 'Manipuri': 'bpy', 'Lobiri': 'lob', 'Chinanteco, Ajitlán': 'chj', 'Yapese': 'yps', 'Baoulé/Baule': 'bci', 'Catalan (Català)': 'cln', 'Quechua de Huamalies (Huanuco)': 'qej', 'Nahuatl': 'nhn', 'Hmong (Miao) Southern East-Guizhou': 'hms', 'Fiote (Angola)': 'kng', 'Spanish (Español)': 'spn', 'Béti': 'btb', 'Dutch (Nederlands)': 'dut', 'Hindi': 'hnd', 'Tuvan': 'tyv', 'Occitan Auvergnat': 'auv1', 'Gàidhlig Albanach (Scottish Gaelic)': 'gls', 'Bambara': 'bra', 'Sundanese': 'suo', 'Ossetian': 'oss', 'Siswati': 'swz1', 'Welsh (Cymraeg)': 'wls', 'Hiligaynon': 'hil', 'Tzeltal': 'tzc1', 'Quechua de Ambo-Pasco': 'qeg', 'Asante': 'ass', 'Nederlands (Dutch)': 'dut', 'Ojibway (Ojibwe)': 'ojb', 'Ogiek': 'oki'}

    table = '''{|class=wikitable\n! Language !! Text'''

    for language in args.languages:
        try:
            link = 'http://www.unicode.org/udhr/d/udhr_%s.xml' % language
            xml = str((urllib.request.urlopen(link)).read(), 'utf-8').replace('encoding="UTF-8"', '').replace('xmlns="http://www.unhchr.ch/udhr"', '')
            randomFileName = "%0.12d.tmp" % random.randint(100000000000, 999999999999)
            with open(randomFileName, 'w') as f:
                f.write(xml)
            tree = etree.parse(randomFileName).getroot()
            os.remove(randomFileName)
            languageName = tree.get('language')
            paragraph = tree.xpath('descendant-or-self::article/descendant::para')[0].text
            table += '\n|-\n|| {} || {}'.format(languageName, paragraph)
            print('Scraped passage for %s through www.unicode.org' % language)
        except urllib.error.HTTPError:
            print('Unable to locate XML for %s through www.unicode.org' % language)
            try:
                parser = etree.HTMLParser()
                link = 'http://www.ohchr.org/EN/UDHR/Pages/Language.aspx?LangID=%s' % language
                tree = etree.parse(link, parser)
                languageName = tree.xpath("descendant-or-self::*[@id = 'ctl00_PlaceHolderMain_usrUDHRLanguage_lblLangVersionID']")[0].text
                paragraph = tree.xpath("descendant-or-self::h4/following-sibling::*[name() = 'p' and (position() = 1)]")[1].text
                table += '\n|-\n|| {} || {}'.format(languageName, paragraph)
                print('Scraped passage for %s through www.ohchr.org' % language)
            except IndexError:
                print('Unable to scrape passage for %s through www.ohchr.org' % language)
            

    table += '\n|}'
    print(table)
