<?xml version="1.0" encoding="UTF-8"?>
<transfer default="chunk">
<section-def-cats>
<def-cat n="prn">
   <cat-item tags="prn.*"/>
</def-cat>
<def-cat n="prn_tn_fort">
   <cat-item lemma="jo" tags="prn.tn.*"/>
   <cat-item lemma="tu" tags="prn.tn.*"/>
   <cat-item lemma="ell" tags="prn.tn.*"/>
   <cat-item lemma="ells" tags="prn.tn.*"/>
   <cat-item lemma="vostè" tags="prn.tn.*"/>
   <cat-item lemma="nosaltres" tags="prn.tn.*"/>
   <cat-item lemma="vosaltres" tags="prn.tn.*"/>
   <cat-item lemma="vós" tags="prn.tn.*"/>
   <cat-item lemma="ells" tags="prn.tn.*"/>
   <cat-item lemma="elles" tags="prn.tn.*"/>
   <cat-item lemma="vostès" tags="prn.tn.*"/>
</def-cat>
<def-cat n="tn-pers">
   <cat-item tags="prn.tn.p1.*"/>
   <cat-item tags="prn.tn.p2.*"/>
   <cat-item tags="prn.tn.p3.*"/>
   <cat-item tags="prn.tn.ref.p3.*"/>
</def-cat>
<def-cat n="prnpro">
   <cat-item tags="prn.pro.*"/>
</def-cat>
<def-cat n="prnproref">
  <cat-item lemma="em" tags="prn.pro.p1.mf.sg"/>
  <cat-item lemma="et" tags="prn.pro.p2.mf.sg"/>
  <cat-item lemma="es" tags="prn.pro.ref.p3.mf.sp"/>
  <cat-item lemma="ens" tags="prn.pro.p1.mf.pl"/>
  <cat-item lemma="us" tags="prn.pro.p2.mf.pl"/>
</def-cat>
<def-cat n="es">
   <cat-item lemma="es" tags="prn.pro.ref.p3.mf.sp"/>
</def-cat>
<def-cat n="tot_prn">
   <cat-item lemma="tot" tags="prn.tn.m.sg"/>
</def-cat>
<def-cat n="estat_sigut">
   <cat-item lemma="estar" tags="vblex.pp.*"/>
   <cat-item lemma="ser" tags="vbser.pp.*"/>
</def-cat>
<def-cat n="det">
   <cat-item tags="det.*"/>
</def-cat>
<def-cat n="det_pos">
   <cat-item tags="det.pos.*"/>
</def-cat>
<def-cat n="det_pl">
   <cat-item tags="det.*.pl"/>
</def-cat>
<def-cat n="det_pos_pl">
   <cat-item tags="det.pos.*.pl"/>
</def-cat>
<def-cat n="un">
   <cat-item lemma="un" tags="det.*"/>
</def-cat>
<def-cat n="el_m_sg">
   <cat-item lemma="el" tags="det.def.m.sg"/>
</def-cat>
<def-cat n="num">
   <cat-item tags="num"/>
   <cat-item tags="num.*"/>
</def-cat>
<def-cat n="nom">
   <cat-item tags="abbr"/>
   <cat-item tags="n.*"/>
</def-cat>
<def-cat n="nom_pl">
   <cat-item tags="n.*,pl"/>
</def-cat>
<def-cat n="èssere_pri">
   <cat-item lemma="èssere" tags="vblex.pri.*"/>
</def-cat>
<def-cat n="èssere_p3">
   <cat-item lemma="èssere" tags="vblex.*.p3.sg"/>
   <cat-item lemma="èssere" tags="vblex.*.p3.pl"/>
</def-cat>
<def-cat n="cni">
   <cat-item tags="vblex.cni.*"/>
   <cat-item tags="vbmod.cni.*"/>
   <cat-item tags="vbhaver.cni.*"/>
   <cat-item tags="vbser.cni.*"/>
</def-cat>
<def-cat n="fti">
   <cat-item tags="vblex.fti.*"/>
   <cat-item tags="vbmod.fti.*"/>
   <cat-item tags="vbhaver.fti.*"/>
   <cat-item tags="vbser.fti.*"/>
</def-cat>
<def-cat n="ifi">
   <cat-item tags="vblex.ifi.*"/>
   <cat-item tags="vbmod.ifi.*"/>
   <cat-item tags="vbhaver.ifi.*"/>
   <cat-item tags="vbser.ifi.*"/>
</def-cat>
<def-cat n="vbser_estar-ifi">
   <cat-item tags="vbser.ifi.*"/>
   <cat-item lemma="estar" tags="vblex.ifi.*"/>
   <cat-item lemma="quedar" tags="vblex.ifi.*"/>
</def-cat>
<def-cat n="hi">
   <cat-item lemma="hi" tags="prn.pro.adv"/>
</def-cat>
<def-cat n="algun_prn">
   <cat-item lemma="algun" tags="prn.*"/>
</def-cat>
<def-cat n="pr">
   <cat-item tags="pr"/>
</def-cat>
<def-cat n="a">
   <cat-item lemma="a" tags="pr"/>
</def-cat>
<def-cat n="de">
   <cat-item lemma="de" tags="pr"/>
</def-cat>
<def-cat n="en">
   <cat-item lemma="en" tags="pr"/>
</def-cat>
<def-cat n="malgrat">
   <cat-item lemma="malgrat" tags="pr"/>
</def-cat>
<def-cat n="haver">
   <cat-item lemma="haver" tags="vbhaver.*"/>
</def-cat>
<def-cat n="haver_p3">
   <cat-item lemma="haver" tags="vbhaver.*.p3.sg"/>
</def-cat>
<def-cat n="haver-inf">
   <cat-item lemma="haver" tags="vbhaver.inf"/>
</def-cat>
<def-cat n="haver-ifi">
   <cat-item lemma="haver" tags="vbhaver.ifi.*"/>
</def-cat>
<def-cat n="haver-fti">
   <cat-item lemma="haver" tags="vbhaver.fti.*"/>
</def-cat>
<def-cat n="haver-cni">
   <cat-item lemma="haver" tags="vbhaver.cni.*"/>
</def-cat>
<def-cat n="haver-tmp-srd-cnj">	<!-- verb amb els temps verbals conjugats (amb persona) del sard (sense cni, ifi, fti) -->
   <cat-item lemma="haver" tags="vbhaver.pri.*"/>
   <cat-item lemma="haver" tags="vbhaver.prs.*"/>
   <cat-item lemma="haver" tags="vbhaver.pii.*"/>
   <cat-item lemma="haver" tags="vbhaver.pis.*"/>
   <cat-item lemma="haver" tags="vbhaver.imp.*"/>
<!--
   <cat-item lemma="haver" tags="vbhaver.inf"/>
   <cat-item lemma="haver" tags="vbhaver.ger"/>
   <cat-item lemma="haver" tags="vbhaver.pp.*"/>
-->
</def-cat>
<def-cat n="haver-tmp-srd-cnj-p3">	<!-- verb amb els temps verbals conjugats (amb persona) del sard (sense cni, ifi, fti) -->
   <cat-item lemma="haver" tags="vbhaver.pri.p3.*"/>
   <cat-item lemma="haver" tags="vbhaver.prs.p3.*"/>
   <cat-item lemma="haver" tags="vbhaver.pii.p3.*"/>
   <cat-item lemma="haver" tags="vbhaver.pis.p3.*"/>
   <cat-item lemma="haver" tags="vbhaver.imp.p3.*"/>
</def-cat>
<def-cat n="haver-tmp-srd-cnj-p3sg">	<!-- verb amb els temps verbals conjugats (amb persona) del sard (sense cni, ifi, fti) -->
   <cat-item lemma="haver" tags="vbhaver.pri.p3.sg"/>
   <cat-item lemma="haver" tags="vbhaver.prs.p3.sg"/>
   <cat-item lemma="haver" tags="vbhaver.pii.p3.sg"/>
   <cat-item lemma="haver" tags="vbhaver.pis.p3.sg"/>
   <cat-item lemma="haver" tags="vbhaver.imp.p3.sg"/>
</def-cat>
<def-cat n="seguir-tmp-srd-cnj">
   <cat-item lemma="seguir" tags="vblex.pri.*"/>
   <cat-item lemma="seguir" tags="vblex.prs.*"/>
   <cat-item lemma="seguir" tags="vblex.pii.*"/>
   <cat-item lemma="seguir" tags="vblex.pis.*"/>
   <cat-item lemma="seguir" tags="vblex.imp.*"/>
<!--
   <cat-item lemma="seguir" tags="vblex.inf"/>
   <cat-item lemma="seguir" tags="vblex.ger"/>
   <cat-item lemma="seguir" tags="vblex.pp.*"/>
-->
   <cat-item lemma="continuar" tags="vblex.pri.*"/>
   <cat-item lemma="continuar" tags="vblex.prs.*"/>
   <cat-item lemma="continuar" tags="vblex.pii.*"/>
   <cat-item lemma="continuar" tags="vblex.pis.*"/>
   <cat-item lemma="continuar" tags="vblex.imp.*"/>
<!--
   <cat-item lemma="continuar" tags="vblex.inf"/>
   <cat-item lemma="continuar" tags="vblex.ger"/>
   <cat-item lemma="continuar" tags="vblex.pp.*"/>
-->
</def-cat>
<def-cat n="seguir_inf">
   <cat-item lemma="seguir" tags="vblex.inf"/>
   <cat-item lemma="continuar" tags="vblex.inf"/>
</def-cat>
<def-cat n="anar_pri">
   <cat-item lemma="anar" tags="vblex.pri.*"/>
</def-cat>
<def-cat n="anar_pri_p3sg">
   <cat-item lemma="anar" tags="vblex.pri.p3.sg"/>
</def-cat>
<def-cat n="nptop">
   <cat-item tags="np.top.*"/>
   <cat-item tags="np.top"/>
</def-cat>
<def-cat n="predet">
   <cat-item tags="predet.*"/>
</def-cat>
<def-cat n="rel">
   <cat-item tags="rel.*"/>
</def-cat>
<def-cat n="pro">
   <cat-item tags="prn.pro.p1.*"/>
   <cat-item tags="prn.pro.p2.*"/>
   <cat-item tags="prn.pro.p3.*"/>
</def-cat>
<def-cat n="enc">
   <cat-item tags="prn.enc.*"/>
</def-cat>
<def-cat n="vblex">
   <cat-item tags="vblex.*"/>
   <cat-item tags="vbmod.*"/>
   <cat-item tags="vbser.*"/>
   <cat-item tags="vbhaver.*"/>
</def-cat>
<def-cat n="vbmod">
   <cat-item tags="vbmod.*"/>
</def-cat>
<def-cat n="inf">
   <cat-item tags="vblex.inf"/>
   <cat-item tags="vbser.inf"/>
   <cat-item tags="vbhaver.inf"/>
   <cat-item tags="vbmod.inf"/>
</def-cat>
<def-cat n="inf-imp_p3">
   <cat-item tags="vblex.inf"/>
   <cat-item tags="vbser.inf"/>
   <cat-item tags="vbhaver.inf"/>
   <cat-item tags="vbmod.inf"/>
   <cat-item tags="vblex.imp.p3.*"/>
   <cat-item tags="vbser.imp.p3.*"/>
   <cat-item tags="vbhaver.imp.p3.*"/>
   <cat-item tags="vbmod.imp.p3.*"/>
</def-cat>
<def-cat n="vblex_inf">
   <cat-item tags="vblex.inf"/>
</def-cat>
<def-cat n="vbser_estar_inf">
   <cat-item tags="vbser.inf"/>
   <cat-item lemma="estar" tags="vblex.inf"/>
   <cat-item lemma="quedar" tags="vblex.inf"/>
</def-cat>
<def-cat n="vbser_inf">
   <cat-item tags="vbser.inf"/>
</def-cat>
<def-cat n="vbhaver_inf">
   <cat-item tags="vbhaver.inf"/>
</def-cat>
<def-cat n="imp">
   <cat-item tags="vblex.imp.*"/>
</def-cat>
<def-cat n="imp_p3">
   <cat-item tags="vblex.imp.p3.*"/>
</def-cat>
<def-cat n="ger">
   <cat-item tags="vblex.ger"/>
</def-cat>
<def-cat n="imp_p2-ger">
   <cat-item tags="vblex.imp.p2.*"/>
   <cat-item tags="vblex.imp.p1.*"/>
   <cat-item tags="vbmod.imp.p2.*"/>
   <cat-item tags="vbmod.imp.p1.*"/>
   <cat-item tags="vbser.imp.p2.*"/>
   <cat-item tags="vbser.imp.p1.*"/>
   <cat-item tags="vblex.ger"/>
   <cat-item tags="vbhaver.ger"/>
   <cat-item tags="vbmod.ger"/>
   <cat-item tags="vbser.ger"/>
</def-cat>
<def-cat n="verb-tmp-srd">	<!-- verb amb els temps verbals del sard (sense cni, ifi, fti) -->
   <cat-item tags="vblex.pri.*"/>
   <cat-item tags="vblex.prs.*"/>
   <cat-item tags="vblex.pii.*"/>
   <cat-item tags="vblex.pis.*"/>
   <cat-item tags="vblex.imp.*"/>
   <cat-item tags="vblex.inf"/>
   <cat-item tags="vblex.ger"/>
   <cat-item tags="vblex.pp.*"/>
   <cat-item tags="vbmod.pri.*"/>
   <cat-item tags="vbmod.prs.*"/>
   <cat-item tags="vbmod.pii.*"/>
   <cat-item tags="vbmod.pis.*"/>
   <cat-item tags="vbmod.imp.*"/>
   <cat-item tags="vbmod.inf"/>
   <cat-item tags="vbmod.ger"/>
   <cat-item tags="vbmod.pp.*"/>
   <cat-item tags="vbser.pri.*"/>
   <cat-item tags="vbser.prs.*"/>
   <cat-item tags="vbser.pii.*"/>
   <cat-item tags="vbser.pis.*"/>
   <cat-item tags="vbser.imp.*"/>
   <cat-item tags="vbser.inf"/>
   <cat-item tags="vbser.ger"/>
   <cat-item tags="vbser.pp.*"/>
   <cat-item tags="vbhaver.pri.*"/>
   <cat-item tags="vbhaver.prs.*"/>
   <cat-item tags="vbhaver.pii.*"/>
   <cat-item tags="vbhaver.pis.*"/>
   <cat-item tags="vbhaver.imp.*"/>
   <cat-item tags="vbhaver.inf"/>
   <cat-item tags="vbhaver.ger"/>
   <cat-item tags="vbhaver.pp.*"/>
</def-cat>
<def-cat n="pp">
   <cat-item tags="vblex.pp.*"/>
   <cat-item tags="vbmod.pp.*"/>
   <cat-item tags="vbser.pp.*"/>
   <cat-item tags="vbhaver.pp.*"/>
</def-cat>
<def-cat n="vbmod-tmp-srd">
   <cat-item tags="vbmod.inf"/>
   <cat-item tags="vbmod.pri.*"/>
   <cat-item tags="vbmod.prs.*"/>
   <cat-item tags="vbmod.pii.*"/>
   <cat-item tags="vbmod.pis.*"/>
   <cat-item tags="vbmod.imp.*"/>
</def-cat>
<def-cat n="vbmod-cni">
   <cat-item tags="vbmod.cni.*"/>
</def-cat>
<def-cat n="vbmod-ifi">
   <cat-item tags="vbmod.ifi.*"/>
</def-cat>
<def-cat n="vbmod-fti">
   <cat-item tags="vbmod.fti.*"/>
</def-cat>
<def-cat n="adjec">	<!-- sense sup -->
   <cat-item tags="adj.m.*"/>
   <cat-item tags="adj.f.*"/>
   <cat-item tags="adj.mf.*"/>
   <cat-item tags="adj.ord.*"/>
   <cat-item tags="adj.ind.*"/>
   <cat-item tags="adj.pos.*"/>
   <cat-item tags="adj.itg.*"/>
   <cat-item tags="vblex.pp.*"/>
</def-cat>
<def-cat n="adjec_no_pp">	<!-- sense sup ni pp -->
   <cat-item tags="adj.m.*"/>
   <cat-item tags="adj.f.*"/>
   <cat-item tags="adj.mf.*"/>
   <cat-item tags="adj.ord.*"/>
   <cat-item tags="adj.ind.*"/>
   <cat-item tags="adj.pos.*"/>
   <cat-item tags="adj.itg.*"/>
</def-cat>
<def-cat n="adjec_adv">	<!-- sense sup -->
   <cat-item tags="adj.m.*"/>
   <cat-item tags="adj.f.*"/>
   <cat-item tags="adj.mf.*"/>
   <cat-item tags="adj.ord.*"/>
   <cat-item tags="adj.ind.*"/>
   <cat-item tags="adj.pos.*"/>
   <cat-item tags="adj.itg.*"/>
   <cat-item tags="vblex.pp.*"/>
   <cat-item tags="adv"/>
</def-cat>
<def-cat n="adjsup">
   <cat-item tags="adj.sup.*"/>
</def-cat>
<def-cat n="adj_ord">
   <cat-item tags="adj.ord.*"/>
</def-cat>
<def-cat n="adv">
   <cat-item tags="adv"/>
</def-cat>
<def-cat n="adv_preadv">
   <cat-item tags="adv"/>
   <cat-item tags="preadv"/>
</def-cat>
<def-cat n="molt">
   <cat-item lemma="molt" tags="adv"/>
   <cat-item lemma="molt" tags="preadv"/>
</def-cat>
<def-cat n="tan">
   <cat-item lemma="tan" tags="preadv"/>
</def-cat>
<def-cat n="com">
   <cat-item lemma="com" tags="rel.adv"/>
</def-cat>
<def-cat n="mes">
   <cat-item lemma="gener" tags="n.*"/>
   <cat-item lemma="febrer" tags="n.*"/>
   <cat-item lemma="març" tags="n.*"/>
   <cat-item lemma="abril" tags="n.*"/>
   <cat-item lemma="maig" tags="n.*"/>
   <cat-item lemma="juny" tags="n.*"/>
   <cat-item lemma="juliol" tags="n.*"/>
   <cat-item lemma="agost" tags="n.*"/>
   <cat-item lemma="setembre" tags="n.*"/>
   <cat-item lemma="octubre" tags="n.*"/>
   <cat-item lemma="novembre" tags="n.*"/>
   <cat-item lemma="desembre" tags="n.*"/>
</def-cat>
<def-cat n="tercer_quart_etc">
   <cat-item lemma="tercer" tags="adj.*"/>
   <cat-item lemma="quart" tags="adj.*"/>
   <cat-item lemma="cinquè" tags="adj.*"/>
   <cat-item lemma="quint" tags="adj.*"/>
   <cat-item lemma="sisè" tags="adj.*"/>
   <cat-item lemma="setè" tags="adj.*"/>
   <cat-item lemma="vuitè" tags="adj.*"/>
   <cat-item lemma="novè" tags="adj.*"/>
   <cat-item lemma="desè" tags="adj.*"/>
   <cat-item lemma="onzè" tags="adj.*"/>
   <cat-item lemma="dotzè" tags="adj.*"/>
   <cat-item lemma="tretzè" tags="adj.*"/>
   <cat-item lemma="catorzè" tags="adj.*"/>
   <cat-item lemma="quinzè" tags="adj.*"/>
   <cat-item lemma="setzè" tags="adj.*"/>
   <cat-item lemma="dissetè" tags="adj.*"/>
   <cat-item lemma="divuitè" tags="adj.*"/>
   <cat-item lemma="dinovè" tags="adj.*"/>
   <cat-item lemma="vintè" tags="adj.*"/>
   <cat-item lemma="trentè" tags="adj.*"/>
   <cat-item lemma="quarantè" tags="adj.*"/>
   <cat-item lemma="cinquantè" tags="adj.*"/>
   <cat-item lemma="seixantè" tags="adj.*"/>
   <cat-item lemma="setantè" tags="adj.*"/>
   <cat-item lemma="vuitantè" tags="adj.*"/>
   <cat-item lemma="norantè" tags="adj.*"/>
   <cat-item lemma="centè" tags="adj.*"/>
</def-cat>
<def-cat n="III_IV_etc"> <!-- algun error fa que els lemes s'hagin de posar en minúscules, o bé no es reconeixen -->
   <cat-item lemma="iii" tags="num.*"/>
   <cat-item lemma="iv" tags="num.*"/>
   <cat-item lemma="v" tags="num.*"/>
   <cat-item lemma="vi" tags="num.*"/>
   <cat-item lemma="vii" tags="num.*"/>
   <cat-item lemma="viii" tags="num.*"/>
   <cat-item lemma="ix" tags="num.*"/>
   <cat-item lemma="x" tags="num.*"/>
   <cat-item lemma="xi" tags="num.*"/>
   <cat-item lemma="xii" tags="num.*"/>
   <cat-item lemma="xiii" tags="num.*"/>
   <cat-item lemma="xiv" tags="num.*"/>
   <cat-item lemma="xv" tags="num.*"/>
   <cat-item lemma="xvi" tags="num.*"/>
   <cat-item lemma="xvii" tags="num.*"/>
   <cat-item lemma="xviii" tags="num.*"/>
   <cat-item lemma="xix" tags="num.*"/>
   <cat-item lemma="xx" tags="num.*"/>
   <cat-item lemma="xxi" tags="num.*"/>
   <cat-item lemma="xxi" tags="num.*"/>
   <cat-item lemma="xxii" tags="num.*"/>
   <cat-item lemma="xxiii" tags="num.*"/>
   <cat-item lemma="xxiv" tags="num.*"/>
   <cat-item lemma="xxv" tags="num.*"/>
   <cat-item lemma="xxvi" tags="num.*"/>
   <cat-item lemma="xxvii" tags="num.*"/>
   <cat-item lemma="xxviii" tags="num.*"/>
   <cat-item lemma="xxix" tags="num.*"/>
   <cat-item lemma="xxx" tags="num.*"/>
</def-cat>
<def-cat n="periode">
   <cat-item lemma="segle" tags="n.*"/>
   <cat-item lemma="any" tags="n*"/>
</def-cat>
<def-cat n="que_cnjsub">
   <cat-item lemma="que" tags="cnjsub"/>
</def-cat>
<def-cat n="i">
   <cat-item lemma="i" tags="cnjcoo"/>
</def-cat>
<def-cat n="np">
   <cat-item tags="np.*"/>
</def-cat>
</section-def-cats>

<section-def-attrs>
<def-attr n="gen">
   <attr-item tags="m"/>
   <attr-item tags="f"/>
   <attr-item tags="nt"/>
   <attr-item tags="mf"/>
   <attr-item tags="GD"/>
</def-attr>
<def-attr n="nbr">
   <attr-item tags="ND"/>
   <attr-item tags="sp"/>
   <attr-item tags="sg"/>
   <attr-item tags="pl"/>
</def-attr>
<def-attr n="pers">
   <attr-item tags="p1"/>
   <attr-item tags="p2"/>
   <attr-item tags="p3"/>
</def-attr>
<def-attr n="a_verb">
   <attr-item tags="vblex"/>
   <attr-item tags="vbhaver"/>
   <attr-item tags="vbser"/>
   <attr-item tags="vbmod"/>
</def-attr>
<def-attr n="temps">
   <attr-item tags="imp"/>
   <attr-item tags="pri"/>
   <attr-item tags="pis"/>
   <attr-item tags="prs"/>
   <attr-item tags="pii"/>
   <attr-item tags="pp"/>
   <attr-item tags="inf"/>
   <attr-item tags="ger"/>
</def-attr>
<def-attr n="a_num">
   <attr-item tags="num"/>
</def-attr>
<def-attr n="grau">
   <attr-item tags="comp"/>
   <attr-item tags="sup"/>
</def-attr>
<def-attr n="a_nom">
   <attr-item tags="n"/>
   <attr-item tags="abbr"/>
   <attr-item tags="n.acr"/>
   <attr-item tags="np.ant"/>
   <attr-item tags="np.top"/>
   <attr-item tags="np.cog"/>
   <attr-item tags="np.al"/>
</def-attr>
<def-attr n="a_det">
   <attr-item tags="det.ind"/>
   <attr-item tags="det.dem"/>
   <attr-item tags="det.pos"/>
   <attr-item tags="predet"/>
   <attr-item tags="det.def"/>
</def-attr>
<def-attr n="a_prn">
   <attr-item tags="prn.tn"/>
   <attr-item tags="prn.pro"/>
   <attr-item tags="prn.enc"/>
   <attr-item tags="prn.itg"/>
   <attr-item tags="prn.dem"/>
</def-attr>
<def-attr n="a_adjec">
   <attr-item tags="adj"/>
   <attr-item tags="adj.ord"/>
   <attr-item tags="adj.pos"/>
   <attr-item tags="adj.itg"/>
   <attr-item tags="det.pos"/>
   <attr-item tags="vblex.pp"/>
   <attr-item tags="vbhaver.pp"/>
   <attr-item tags="vbmod.pp"/>
   <attr-item tags="vbser.pp"/>
</def-attr>
<def-attr n="a_pos">
   <attr-item tags="adj.pos"/>
   <attr-item tags="det.pos"/>
   <attr-item tags="prn.pos"/>
</def-attr>
<def-attr n="a_adv">
   <attr-item tags="adv"/>
</def-attr>

</section-def-attrs>
<section-def-vars>
<def-var n="genero"/>
<def-var n="numero"/>
<def-var n="genero_tmp"/>
<def-var n="numero_tmp"/>
<def-var n="concPrimero"/>
<def-var n="concSegundo"/>
<def-var n="concTercero"/>
<def-var n="set_sg"/>
</section-def-vars>

<section-def-lists>
   <def-list n="verbs_estat">
      <list-item v="estar"/>
      <list-item v="ser"/>
      <list-item v="quedar"/>
    </def-list>
   <def-list n="vbambser">
      <list-item v="abbigiare"/>	<!-- perquè pron (crec) -->
      <list-item v="achirrare"/>
      <list-item v="andare"/>
      <list-item v="arribare"/>
      <list-item v="arribbare"/>
      <list-item v="artziare"/>
      <list-item v="bàlere"/>
      <list-item v="bènnere"/>
      <list-item v="colare"/>
      <list-item v="crèschere"/>
      <list-item v="divenire"/>
      <list-item v="èssere"/>
      <list-item v="essire"/>
      <list-item v="falare"/>
      <list-item v="frenare"/>
      <list-item v="fuire"/>
      <list-item v="intrare"/>
      <list-item v="isfugire"/>
      <list-item v="istare"/>
      <list-item v="nàschere"/>
      <list-item v="partire"/>
      <list-item v="restare"/>
      <list-item v="pèndere"/>
      <list-item v="sèere"/>
      <list-item v="bìvere"/>
      <list-item v="variare"/>	<!-- només intr i pron... però això és la norma -->
<!--      <list-item v="torrare"/> cas especial -->
    </def-list>
    <def-list n="familiars">
      <list-item v="fill"/>
      <list-item v="pare"/>
      <list-item v="mare"/>
      <list-item v="papa"/>
      <list-item v="mama"/>
      <list-item v="avi"/>
      <list-item v="iaia"/>
      <list-item v="besavi"/>
      <list-item v="oncle"/>
      <list-item v="tia"/>
      <list-item v="nét"/>
      <list-item v="besnét"/>
    </def-list>
    <def-list n="primer_segon">
      <list-item v="primer"/>
      <list-item v="segon"/>
    </def-list>
   <def-list n="trencats">
      <list-item v="terç"/>
      <list-item v="quart"/>
      <list-item v="quint"/>
      <list-item v="cinquè"/>
      <list-item v="sisè"/>
      <list-item v="setè"/>
      <list-item v="vuitè"/>
      <list-item v="novè"/>
    </def-list>
</section-def-lists>

<section-def-macros>

    <def-macro n="f_concord1" npar="1">
      
      <choose><!--To determine value of variables of gender and
		  number and propagate to other rules.  Variables are
		  not used again in this rule -->
	<when> 
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let><var n="genero"/><lit-tag v="m"/></let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let><var n="genero"/><lit-tag v="f"/></let>
	</when>
      </choose> 
      <choose>
	<when> 
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let><var n="numero"/><lit-tag v="sg"/></let>
	</when>
	<when> 
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let><var n="numero"/><lit-tag v="pl"/></let>
	</when>
      </choose>
      <choose>
	<when>
	  <test> <!-- If word has GD or ND, we try to assign the
		      gender or number of the previous rule. If there is no
		      value for the gender or number variable from previous
		      rules, gender will be masculine and number singular.-->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <choose> 
	    <when>
	      <test>
		<equal>
		  <var n="genero"/>
		  <lit-tag v="f"/>
		</equal>
	      </test>
	      <let><clip pos="1" side="tl" part="gen"/><lit-tag v="f"/></let>
	    </when>
	    <otherwise>
	      <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose> 
	    <when>
	      <test>
		<equal>
		  <var n="numero"/>
		  <lit-tag v="pl"/>
		</equal>
	      </test>
	      <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>                   
	    </when>
	    <otherwise>
	      <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
	    </otherwise>
	  </choose>
	</when>
      </choose>    
    </def-macro>


    <def-macro n="f_concord2" npar="2">
      <choose>
	<when>
	  <test> <!-- do the main and second parameter gender agree?-->
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal> <!-- do the main and second parameter number agree?-->
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let><!-- there is gender and number agreement-->
	</when>
	<otherwise> 
	  <let><var n="concPrimero"/><lit v="false"/></let><!-- there isn't gender and number agreement-->
	</otherwise>
      </choose>
      
      <choose>
	<when>
	  <test> <!-- Propagate the main parameter gender if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>		 	       
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>  
      <choose>
	<when>
	  <test> <!-- Propagate the main parameter number if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      
      <choose>
	<when>
	  <test> <!-- Which is the rule general gender? -->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/> 
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>



      <choose>
	<when><!-- Which is the rule general number? -->
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="a_num"/>
		<lit-tag v="num"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose> <!-- Determine gender and number value if they are undetermined -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>


    <def-macro n="f_concord3" npar="3"> 
      <choose><!-- Look whether in source language there is concordance between first and second element -->
	<when>
	  <test> 
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let>
	</when>
	<otherwise> 
	  <let><var n="concPrimero"/><lit v="false"/></let>
	</otherwise>
      </choose>
      <choose><!-- Look whether in source language there is concordance between second and third element -->
	<when>
	  <test> 
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concSegundo"/><lit v="true"/></let>
	</when>	 
	<otherwise> 
	  <let><var n="concSegundo"/><lit v="false"/></let>
	</otherwise>
      </choose>


      <choose><!-- Propagate the main parameter gender if it has been modified during the translation -->
	<when>
	  <test> 
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let>
	    </when> 
	  </choose>   
	  <choose>
	    <when>
	      <test> 
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let> 
	    </when> 
	  </choose>
	</when>
      </choose>

      <choose><!-- Propagate the main parameter number if it has been modified during the translation -->
	<when>
	  <test> 
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>



      <choose> <!-- Determine the rule general gender. Priority order: main, second and third element -->
	<when>
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when> 
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="3" side="sl" part="gen"/> 
	  </let>
	</when>               
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>
      
      <choose><!-- Determine the rule general number. Priority order: main, second and third element -->
	<when>
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>     
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="3" side="sl" part="nbr"/> 
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="a_num"/>
		<lit-tag v="num"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose> <!-- Assign values to GD and ND -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>      
    </def-macro>     
    
    
    <def-macro n="f_concord4" npar="4">
      <choose>
	<when>
	  <test> 
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let>
	</when>
	<otherwise> 
	  <let><var n="concPrimero"/><lit v="false"/></let>
	</otherwise>
      </choose>
      
      <choose>
	<when>
	  <test> 
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concSegundo"/><lit v="true"/></let>
	</when>	 
	<otherwise>
	  <let><var n="concSegundo"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test> 
	    <and>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concTercero"/><lit v="true"/></let>
	</when>	 
	<otherwise> 
	  <let><var n="concTercero"/><lit v="false"/></let>
	</otherwise>
      </choose>
      

      <choose>
	<when>
	  <test> 
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let>
	    </when> 
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let>
	    </when> 
	  </choose>  
	  <choose>
	    <when>
	      <test>  
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/> 
	      </let> 
	    </when> 
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test> 
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      
      <choose>
	<when>
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when> 
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>

      </choose>
      
      <choose>
	<when>
	  <test> 
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when> 
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose> 
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when> 
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>      
    </def-macro>      


    <def-macro n="f_carchi2" npar="2">
      <choose>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="carchi"/></equal>
          </test>
          <choose>
            <when>
              <test>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
              </test>
              <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
            </when>
          </choose>      
          <!-- si comença amb consonant, entenc que és subjecte i el verb haurà de passar a singular si va en plural -->
          <choose>
            <when>
              <test>
                <equal><clip pos="1" side="tl" part="lem"/><lit v="Carchi"/></equal>
              </test>
              <let><var n="set_sg"/><lit v="1"/></let>
            </when>
            <otherwise>
              <let><var n="set_sg"/><lit v="0"/></let>
            </otherwise>
          </choose>      
        </when>
      </choose>      
    </def-macro>      

    <def-macro n="f_carchi3" npar="3">
      <call-macro n="f_carchi2"><with-param pos="1"/><with-param pos="2"/></call-macro>
      <call-macro n="f_carchi2"><with-param pos="1"/><with-param pos="3"/></call-macro>
    </def-macro>      

    <def-macro n="f_carchi4" npar="4">
      <call-macro n="f_carchi2"><with-param pos="1"/><with-param pos="2"/></call-macro>
      <call-macro n="f_carchi2"><with-param pos="1"/><with-param pos="3"/></call-macro>
      <call-macro n="f_carchi2"><with-param pos="1"/><with-param pos="4"/></call-macro>
    </def-macro>      

    <def-macro n="f_set_sg1" npar="1">
      <choose>
        <when>
          <test>
            <and>
              <equal><var n="set_sg"/><lit v="1"/></equal>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </when>
      </choose>      
      <let><var n="set_sg"/><lit v="0"/></let>
    </def-macro>      

    <def-macro n="f_set_sg2" npar="2">
      <call-macro n="f_set_sg1"><with-param pos="1"/></call-macro>
      <call-macro n="f_set_sg1"><with-param pos="2"/></call-macro>
    </def-macro>      


    <def-macro n="f_det_to_adj_pos1" npar="1">
      <let>
        <clip pos="1" side="tl" part="a_pos"/>
        <lit-tag v="adj.pos"/>
      </let>
      <choose>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="el seu"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="suo"/>
          </let>
        </when>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="el meu"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="meu"/>
          </let>
        </when>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="el teu"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="tuo"/>
          </let>
        </when>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="el nostre"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="nostru"/>
          </let>
        </when>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="el vostre"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="bostru"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="set_gen_tmp_no_mf0" npar="0">
	<!-- posa a la variable genero_tmp el genere la variable genero si no és mf, sinó posa "m" -->
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><var n="genero_tmp"/><var n="genero"/></let>
          </when>
          <otherwise>
            <let><var n="genero_tmp"/><lit-tag v="m"/></let>
          </otherwise>
        </choose>
    </def-macro>

    <def-macro n="set_gen_tmp_no_mf" npar="2">
	<!-- posa a la variable genero_tmp el genere del primer parametre si no és mf, sinó el del segon paràmetre, sinó posa el valor de la var genero -->
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
          </test>
          <choose>
            <when>
              <test>
                <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="mf"/></equal>
              </test>
              <let><var n="genero_tmp"/><var n="genero"/></let>
            </when>
            <otherwise>
              <let><var n="genero_tmp"/><clip pos="2" side="tl" part="gen"/></let>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <let><var n="genero_tmp"/><clip pos="1" side="tl" part="gen"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="set_num_tmp_no_sp" npar="2">
	<!-- posa a la variable numero_tmp el nombre del primer parametre si no és sp, sinó el del segon paràmetre, sinó posa el valor de la var numero -->
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
          </test>
          <choose>
            <when>
              <test>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
              </test>
              <let><var n="numero_tmp"/><var n="numero"/></let>
            </when>
            <otherwise>
              <let><var n="numero_tmp"/><clip pos="2" side="tl" part="nbr"/></let>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <let><var n="numero_tmp"/><clip pos="1" side="tl" part="nbr"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_li2bi" npar="1">
      <choose>	<!--To change "li" to "bi" when there is a second enclitic -->
	<when> 
	  <test>
	    <equal caseless="yes">
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="li"/>
	    </equal>
	  </test>
	  <let><clip pos="1" side="tl" part="lemh"/><get-case-from pos="1"><lit v="bi"/></get-case-from></let>
	  <let><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></let>
	  <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></let>
 	</when> 
     </choose>
    </def-macro>

    <def-macro n="f_pr_tn-pers" npar="2">
      <choose>	<!-- To change to personal pronoun depending on the preposition -->
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="mi"/></equal>
	  </test>
          <choose>
	    <when> 
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="a"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="mie"/></get-case-from></let>
	    </when>
	    <when> 
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="megus"/></get-case-from></let>
	    </when>
	    <otherwise>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="mene"/></get-case-from></let>
	    </otherwise>
          </choose>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="tu"/></equal>
	  </test>
          <choose>
	    <when> 
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="a"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tie"/></get-case-from></let>
	    </when>
	    <when> 
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tegus"/></get-case-from></let>
	    </when>
	    <otherwise>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tene"/></get-case-from></let>
	    </otherwise>
          </choose>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="ell"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="issu"/></get-case-from></let>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="nosaltres"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="nois"/></get-case-from></let>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="vosaltres"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="bois"/></get-case-from></let>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="ells"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="issu"/></get-case-from></let>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="si"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="sese"/></get-case-from></let>
	</when>
      </choose>
    </def-macro>

<def-macro n="f_vaux_anar_inf" npar="2">
   <let><clip pos="2" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>	<!-- FIXME: depèn del gènere i nombre del subjecte -->
   <choose> <!-- vaux + vlex: es canvia el vaux a èssere o àere i es posa el segon en pp -->
     <when>
       <test>
         <or>
           <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	   <and>
	     <equal caseless="yes"><clip pos="2" side="tl" part="lemh"/><lit v="torrare"/></equal>
	     <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	   </and>
         </or>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><get-case-from pos="1"><lit v="èssere"/></get-case-from></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><get-case-from pos="1"><lit v="àere"/></get-case-from></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
     </otherwise>
   </choose>
</def-macro>

<def-macro n="f_vaux_pp2" npar="2">
   <choose> <!-- vaux + vlex: es canvia el vaux a èssere o àere -->
     <when>
       <test>
         <or>
           <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	   <and>
	     <equal caseless="yes"><clip pos="2" side="tl" part="lemh"/><lit v="torrare"/></equal>
	     <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	   </and>
         </or>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
       <!-- el gènere, l'agafem de la variable "genero", però només en 3a persona i si genero no es mf -->
       <choose>
         <when>
           <test>
           <and>
	     <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p3"/></equal>
	     <or>
               <equal><var n="genero"/><lit-tag v="m"/></equal>
	       <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
           </test>
           <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
         </when>
         <otherwise>
           <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
         </otherwise>
       </choose>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><lit v="àere"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
     </otherwise>
   </choose>
</def-macro>

<def-macro n="f_vaux_pp3" npar="3">
   <choose> <!-- vaux + vlex: es canvia el vaux a èssere o àere, el tercer element és un adjectiu que serveix per obtenir el gènere del pp si èssere -->
     <when>
       <test>
         <or>
           <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	   <and>
	     <equal caseless="yes"><clip pos="2" side="tl" part="lemh"/><lit v="torrare"/></equal>
	     <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	   </and>
         </or>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
       <!-- el gènere, l'agafem en primer lloc del tercer membre (adj) o altrament de la variable "genero", però només en 3a persona i si genero no es mf -->
       <choose>
         <when>
           <test>
	     <or>
               <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></equal>
               <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="f"/></equal>
             </or>
           </test>
           <let><clip pos="2" side="tl" part="gen"/><clip pos="3" side="tl" part="gen"/></let>
         </when>
         <otherwise>
           <choose>
             <when>
               <test>
               <and>
	         <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p3"/></equal>
	         <or>
                   <equal><var n="genero"/><lit-tag v="m"/></equal>
                   <equal><var n="genero"/><lit-tag v="f"/></equal>
                 </or>
               </and>
               </test>
               <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
             </when>
             <otherwise>
               <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
             </otherwise>
           </choose>
         </otherwise>
       </choose>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><lit v="àere"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
     </otherwise>
   </choose>
</def-macro>
</section-def-macros>

<section-rules>

<rule comment="regla: det_pos">
   <pattern>
     <pattern-item n="det_pos"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <call-macro n="f_det_to_adj_pos1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="poss">
         <tags>
           <tag><lit-tag v="SD"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="a_pos"/>
           <clip pos="1" side="tl" part="gen"/>
           <clip pos="1" side="tl" part="nbr"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: det">
   <pattern>
     <pattern-item n="det"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="det">
         <tags>
           <tag><lit-tag v="SD"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="a_det"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: adjec">
   <pattern>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="adj">
         <tags>
           <tag><lit-tag v="SA"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="a_adjec"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: adjsup">
   <pattern>
     <pattern-item n="adjsup"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="adj">
         <tags>
           <tag><lit-tag v="SA"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="a_adjec"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="a beru"/>
         <lit-tag v="adv"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: molt adj">
   <pattern>
     <pattern-item n="molt"/>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="2"/>
     </call-macro>     
     <out>
       <chunk name="adj_meda">
         <tags>
           <tag><lit-tag v="SA"/></tag>
         </tags>
       <lu>
         <get-case-from pos="1">
           <clip pos="2" side="tl" part="lemh"/>
         </get-case-from>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <lu>
         <get-case-from pos="2">
           <clip pos="1" side="tl" part="lemh"/>
         </get-case-from>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: tan adjec com">
   <pattern>
     <pattern-item n="tan"/>
     <pattern-item n="adjec_adv"/>
     <pattern-item n="com"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="2"/>
     </call-macro>     
     <out>
       <chunk name="adj_comente_a">
         <tags>
           <tag><lit-tag v="SA"/></tag>
         </tags>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: tan adjec nom com">
   <pattern>
     <pattern-item n="tan"/>
     <pattern-item n="adjec"/>
     <pattern-item n="nom"/>
     <pattern-item n="com"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="2"/>
     </call-macro>     
     <out>
       <chunk name="adj_n_comente_a">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: un ord nom: Una tercera família. → Una de tres famìlias.">
   <pattern>
     <pattern-item n="un"/>
     <pattern-item n="tercer_quart_etc"/>
     <pattern-item n="nom"/>
   </pattern>

   <action>
     <call-macro n="f_concord3">
       <with-param pos="3"/>
       <with-param pos="2"/>
       <with-param pos="1"/>
     </call-macro>
     <choose> <!-- per a no canviar els sp -->
       <when>
         <test>
	   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
         </test>
         <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <out>
       <chunk name="det_adj_nom">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: un ord nom adj: Un tercer component variable. → Unu de tres cumponentes variàbiles.">
   <pattern>
     <pattern-item n="un"/>
     <pattern-item n="tercer_quart_etc"/>
     <pattern-item n="nom"/>
     <pattern-item n="adjec"/>
   </pattern>

   <action>
     <call-macro n="f_concord4">
       <with-param pos="3"/>
       <with-param pos="2"/>
       <with-param pos="4"/>
       <with-param pos="1"/>
     </call-macro>
     <choose> <!-- per a no canviar els sp -->
       <when>
         <test>
	   <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
         </test>
         <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <choose> <!-- per a no canviar els sp -->
       <when>
         <test>
	   <equal><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
         </test>
         <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <out>
       <chunk name="det_adj_nom">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: num">
   <pattern>
     <pattern-item n="num"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
    <out>
       <chunk name="num">
         <tags>
           <tag><lit-tag v="SNum"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="a_num"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: III_IV_etc nom">
   <pattern>
     <pattern-item n="III_IV_etc"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="2"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <out>
       <chunk name="det_adjord_n">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <lit v="su"/><lit-tag v="det"/><lit-tag v="def"/>
           <clip pos="2" side="tl" part="gen"/>
           <lit-tag v="sg"/>
         </lu>
         <b/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: det III_IV_etc nom">
   <pattern>
     <pattern-item n="det"/>
     <pattern-item n="III_IV_etc"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
   <call-macro n="f_concord2">
     <with-param pos="3"/>
     <with-param pos="1"/>
   </call-macro>
     <out>
       <chunk name="det_adjord_n">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b pos="1"/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: nom III_IV_etc: segle III su de III sèculos ">
   <pattern>
     <pattern-item n="periode"/>
     <pattern-item n="III_IV_etc"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <out>
       <chunk name="det_adjord_n">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <lit v="su"/><lit-tag v="det"/><lit-tag v="def"/>
           <clip pos="1" side="tl" part="gen"/>
           <lit-tag v="sg"/>
         </lu>
         <b/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: det nom III_IV_etc: el segle III su de III sèculos ">
   <pattern>
     <pattern-item n="det"/>
     <pattern-item n="periode"/>
     <pattern-item n="III_IV_etc"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="2"/>
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <out>
       <chunk name="det_adjord_n">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b pos="1"/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: de det nom III_IV_etc a det III_IV_etc: del segle XIII al XV > de su de III sèculos a su de XV">
   <pattern>
     <pattern-item n="de"/>
     <pattern-item n="det"/>
     <pattern-item n="periode"/>
     <pattern-item n="III_IV_etc"/>
     <pattern-item n="a"/>
     <pattern-item n="det"/>
     <pattern-item n="III_IV_etc"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="3"/>
       <with-param pos="2"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <out>
       <chunk name="pr_det_adjord_n_pr_det_adjord">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="whole"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b pos="3"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b pos="4"/>
         <lu>
           <clip pos="5" side="tl" part="whole"/>
         </lu>
         <b pos="5"/>
         <lu>
           <clip pos="6" side="tl" part="whole"/>
         </lu>
         <b/>
         <lu>
           <lit v="de"/><lit-tag v="pr"/>
         </lu>
         <b pos="6"/>
         <lu>
           <clip pos="7" side="tl" part="whole"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: pr prn (Norme p. 28)">
   <pattern>
     <pattern-item n="pr"/>
     <pattern-item n="tn-pers"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_pr_tn-pers">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>

     <out>
       <chunk name="pr">
         <tags>
           <tag><lit-tag v="pr"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       </chunk>
       <b pos="1"/>
       <chunk name="tn">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: rel">
   <pattern>
     <pattern-item n="rel"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="rel">
         <tags>
           <tag><lit-tag v="Rel"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: np">
   <pattern>
     <pattern-item n="np"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="np">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: prn">
   <pattern>
     <pattern-item n="prn"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>     
     <out>
       <chunk name="prn">
         <tags>
           <tag><lit-tag v="SPron"/></tag>
         </tags>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: que prn_tn_fort">
   <pattern>
     <pattern-item n="que_cnjsub"/>
     <pattern-item n="prn_tn_fort"/>
   </pattern>
   <action>
     <choose>
       <when>
         <test>
	   <equal><clip pos="1" side="tl" part="lem"/><lit v="chi"/></equal>
         </test>
         <out>
           <chunk name="chi_prn">
             <tags>
               <tag><lit-tag v="cnjsub"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
        <choose>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="jo"/></equal>
            </test>
	    <let><clip pos="2" side="tl" part="lem"/><lit v="mene"/></let>
          </when>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="tu"/></equal>
            </test>
	    <let><clip pos="2" side="tl" part="lem"/><lit v="tene"/></let>
          </when>
        </choose>
         <out>
           <chunk name="de_prn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: n">
  <pattern>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord1">
      <with-param pos="1"/>
    </call-macro>     
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="1" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
        <out>
          <chunk name="det-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="su"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <var n="genero"/>
              <var n="numero"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="unu"/>
               <lit-tag v="num"/>
               <var n="genero"/>
               <lit-tag v="sp"/>
             </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </otherwise>
    </choose>
   </action>
</rule>


<rule comment="regla: adjec nom">
  <pattern>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <out>
   <chunk name="adj-nom">
     <tags>
       <tag><lit-tag v="SN"/></tag>
     </tags>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_adjec"/>
        <clip pos="1" side="tl" part="gen"/>
        <clip pos="1" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_nom"/>
        <clip pos="2" side="tl" part="gen"/>
        <clip pos="2" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
    </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: adjsup nom">
  <pattern>
    <pattern-item n="adjsup"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <out>
   <chunk name="adj-nom">
     <tags>
       <tag><lit-tag v="SN"/></tag>
     </tags>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_adjec"/>
        <clip pos="1" side="tl" part="gen"/>
        <clip pos="1" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b/>
      <lu>
        <lit v="a beru"/>
        <lit-tag v="adv"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_nom"/>
        <clip pos="2" side="tl" part="gen"/>
        <clip pos="2" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
    </chunk>
    </out>
  </action>
</rule>


<rule comment="regla: nom adjec">
  <pattern>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <out>
   <chunk name="n-adj">
     <tags>
       <tag><lit-tag v="SN"/></tag>
     </tags>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_nom"/>
        <clip pos="1" side="tl" part="gen"/>
        <clip pos="1" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_adjec"/>
        <clip pos="2" side="tl" part="gen"/>
        <clip pos="2" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
    </chunk>
    </out>

  </action>
</rule>

<rule comment="regla: nom adjsup">
  <pattern>
    <pattern-item n="nom"/>
    <pattern-item n="adjsup"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <out>
   <chunk name="n-adj">
     <tags>
       <tag><lit-tag v="SN"/></tag>
     </tags>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_nom"/>
        <clip pos="1" side="tl" part="gen"/>
        <clip pos="1" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_adjec"/>
        <clip pos="2" side="tl" part="gen"/>
        <clip pos="2" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
      <b/>
      <lu>
        <lit v="a beru"/>
        <lit-tag v="adv"/>
      </lu>
    </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: nom adjec adjec"> 
  <pattern>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
    <pattern-item n="adjec_no_pp"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="1"/>
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <out>
   <chunk name="nom-adj-adj">
     <tags>
       <tag><lit-tag v="SN"/></tag>
     </tags>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="tags"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="tags"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
      <b pos="2"/>
      <lu>
        <clip pos="3" side="tl" part="lemh"/>
        <clip pos="3" side="tl" part="tags"/>
        <clip pos="3" side="tl" part="lemq"/>
      </lu>
    </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: det_pos nom: : mon pare > babbu meu, les seves urelles > sas origras suas, llurs orelles > sas origras issoro"> 
  <pattern>
    <pattern-item n="det_pos"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_det_to_adj_pos1">
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="set_gen_tmp_no_mf">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <call-macro n="set_num_tmp_no_sp">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
     <choose>
       <when>
         <test>
           <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="familiars"/></in>
         </test>
         <out>
           <chunk name="poss-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="2" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="2" side="tl" part="a_nom"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lem"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_pos"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="poss-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="su"/>
               </get-case-from>
               <lit-tag v="det.def"/>
               <var n="genero_tmp"/>
               <var n="numero_tmp"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="a_nom"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lem"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_pos"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
  </action>
</rule>


<rule comment="regla: det nom: la casa > sa domo, el terç > su tres unu, un terç > su tres unu"> 
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_carchi2">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <choose>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="un"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="lemh"/><lit v="su"/></let>
            <let><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></let>
          </when>
        </choose>
        <out>
          <chunk name="det-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="1" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="unu"/>
              <lit-tag v="num"/>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="sp"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="det-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>


<rule comment="regla: det_pos nom adjec: la meva ciutat estimada > sa tzitade amada mea, llurs orelles grans > sas origras mannas issoro"> 
  <pattern>
    <pattern-item n="det_pos"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="2"/>
      <with-param pos="3"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_det_to_adj_pos1">
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="set_gen_tmp_no_mf">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="set_num_tmp_no_sp">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <out>
      <chunk name="det-nom-adj-pos">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="su"/>
           </get-case-from>
           <lit-tag v="det.def"/>
           <var n="genero_tmp"/>
           <var n="numero_tmp"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="a_nom"/>
           <clip pos="2" side="tl" part="gen"/>
           <clip pos="2" side="tl" part="nbr"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="a_adjec"/>
           <clip pos="3" side="tl" part="gen"/>
           <clip pos="3" side="tl" part="nbr"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="a_pos"/>
           <clip pos="1" side="tl" part="gen"/>
           <clip pos="1" side="tl" part="nbr"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
  </action>
</rule>

<rule comment="regla: det_pos nom adjec: les meves orelles grandíssimes > sas origras meas mannas a beru, llurs orelles grans > sas origras issoro mannas a beru"> 
  <pattern>
    <pattern-item n="det_pos"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjsup"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="2"/>
      <with-param pos="3"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_det_to_adj_pos1">
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="set_gen_tmp_no_mf">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="set_num_tmp_no_sp">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <out>
      <chunk name="det-nom-adj-pos">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="su"/>
           </get-case-from>
           <lit-tag v="det.def"/>
           <var n="genero_tmp"/>
           <var n="numero_tmp"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="a_nom"/>
           <clip pos="2" side="tl" part="gen"/>
           <clip pos="2" side="tl" part="nbr"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="a_pos"/>
           <clip pos="1" side="tl" part="gen"/>
           <clip pos="1" side="tl" part="nbr"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="a_adjec"/>
           <clip pos="3" side="tl" part="gen"/>
           <clip pos="3" side="tl" part="nbr"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a beru"/>
           <lit-tag v="adv"/>
         </lu>
       </chunk>
     </out>
  </action>
</rule>

<rule comment="regla: det_pos adjec nom: : el meu gran amic > su grandu amigu meu, llurs grans orelles > sas mannas origras issoro"> 
  <pattern>
    <pattern-item n="det_pos"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
  <call-macro n="f_concord3">
    <with-param pos="3"/>
    <with-param pos="2"/>
    <with-param pos="1"/>
  </call-macro>
  <call-macro n="f_det_to_adj_pos1">
    <with-param pos="1"/>
  </call-macro>
  <call-macro n="set_gen_tmp_no_mf">
    <with-param pos="3"/>
    <with-param pos="2"/>
  </call-macro>
  <call-macro n="set_num_tmp_no_sp">
    <with-param pos="3"/>
    <with-param pos="2"/>
  </call-macro>
   <choose>
     <when>
       <test>
         <and>
           <equal><clip pos="2" side="tl" part="a_adjec"/><lit-tag v="adj.ord"/></equal>
           <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal></not>
           <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal></not>
         </and>
       </test>
       <out>
         <chunk name="det-ord-nom-pos">
          <tags>
            <tag><lit-tag v="SN"/></tag>
          </tags>
           <lu>
             <get-case-from pos="1">
               <lit v="su"/>
             </get-case-from>
             <lit-tag v="det.def"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b/>
           <lu>
             <lit v="de"/>
             <lit-tag v="pr"/>
           </lu>
           <b/>
           <lu>
             <lit v="su"/>
             <lit-tag v="det.def"/>
             <clip pos="3" side="tl" part="gen"/>
             <lit-tag v="pl"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_nom"/>
             <clip pos="3" side="tl" part="gen"/>
             <lit-tag v="pl"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b/>
           <lu>
             <get-case-from pos="2">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="a_pos"/>
             <clip pos="1" side="tl" part="gen"/>
             <lit-tag v="pl"/>
           </lu>
         </chunk>
       </out>
     </when>
     <otherwise>
       <out>
         <chunk name="det-adj-nom-pos">
           <tags>
             <tag><lit-tag v="SN"/></tag>
           </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="su"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <var n="genero_tmp"/>
              <var n="numero_tmp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adjec"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pos"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
          </out>
         </otherwise>
     </choose>
  </action>
</rule>

    <rule comment="regla: det_pos adjsup nom: : llurs grandíssimes orelles > sas mannas a beru origras issoro"> 
      <pattern>
        <pattern-item n="det_pos"/>
        <pattern-item n="adjsup"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_det_to_adj_pos1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_gen_tmp_no_mf">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="set_num_tmp_no_sp">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
       <chunk name="det-adj-nom-pos">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="su"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <var n="genero_tmp"/>
            <var n="numero_tmp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="a beru"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_pos"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: det_pos nom adjec adjec"> 
      <pattern>
        <pattern-item n="det_pos"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec_no_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_det_to_adj_pos1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_gen_tmp_no_mf">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="set_num_tmp_no_sp">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
       <chunk name="det-nom-adj-adj-pos">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="su"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <var n="genero_tmp"/>
            <var n="numero_tmp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_pos"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: det_pos adjec nom adjec"> 
      <pattern>
        <pattern-item n="det_pos"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec_no_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_det_to_adj_pos1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_gen_tmp_no_mf">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="set_num_tmp_no_sp">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
       <chunk name="det-adj-nom-adj-pos">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="su"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <var n="genero_tmp"/>
            <var n="numero_tmp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_pos"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>


    <rule comment="regla: det nom adjec"> 
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
       <chunk name="det-nom-adj">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: det nom adjsup"> 
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjsup"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
       <chunk name="det-nom-adj">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="a beru"/>
            <lit-tag v="adv"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: det nom adjec adjec"> 
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec_no_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi4">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
       <chunk name="det-nom-adj-adj">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

<rule comment="regla: det adjec nom"> 
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_carchi3">
      <with-param pos="1"/>
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <and>
            <equal><clip pos="2" side="tl" part="a_adjec"/><lit-tag v="adj.ord"/></equal>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal></not>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal></not>
	    <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
          </and>
        </test>
        <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
      </when>
    </choose>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <out>
          <chunk name="det-adj-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="unu"/>
               <lit-tag v="num"/>
               <var n="genero"/>
               <lit-tag v="sp"/>
             </lu>
          </chunk>
        </out>
      </when>
      <when>
        <test>
          <or>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="carchi"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="calicunu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="grandu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="àteru"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="diversu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="matessi"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="prus"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="pagu"/></equal>
            <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="cantu"/></equal>
          </or>
        </test>
        <out>
         <chunk name="det-adj-nom">
           <tags>
             <tag><lit-tag v="SN"/></tag>
           </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
         <chunk name="det-nom-adj">
           <tags>
             <tag><lit-tag v="SN"/></tag>
           </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>

    <rule comment="regla: det adjsup nom"> 
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjsup"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
       <chunk name="det-adj-nom">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="a beru"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>

<rule comment="regla: det adjec nom adjec"> 
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord4">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="4"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_carchi4">
      <with-param pos="1"/>
      <with-param pos="2"/>
      <with-param pos="3"/>
      <with-param pos="4"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <and>
            <equal><clip pos="2" side="tl" part="a_adjec"/><lit-tag v="adj.ord"/></equal>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal></not>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal></not>
	    <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
          </and>
        </test>
        <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
      </when>
    </choose>
    <choose>
      <when>
        <test>
          <and>
            <equal><clip pos="2" side="tl" part="a_adjec"/><lit-tag v="adj.ord"/></equal>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal></not>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal></not>
	    <equal><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
          </and>
        </test>
        <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="pl"/></let>
      </when>
    </choose>
    <out>
     <chunk name="det-adj-nom-adj">
       <tags>
         <tag><lit-tag v="SN"/></tag>
       </tags>
        <lu>
          <clip pos="1" side="tl" part="whole"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="a_adjec"/>
          <clip pos="2" side="tl" part="gen"/>
          <clip pos="2" side="tl" part="nbr"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="a_nom"/>
          <clip pos="3" side="tl" part="gen"/>
          <clip pos="3" side="tl" part="nbr"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="a_adjec"/>
          <clip pos="4" side="tl" part="gen"/>
          <clip pos="4" side="tl" part="nbr"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: det num nom">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_carchi3">
      <with-param pos="1"/>
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <choose>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="un"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="lemh"/><lit v="su"/></let>
            <let><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></let>
          </when>
        </choose>
        <out>
          <chunk name="det-nom-num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="det-num-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
  </action>
</rule>


<rule comment="regla: num nom">
  <pattern>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
        <out>
          <chunk name="det-nom-num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="su"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <var n="genero"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="num-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
  </action>
</rule>


    <rule comment="regla: predet det nom"> 
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
       <chunk name="det-det-nom">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>


    <rule comment="regla: predet det nom adjec">
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_carchi4">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
       <chunk name="det-det-nom-adj">
         <tags>
           <tag><lit-tag v="SN"/></tag>
         </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </action>
    </rule>


<rule comment="regla: mes de num: maig de 2017 > maju de su 2017">
  <pattern>
    <pattern-item n="mes"/>
    <pattern-item n="de"/>
    <pattern-item n="num"/>
  </pattern>
  <action>
    <call-macro n="f_concord1">
      <with-param pos="1"/>
    </call-macro>
    <out>
      <chunk name="mes-de-su-any">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <lit v="su"/>
          <lit-tag v="det.def.m.sg"/>
        </lu>
        <b/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>


<rule comment="regla: det mes de num: el maig de 2017 > su maju de su 2017">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="mes"/>
    <pattern-item n="de"/>
    <pattern-item n="num"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <out>
      <chunk name="det-mes-de-su-any">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <lit v="su"/>
          <lit-tag v="det.def.m.sg"/>
        </lu>
        <b/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>


<rule comment="regla: cni">
   <pattern>
     <pattern-item n="cni"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case>
       <clip pos="1" side="tl" part="lem"/>
       <lit v="aa"/>
     </modify-case>
     <out>
       <chunk name="mod-inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1"><lit v="dare"/></get-case-from>
           <lit-tag v="vblex.prs"/>
           <clip pos="1" side="tl" part="pers"/>
           <clip pos="1" side="tl" part="gen"/>
           <clip pos="1" side="tl" part="nbr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="a_verb"/>
           <lit-tag v="inf"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: ifi">
   <pattern>
     <pattern-item n="ifi"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="1" side="tl" part="lemh"/><list n="vbambser"/></in>
	     <and>
	       <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
	       <equal><clip pos="1" side="tl" part="lemq"/><lit v=""/></equal>
	     </and>
           </or>
         </test>
        <call-macro n="set_gen_tmp_no_mf0"></call-macro>
         <out>
           <chunk name="èssere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pri"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <clip pos="1" side="tl" part="nbr"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="àere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pri"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pp.m.sg"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: vbser_estar-ifi pp">
   <pattern>
     <pattern-item n="vbser_estar-ifi"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_concord1"> <!-- amb això mantinc el gènere que tingui el pp: és massa exposat triar el que hi hagi a la var genero -->
       <with-param pos="2"/>
     </call-macro>     
     <call-macro n="f_set_sg2">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
     <call-macro n="set_gen_tmp_no_mf0"></call-macro>
     <out>
       <chunk name="èssere_pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <get-case-from pos="1">
               <lit v="èssere"/>
             </get-case-from>
             <lit-tag v="vbser.pri"/>
             <clip pos="1" side="tl" part="pers"/>
             <clip pos="1" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero"/>
             <clip pos="1" side="tl" part="nbr"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <clip pos="2" side="tl" part="nbr"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: haver pp">
   <pattern>
     <pattern-item n="haver-tmp-srd-cnj"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <out>
       <chunk name="aux_pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<!--
S'ha de millorar:
- "tapa" la regla del reflexiu (l'ha d'incloure)
- ha de tenir en compte si els pronoms són de CD (no "li", per exemple). El problema és que "ens", "us" i "els" poden ser CD i CI - millor no fer canvis amb ells... o tenir una llista de verbs transitius o que (no) admetin CI (per evitar "els ha dit > los at narrados").
<rule comment="pro haver pp > pro aux pp: els ha unit > los at unidos, m'ha arribat > mi est arribadu"> 
  <pattern>
    <pattern-item n="pro"/>
    <pattern-item n="haver"/>
    <pattern-item n="pp"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
        </test>
        <let><clip pos="2" side="tl" part="lem"/><lit v="èssere"/></let>
        <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
        <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
          </when>
        </choose>
      </when>
      <otherwise>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="f"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><clip pos="1" side="sl" part="gen"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="nbr"/><clip pos="1" side="sl" part="nbr"/></let>
          </when>
        </choose>
      </otherwise>
    </choose>
    <out>
      <chunk name="prn_aux_pp">
        <tags>
          <tag><lit-tag v="SV"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>  
-->

<rule comment="prnref haver pp > prnref èssere pp: s'ha incorporat > s'est achiridu, m'ha dit > mi at naradu, m'ha arribat > mi est arribadu"> 
  <pattern>
    <pattern-item n="prnproref"/>
    <pattern-item n="haver"/>
    <pattern-item n="pp"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
            <and>
              <equal><clip pos="1" side="sl" part="pers"/><clip pos="2" side="sl" part="pers"/></equal>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </and>
            <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
          </or>
        </test>
        <let><clip pos="2" side="tl" part="lem"/><lit v="èssere"/></let>
        <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
        <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
          </when>
        </choose>
      </when>
    </choose>
    <out>
      <chunk name="prn_aux_pp">
        <tags>
          <tag><lit-tag v="SV"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>  


<rule comment="prnref prnpro haver pp > prnref prnpro èssere pp: s'hi ha incorporat > si nch'est achiridu, m'ho ha dit > mi l'at naradu, m'hi ha arribat > mi nch'est arribadu"> 
  <pattern>
    <pattern-item n="prnproref"/>
    <pattern-item n="prnpro"/>
    <pattern-item n="haver"/>
    <pattern-item n="pp"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
            <and>
              <equal><clip pos="1" side="sl" part="pers"/><clip pos="3" side="sl" part="pers"/></equal>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </and>
            <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
          </or>
        </test>
        <let><clip pos="3" side="tl" part="lem"/><lit v="èssere"/></let>
        <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
        <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
          </when>
        </choose>
      </when>
    </choose>
    <out>
      <chunk name="prn_aux_pp">
        <tags>
          <tag><lit-tag v="SV"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>  


<rule comment="prnref anar_pri inf > prnref èssere pp: es va incorporar > s'est achiridu, em va dir > mi at naradu, em va arribar > mi est arribadu"> 
  <pattern>
    <pattern-item n="prnproref"/>
    <pattern-item n="anar_pri"/>
    <pattern-item n="inf"/>
  </pattern>
  <action>
    <call-macro n="f_vaux_anar_inf">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <or>
            <and>
              <equal><clip pos="1" side="sl" part="pers"/><clip pos="2" side="sl" part="pers"/></equal>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </and>
            <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
          </or>
        </test>
        <let><clip pos="2" side="tl" part="lem"/><lit v="èssere"/></let>
        <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
        <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
          </when>
        </choose>
      </when>
    </choose>
    <out>
      <chunk name="prn_aux_pp">
        <tags>
          <tag><lit-tag v="SV"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>  


<rule comment="prnref prnpro anar_pri inf > prnref èssere pp: s'hi va incorporar > s nch'est achiridu, m'ho va dir > mi l'at naradu, m'hi va arribar > mi nch'est arribadu"> 
  <pattern>
    <pattern-item n="prnproref"/>
    <pattern-item n="prnpro"/>
    <pattern-item n="anar_pri"/>
    <pattern-item n="inf"/>
  </pattern>
  <action>
    <call-macro n="f_vaux_anar_inf">
      <with-param pos="3"/>
      <with-param pos="4"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <or>
            <and>
              <equal><clip pos="1" side="sl" part="pers"/><clip pos="3" side="sl" part="pers"/></equal>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </and>
            <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
          </or>
        </test>
        <let><clip pos="3" side="tl" part="lem"/><lit v="èssere"/></let>
        <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
        <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
        <choose>
          <when>
            <test>
                <or>
                  <equal><var n="genero"/><lit-tag v="m"/></equal>
                  <equal><var n="genero"/><lit-tag v="f"/></equal>
                </or>
            </test>
            <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
          </when>
        </choose>
      </when>
    </choose>
    <out>
      <chunk name="prn_prn_aux_pp">
        <tags>
          <tag><lit-tag v="SV"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>  


<rule comment="prnref ifi > prnref èssere pp: s'incorporà > s'est achiridu, em digué > mi at naradu, m'arribà > mi est arribadu"> 
  <pattern>
    <pattern-item n="prnproref"/>
     <pattern-item n="ifi"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
            <and>
              <equal><clip pos="1" side="sl" part="pers"/><clip pos="2" side="sl" part="pers"/></equal>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </or>
            </and>
            <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
          </or>
        </test>
        <call-macro n="set_gen_tmp_no_mf0"></call-macro>
        <out>
          <chunk name="prn_aux_pp1">
            <tags>
              <tag><lit-tag v="SV"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="èssere"/>
              <lit-tag v="vbser.pri"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="pp"/>
              <var n="genero_tmp"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
         </out>
      </when>
      <otherwise>
        <out>
          <chunk name="prn_aux_pp2">
            <tags>
              <tag><lit-tag v="SV"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="àere"/>
              <lit-tag v="vbhaver.pri"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="pp.m.sg"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>  


<rule comment="regla: haver-ifi pp">
   <pattern>
     <pattern-item n="haver-ifi"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	     <and>
	       <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
	       <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	     </and>
           </or>
         </test>
         <call-macro n="set_gen_tmp_no_mf0"></call-macro>
         <out>
           <chunk name="èssere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <clip pos="1" side="tl" part="nbr"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="àere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: haver-fti pp">
   <pattern>
     <pattern-item n="haver-fti"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case>
       <clip pos="1" side="tl" part="lem"/>
       <lit v="aa"/>
     </modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	     <and>
	       <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
	       <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	     </and>
           </or>
         </test>
         <out>
           <chunk name="aux-a-essere-pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <lit v="èssere"/>
               <lit-tag v="vbser.inf"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="aux-a-aere-pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: haver-cni pp">
   <pattern>
     <pattern-item n="haver-cni"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case>
       <clip pos="1" side="tl" part="lem"/>
       <lit v="aa"/>
     </modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
	     <and>
	       <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
	       <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
	     </and>
           </or>
         </test>
         <out>
           <chunk name="mod-aux-pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="èssere"/>
               <lit-tag v="vbser.inf"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="mod-aux-pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: haver pp adj">
   <pattern>
     <pattern-item n="haver-tmp-srd-cnj"/>
     <pattern-item n="pp"/>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="3"/>
     </call-macro>     
     <call-macro n="f_set_sg2">
       <with-param pos="1"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_vaux_pp3">
       <with-param pos="1"/>
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <out>
       <chunk name="aux_pp_adj">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: es haver pp adjec">
   <pattern>
     <pattern-item n="es"/>
     <pattern-item n="haver-tmp-srd-cnj-p3"/>
     <pattern-item n="pp"/>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>     
     <choose>
       <when> 
         <test>
           <or>
             <equal><clip pos="4" side="sl" part="gen"/><lit-tag v="m"/></equal>
             <equal><clip pos="4" side="sl" part="gen"/><lit-tag v="f"/></equal>
           </or>
         </test>
           <let><clip pos="3" side="tl" part="gen"/><clip pos="4" side="sl" part="gen"/></let>
       </when> 
     </choose>
     <out>
       <chunk name="prn_aux_pp_adj">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <lit v="èssere"/>
             <lit-tag v="vbser"/>
             <clip pos="2" side="tl" part="temps"/>
             <clip pos="2" side="tl" part="pers"/>
             <clip pos="2" side="tl" part="nbr"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <clip pos="3" side="tl" part="gen"/>
             <clip pos="2" side="tl" part="nbr"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: haver pp adv adj">
   <pattern>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="adv_preadv"/>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>     
     <call-macro n="f_set_sg2">
       <with-param pos="1"/>
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_vaux_pp3">
       <with-param pos="1"/>
       <with-param pos="2"/>
       <with-param pos="4"/>
     </call-macro>
     <out>
       <chunk name="aux_pp_adv_adj">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: es haver pp adv adjec">
   <pattern>
     <pattern-item n="es"/>
     <pattern-item n="haver-tmp-srd-cnj-p3"/>
     <pattern-item n="pp"/>
     <pattern-item n="adv_preadv"/>
     <pattern-item n="adjec"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="5"/>
     </call-macro>     
     <choose>
       <when> 
         <test>
           <or>
             <equal><clip pos="5" side="sl" part="gen"/><lit-tag v="m"/></equal>
             <equal><clip pos="5" side="sl" part="gen"/><lit-tag v="f"/></equal>
           </or>
         </test>
           <let><clip pos="3" side="tl" part="gen"/><clip pos="5" side="sl" part="gen"/></let>
       </when> 
     </choose>
     <out>
       <chunk name="prn_aux_pp_adv_aj">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <lit v="èssere"/>
             <lit-tag v="vbser"/>
             <clip pos="2" side="tl" part="temps"/>
             <clip pos="2" side="tl" part="pers"/>
             <clip pos="2" side="tl" part="nbr"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <clip pos="3" side="tl" part="gen"/>
             <clip pos="2" side="tl" part="nbr"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="4"/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="tags"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: hi haver npl: hi ha nens > b'ant pitzinnos">
   <pattern>
     <pattern-item n="hi"/>
     <pattern-item n="haver-tmp-srd-cnj-p3sg"/>
     <pattern-item n="nom_pl"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="3"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <out>
       <chunk name="b'ant_n">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: hi haver det_pos_pl nom: hi ha els meus amics > b'ant sus amigos meos, hi havia els meus pares > b'aiant babbos meos">
   <pattern>
     <pattern-item n="hi"/>
     <pattern-item n="haver-tmp-srd-cnj-p3sg"/>
     <pattern-item n="det_pos_pl"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="4"/>
       <with-param pos="3"/>
     </call-macro>
    <call-macro n="f_det_to_adj_pos1">
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="set_gen_tmp_no_mf">
      <with-param pos="3"/>
      <with-param pos="4"/>
    </call-macro>
    <call-macro n="set_num_tmp_no_sp">
      <with-param pos="3"/>
      <with-param pos="4"/>
    </call-macro>
    <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
    <out>
       <chunk name="b'ant_det_n">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
       </chunk>
       <b pos="2"/>
    </out>
     <choose>
       <when>
         <test>
           <in caseless="yes"><clip pos="4" side="sl" part="lemh"/><list n="familiars"/></in>
         </test>
         <out>
           <chunk name="poss-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="a_nom"/>
               <clip pos="4" side="tl" part="gen"/>
               <clip pos="4" side="tl" part="nbr"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="3" side="tl" part="lem"/>
               <clip pos="3" side="tl" part="a_pos"/>
               <clip pos="3" side="tl" part="gen"/>
               <clip pos="3" side="tl" part="nbr"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="poss-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <lit v="su"/>
               <lit-tag v="det.def"/>
               <var n="genero_tmp"/>
               <var n="numero_tmp"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="a_nom"/>
               <clip pos="4" side="tl" part="gen"/>
               <clip pos="4" side="tl" part="nbr"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="3" side="tl" part="lem"/>
               <clip pos="3" side="tl" part="a_pos"/>
               <clip pos="3" side="tl" part="gen"/>
               <clip pos="3" side="tl" part="nbr"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
  </action>
</rule>


<rule comment="regla: hi haver det_pl nom: hi ha altres nens > b'ant àterus pitzinnos, hi ha alguns nens > b'at carchi pitzinnu">
   <pattern>
     <pattern-item n="hi"/>
     <pattern-item n="haver-tmp-srd-cnj-p3sg"/>
     <pattern-item n="det_pl"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="4"/>
       <with-param pos="3"/>
     </call-macro>
    <call-macro n="f_carchi2">
      <with-param pos="3"/>
      <with-param pos="4"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="carchi"/></equal></not>
         </test>
         <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <out>
       <chunk name="b'ant_det_n">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: hi haver num nom: hi ha dos nens > b'ant duos pitzinnos, hi ha dos terços > b'ant sos tres duos">
   <pattern>
     <pattern-item n="hi"/>
     <pattern-item n="haver-tmp-srd-cnj-p3sg"/>
     <pattern-item n="num"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="4"/>
       <with-param pos="3"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal></not>
         </test>
         <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <out>
       <chunk name="b'ant">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
       </chunk>
       <b pos="2"/>
    </out>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="4" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <out>
          <chunk name="det-nom-num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <get-case-from pos="3">
                <lit v="su"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <var n="genero"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="tags"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="num-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
  </action>
</rule>


<rule comment="regla: hi va haver npl: hi va haver nens > b'ant àpidu pitzinnos">
   <pattern>
     <pattern-item n="hi"/>
     <pattern-item n="anar_pri_p3sg"/>
     <pattern-item n="haver-inf"/>
     <pattern-item n="nom_pl"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
     <choose>
       <when>
         <test>
	   <equal caseless="yes"><clip pos="2" side="tl" part="lemh"/><lit v="èssere"/></equal>
         </test>
         <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
       </when>
     </choose>
     <let><var n="set_sg"/><lit v="0"/></let>
     <out>
       <chunk name="bi_aux_pp_n">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: anar_pri inf">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></equal>
             <or>
               <equal><var n="genero"/><lit-tag v="m"/></equal>
               <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
         </test>
         <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
       </when>
     </choose>
     <out>
       <chunk name="aux_pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: anar_pri haver_inf pp">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="vbhaver_inf"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg2">
       <with-param pos="1"/>
       <with-param pos="3"/>
     </call-macro>
     <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
	     <and>
	       <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
	       <equal><clip pos="3" side="tl" part="lemq"/><lit v=""/></equal>
	     </and>
           </or>
         </test>
         <out>
           <chunk name="èssere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <clip pos="3" side="tl" part="gen"/>		<!-- FIXME -->
                 <clip pos="1" side="tl" part="nbr"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="àere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: anar_pri ser_inf pp">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="vbser_estar_inf"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg2">
       <with-param pos="1"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="3"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
     <out>
       <chunk name="aux_pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: anar_pri inf enc">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <out>
       <chunk name="pro-aux-pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <clip pos="3" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: anar_pri inf enc enc">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_li2bi">
       <with-param pos="3"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <out>
       <chunk name="pro-aux-pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <clip pos="3" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: fti">
   <pattern>
     <pattern-item n="fti"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <modify-case>
       <clip pos="1" side="tl" part="lem"/>
       <lit v="aa"/>
     </modify-case>
     <out>
       <chunk name="aux-a-inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="àere"/>
           </get-case-from>
           <lit-tag v="vblex.pri"/>
           <clip pos="1" side="tl" part="pers"/>
           <clip pos="1" side="tl" part="gen"/>
           <clip pos="1" side="tl" part="nbr"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="a_verb"/>
           <lit-tag v="inf"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: vblex">
   <pattern>
     <pattern-item n="vblex"/>
   </pattern>
   <action>
   <call-macro n="f_set_sg1">
     <with-param pos="1"/>
   </call-macro>
     <out>
       <chunk name="v">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>


    <rule comment="regla: inf-imp_p3 enc">
       <pattern>
         <pattern-item n="inf-imp_p3"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <modify-case><clip pos="2" side="tl" part="lemh"/><case-of pos="1" side="sl" part="lemh"/></modify-case>
         <modify-case><clip pos="1" side="tl" part="lemh"/><case-of pos="2" side="sl" part="lemh"/></modify-case>
         <out>
           <chunk name="inf_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: inf-imp_p3 enc enc">
       <pattern>
         <pattern-item n="inf-imp_p3"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_li2bi">
           <with-param pos="2"/>
         </call-macro>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <modify-case><clip pos="2" side="tl" part="lemh"/><case-of pos="1" side="sl" part="lemh"/></modify-case>
         <modify-case><clip pos="1" side="tl" part="lemh"/><case-of pos="2" side="sl" part="lemh"/></modify-case>
      <choose>
	<when> 
	  <test>
	    <equal><clip pos="3" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="3" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when> 
      </choose>
         <out>
           <chunk name="inf_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: vbmod-tmp-srd inf enc">
       <pattern>
         <pattern-item n="vbmod-tmp-srd"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_vbmod_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: vbmod-tmp-srd inf enc enc">
       <pattern>
         <pattern-item n="vbmod-tmp-srd"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_li2bi">
           <with-param pos="3"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when> 
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when> 
      </choose>
         <out>
           <chunk name="pro_vbmod_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: vbmod-ifi inf enc">
       <pattern>
         <pattern-item n="vbmod-ifi"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aere_vbmodpp_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp.m.sg"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-fti inf enc">
       <pattern>
         <pattern-item n="vbmod-fti"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aux-a-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-cni inf enc">
       <pattern>
         <pattern-item n="vbmod-cni"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aux-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="dare"/>
               </get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-ifi inf enc enc">
       <pattern>
         <pattern-item n="vbmod-ifi"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_li2bi">
           <with-param pos="3"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when> 
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when> 
      </choose>
         <out>
           <chunk name="pro_pro_aere_vbmodpp_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp.m.sg"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-fti inf enc enc">
       <pattern>
         <pattern-item n="vbmod-fti"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_li2bi">
           <with-param pos="3"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when> 
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when> 
      </choose>
         <out>
           <chunk name="pro_aux-a-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-cni inf enc enc">
       <pattern>
         <pattern-item n="vbmod-cni"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <call-macro n="f_set_sg1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_li2bi">
           <with-param pos="3"/>
         </call-macro>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when> 
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when> 
      </choose>
         <out>
           <chunk name="pro_aux-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="dare"/>
               </get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


<rule comment="regla: imp_p2-ger enc">
   <pattern>
     <pattern-item n="imp_p2-ger"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <out>
       <chunk name="imp-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <mlu>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: imp_p2-ger enc enc: Abaixa-l'hi. → Abbassa·nche·lu, Abaixa-l'en. → Abbassa·lu">
   <pattern>
     <pattern-item n="imp_p2-ger"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
      <choose>
	<when> 
	  <test>
	    <or>
	      <equal><clip pos="3" side="sl" part="lem"/><lit v="en"/></equal>
	      <and>
	        <equal><clip pos="2" side="sl" part="lem"/><lit v="li"/></equal>
	        <equal><clip pos="3" side="sl" part="lem"/><lit v="hi"/></equal>
	      </and>
	    </or>
	  </test>
          <out>
            <chunk name="imp-ger-enc">
              <tags>
                <tag><lit-tag v="SV"/></tag>
              </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
            </chunk>
          </out>
	</when>
	<when> 
	  <test>
	    <and>
	      <equal><clip pos="3" side="sl" part="lem"/><lit v="hi"/></equal>
	      <not><equal><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal></not>
	    </and>
	  </test>
          <out>
            <chunk name="imp-ger-enc-enc">
              <tags>
                <tag><lit-tag v="SV"/></tag>
              </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
              </lu>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
            </chunk>
          </out>
	</when>
	<otherwise>
          <choose>
	    <when> 
	      <test>
	        <equal><clip pos="3" side="sl" part="lem"/><lit v="li"/></equal>
	      </test>
	     <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
             <let><clip pos="3" side="tl" part="lem"/><lit v="lu"/></let>
             <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
	    </when> 
          </choose>
          <out>
            <chunk name="imp-ger-enc-enc">
              <tags>
                <tag><lit-tag v="SV"/></tag>
              </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
              </lu>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
            </chunk>
          </out>
        </otherwise>
      </choose>
   </action>
</rule>

<rule comment="regla: haver + estat/sigut">
   <pattern>
     <pattern-item n="haver"/>
     <pattern-item n="estat_sigut"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <out>
       <chunk name="v-pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <lu>
         <lit v="èssere"/>
         <lit-tag v="vbser"/>
         <clip pos="1" side="tl" part="temps"/>
         <clip pos="1" side="tl" part="pers"/>
         <clip pos="1" side="tl" part="nbr"/>
       </lu>
       <b/>
       <lu>
         <clip pos="2" side="tl" part="whole"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: èssere_pri ger">
   <pattern>
     <pattern-item n="èssere_pri"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <out>
       <chunk name="estar-ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <lu>
         <get-case-from pos="1">
           <lit v="estar"/>
         </get-case-from>
         <clip pos="1" side="sl" part="a_verb"/>
         <clip pos="1" side="tl" part="temps"/>
         <clip pos="1" side="tl" part="pers"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="a_verb"/>
         <clip pos="2" side="tl" part="temps"/>
         <clip pos="2" side="tl" part="pers"/>
         <clip pos="2" side="tl" part="gen"/>
         <clip pos="2" side="tl" part="nbr"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
     </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: èssere_pri ger enc">
   <pattern>
     <pattern-item n="èssere_pri"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <out>
       <chunk name="estar-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <lu>
         <get-case-from pos="1">
           <lit v="estar"/>
         </get-case-from>
         <clip pos="1" side="sl" part="a_verb"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <mlu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: èssere_pri ger enc enc">
   <pattern>
     <pattern-item n="èssere_pri"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <out>
       <chunk name="estar-ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <lu>
         <get-case-from pos="1">
           <lit v="estar"/>
         </get-case-from>
         <clip pos="1" side="sl" part="a_verb"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <mlu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
         </lu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>


<!--
<rule comment="regla: ger enc">
   <pattern>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <out>
       <chunk name="ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <mlu>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: ger enc enc">
   <pattern>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <out>
       <chunk name="ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <mlu>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>
-->


<!--
<rule comment="regla: pro inf">
   <pattern>
     <pattern-item n="pro"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="1" side="tl" part="a_prn"/><lit-tag v="prn.enc"/></let>
     <out>
       <chunk name="inf-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
       <mlu>
         <lu>
           <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="2" side="tl" part="tags"/>
         </lu>
         <lu>
           <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </mlu>
     </chunk>
     </out>
   </action>
</rule>
-->


<rule comment="regla: a el inf: al voler > cherende">
   <pattern>
     <pattern-item n="a"/>
     <pattern-item n="el_m_sg"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <clip pos="3" side="tl" part="lemh"/>
           </get-case-from>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: a el inf enc: al voler-ho > cherende·lu">
   <pattern>
     <pattern-item n="a"/>
     <pattern-item n="el_m_sg"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <mlu>
           <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: a el inf enc enc: al voler-li-ho > cherende-bi·lu">
   <pattern>
     <pattern-item n="a"/>
     <pattern-item n="el_m_sg"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <mlu>
           <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="tags"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: malgrat inf: malgrat voler > mancari cherende">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: malgrat inf enc: malgrat dir-li > mancari narende·bi">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <mlu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: malgrat inf enc enc: malgrat dir-li-ho > mancari narende·bi·lu">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <mlu>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: malgrat adv inf: malgrat no voler > mancari non cherende">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: malgrat adv inf enc: malgrat no dir-li > mancari non narende·bi">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <mlu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: malgrat adv inf enc enc: malgrat no dir-li-ho > mancari non narende·bi·lu">
   <pattern>
     <pattern-item n="malgrat"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <mlu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: tot i inf: tot i voler > mancari cherende">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: tot i inf enc: tot i dir-li > mancari narende·bi">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <mlu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: tot i inf enc enc: tot i dir-li-ho > mancari narende·bi·lu">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <mlu>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: tot i adv inf: tot i no voler > mancari non cherende">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><clip pos="4" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b pos="3"/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: tot i adv inf enc: tot i no dir-li > mancari non narende·bi">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="4" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b pos="3"/>
         <mlu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: tot i adv inf enc enc: tot i no dir-li-ho > mancari non narende·bi·lu">
   <pattern>
     <pattern-item n="tot_prn"/>
     <pattern-item n="i"/>
     <pattern-item n="adv"/>
     <pattern-item n="inf"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="4" side="tl" part="temps"/><lit-tag v="ger"/></let>
     <out>
       <chunk name="cnj-ger-enc-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <get-case-from pos="1">
             <lit v="mancari"/>
           </get-case-from>
           <lit-tag v="cnjadv"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b pos="3"/>
         <mlu>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
         <lu>
           <clip pos="6" side="tl" part="lemh"/>
           <clip pos="6" side="tl" part="tags"/>
           <clip pos="6" side="tl" part="lemq"/>
         </lu>
         </mlu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: seguir ger: seguir dient > sighire a nàrrere">
   <pattern>
     <pattern-item n="seguir-tmp-srd-cnj"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <out>
       <chunk name="seguir-a-inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: seguir ger enc: seguir dient-li > sighire a nàrrere">
   <pattern>
     <pattern-item n="seguir-tmp-srd-cnj"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <out>
       <chunk name="seguir-a-inf-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: seguir ger enc enc: seguir dient-li-ho > sighire a nàrrere">
   <pattern>
     <pattern-item n="seguir-tmp-srd-cnj"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <out>
       <chunk name="seguir-a-inf-enc">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: anar_pri seguir_inf ger: va continuar dient > at continuadu a nàrrere">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="seguir_inf"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></equal>
             <or>
               <equal><var n="genero"/><lit-tag v="m"/></equal>
               <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
         </test>
         <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
       </when>
     </choose>
     <out>
       <chunk name="aux_pp_a_inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lem"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: anar_pri seguir_inf ger enc: va continuar dient-li > at continuadu a li nàrrere">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="seguir_inf"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></equal>
             <or>
               <equal><var n="genero"/><lit-tag v="m"/></equal>
               <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
         </test>
         <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
       </when>
     </choose>
     <out>
       <chunk name="aux_pp_a_inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lem"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: anar_pri seguir_inf ger enc enc: va continuar dient-li-ho > at continuadu a li lu nàrrere">
   <pattern>
     <pattern-item n="anar_pri"/>
     <pattern-item n="seguir_inf"/>
     <pattern-item n="ger"/>
     <pattern-item n="enc"/>
     <pattern-item n="enc"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_anar_inf">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_set_sg1">
       <with-param pos="1"/>
     </call-macro>
     <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <let><clip pos="5" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="èssere"/></equal>
             <or>
               <equal><var n="genero"/><lit-tag v="m"/></equal>
               <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
         </test>
         <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
       </when>
     </choose>
     <out>
       <chunk name="aux_pp_a_inf">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lem"/>
           <clip pos="1" side="tl" part="tags"/>
         </lu>
         <b pos="1"/>
         <lu>
           <clip pos="2" side="tl" part="lemh"/>
           <clip pos="2" side="tl" part="tags"/>
           <clip pos="2" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <lit v="a"/>
           <lit-tag v="pr"/>
         </lu>
         <b/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b/>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
         <b pos="2"/>
         <lu>
           <clip pos="3" side="tl" part="lemh"/>
           <clip pos="3" side="tl" part="tags"/>
           <clip pos="3" side="tl" part="lemq"/>
         </lu>
       </chunk>
     </out>
   </action>
</rule>


<rule comment="regla: algun de det: algunes de les característiques > calicunas caraterìsticas">
   <pattern>
     <pattern-item n="algun_prn"/>
     <pattern-item n="de"/>
     <pattern-item n="det"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>     
     <out>
       <chunk name="SN">
         <tags>
           <tag><lit-tag v="prn"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lem"/>
           <lit-tag v="det.ind"/>
	   <clip pos="4" side="tl" part="gen"/>
           <clip pos="4" side="tl" part="nbr"/>
         </lu>
         <b pos="3"/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>

<rule comment="regla: algun de det: algunes de les grans característiques > calicunas mannas caraterìsticas">
   <pattern>
     <pattern-item n="algun_prn"/>
     <pattern-item n="de"/>
     <pattern-item n="det"/>
     <pattern-item n="adjec"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="5"/>
       <with-param pos="4"/>
     </call-macro>     
     <out>
       <chunk name="SN">
         <tags>
           <tag><lit-tag v="prn"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lem"/>
           <lit-tag v="det.ind"/>
	   <clip pos="5" side="tl" part="gen"/>
           <clip pos="5" side="tl" part="nbr"/>
         </lu>
         <b pos="3"/>
         <lu>
           <clip pos="4" side="tl" part="lemh"/>
           <clip pos="4" side="tl" part="tags"/>
           <clip pos="4" side="tl" part="lemq"/>
         </lu>
         <b pos="4"/>
         <lu>
           <clip pos="5" side="tl" part="lemh"/>
           <clip pos="5" side="tl" part="tags"/>
           <clip pos="5" side="tl" part="lemq"/>
         </lu>
     </chunk>
     </out>
   </action>
</rule>

</section-rules>

</transfer>
