<?xml version="1.0" encoding="utf-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/><!--Falten els altres np (antroponims) que tenen gen i nbr, revisar regles.-->
      <cat-item tags="n.acr.*"/>
      <cat-item tags="abbr"/>
    </def-cat>

    <def-cat n="ant">
      <cat-item tags="np.ant"/>
    </def-cat>

    <def-cat n="loc">
      <cat-item tags="np.loc"/>
    </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
    </def-cat>

    <def-cat n="det">
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="detnt"/>
      <cat-item tags="predet.*"/>
      <!-- <cat-item tags="num.*"/> -->
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>


    <def-cat n="time">
      <cat-item tags="time"/>
    </def-cat>

    <def-cat n="prn">
      <cat-item tags="prn.*"/>
    </def-cat>
    
    <def-cat n="compar">
      <cat-item lemma="mayor" tags="adj.*"/>
      <cat-item lemma="menor" tags="adj.*"/>
      <cat-item lemma="igual" tags="adj.*"/>
      <cat-item lemma="más"   tags="adv"/>
      <cat-item lemma="menos" tags="adv"/>
    </def-cat>

    <def-cat n="rel">
      <cat-item tags="prn.rel.*"/>
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="que_compar">
      <cat-item lemma="que" tags="cnjsub"/>
      <cat-item lemma="que" tags="rel"/>
    </def-cat>
    
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>	
    <def-cat n="verb"> <!-- tots els verbs--> 
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="verbcontinuar"> <!--continuar, seguir--> 
      <cat-item lemma="continuar" tags="vblex.*"/>
      <cat-item lemma="seguir" tags="vblex.*"/>
      <cat-item lemma="empezar" tags="vblex.*"/>
      <cat-item lemma="comenzar" tags="vblex.*"/>
      <cat-item lemma="acabar" tags="vblex.*"/>
      <cat-item lemma="terminar" tags="vblex.*"/>
    </def-cat>

    <def-cat n="verbconseguir"> <!--conseguir, lograr--> 
      <cat-item lemma="conseguir" tags="vblex.*"/>
      <cat-item lemma="lograr" tags="vblex.*"/>
    </def-cat>

    
    <def-cat n="mod">  
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="imp">
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbmod.imp.*"/>
    </def-cat>
    
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>
    
    <def-cat n="hacer">
      <cat-item lemma="hacer" tags="vblex.pri.p3.sg"/>
    </def-cat>

    <def-cat n="haber">
      <cat-item lemma="haber" tags="vbhaver.*"/>
    </def-cat>

   <def-cat n="hay">
      <cat-item lemma="haber" tags="vbhaver.*.p3.*"/>
      <cat-item lemma="hay" tags="vblex.*.p3.*"/>
    </def-cat>

    <def-cat n="estar">
      <cat-item lemma="estar" tags="vblex.*"/>
    </def-cat>

    <def-cat n="ir">
      <cat-item lemma="ir" tags="vblex.*"/>
    </def-cat>

    <def-cat n="sido">
      <cat-item lemma="ser" tags="vbser.pp.m.sg"/>
      <cat-item lemma="ser" tags="vblex.pp.m.sg"/>
    </def-cat>

    <def-cat n="siendo">
      <cat-item lemma="ser" tags="vbser.ger"/>
      <cat-item lemma="ser" tags="vblex.ger"/>
    </def-cat>

    <def-cat n="caber">
      <cat-item lemma="caber" tags="vblex.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
     </def-cat>

    <def-cat n="pptot">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
     </def-cat>

    <def-cat n="ppmsg">
      <cat-item tags="vblex.pp.m.sg"/>
      <cat-item tags="vbser.pp.m.sg"/>
     </def-cat>

    <def-cat n="adjdetnum">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.ind.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="prnref">
      <cat-item tags="prn.pro.ref.p3.mf.sp"/>
   </def-cat>
   
    <def-cat n="vblex">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>

    </def-cat>

    <def-cat n="verbnoref">
      <cat-item lemma="ir" tags="vblex.*"/>
      <cat-item lemma="caer" tags="vblex.*"/>
      <cat-item lemma="escapar" tags="vblex.*"/>
      <cat-item lemma="morir" tags="vblex.*"/>
      <cat-item lemma="desmayar" tags="vblex.*"/>
      <cat-item lemma="quedar" tags="vblex.*"/>
      <cat-item lemma="reír" tags="vblex.*"/>
      <cat-item lemma="ruborizar" tags="vblex.*"/>
    </def-cat>


    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>


    <def-cat n="cnjcoo">
      <cat-item tags="cnjcoo"/>
    </def-cat>

    <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjadv"/>
      <cat-item tags="cnjsub"/>
    </def-cat>

    
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>

    <def-cat n="por">
      <cat-item lemma="por" tags="pr"/>
    </def-cat>

    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>

    <def-cat n="en">
      <cat-item lemma="en" tags="pr"/>
    </def-cat>

    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

  </section-def-cats>
  
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="abbr"/>
      <attr-item tags="n.unc"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj.ord"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="vblex"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbser"/>
      <attr-item tags="prn.itg"/>
    </def-attr>  


    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="detnt"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
      <attr-item tags="num.percent"/>
      <attr-item tags="num.time"/>
      <attr-item tags="n"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="auxiliar">
      <attr-item tags="auxser"/>
    </def-attr>



    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>


    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>


    <def-attr n="a_cnj">
      <attr-item tags="cnjcoo"/>
      <attr-item tags="cnjsub"/>
      <attr-item tags="cnjadv"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="pro.ref"/>
      <attr-item tags="pro"/>
      <attr-item tags="rel"/>
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.aa"/>
      <attr-item tags="rel.adv"/>
      <attr-item tags="rel.adv"/>
      <attr-item tags="obj"/>
      <attr-item tags="tn"/>
      <attr-item tags="tn.ref"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>

    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p3.f.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.mf.pl"/>
      <attr-item tags="p3.mf.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.nt"/>
      <attr-item tags="mf.sg"/>
      <attr-item tags="adv"/>
    </def-attr>
    
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="tipus_np">
      <attr-item tags="loc"/>
      <attr-item tags="al"/>
      <attr-item tags="ant"/>
    </def-attr>

    <def-attr n="gen_sense_mf">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="gen_mf">
      <attr-item tags="mf"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="nbr_sense_sp">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="nbr_sp">
      <attr-item tags="sp"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>
      <attr-item tags="fts"/>
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="pp"/>
      <attr-item tags="ger"/>
      <attr-item tags="inf"/>
    </def-attr>



  </section-def-attrs>
  <section-def-vars>
    <def-var n="tipusprep"/>
    <def-var n="tipusverb"/>
    <def-var n="tipusnom"/>
    <def-var n="tipusadv"/>
    <def-var n="numero"/>
    <def-var n="persona"/>
    <def-var n="genero"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="caseFirstWord"/> 
    <def-var n="lema"/>
    <def-var n="lemachunk"/>
    <def-var n="articulo1"/>
    <def-var n="articulo2"/>
    <def-var n="EOS" v="true"/>
  </section-def-vars>

  <section-def-lists>


    <def-list n="temporales">
      <list-item v="mes"/>
      <list-item v="día"/>
      <list-item v="año"/>
      <list-item v="semana"/>
      <list-item v="tiempo"/>
      <list-item v="hora"/>
      <list-item v="minuto"/>
      <list-item v="segundo"/>
      <list-item v="noche"/>
      <list-item v="tarde"/>
      <list-item v="mañana"/>
      <list-item v="lustro"/>
      <list-item v="siglo"/>
      <list-item v="milenio"/>
      <list-item v="era"/>
      <list-item v="década"/>
    </def-list>

    <def-list n="nloc">
      <list-item v="maison"/>
      <list-item v="monde"/>
      <list-item v="rue"/>
      <list-item v="zona"/>
      <list-item v="école"/>
      <list-item v="prison"/>
      <list-item v="habitation"/>
      <list-item v="chambre"/>
      <list-item v="salle"/>
      <list-item v="salon"/>
      <list-item v="mairie"/>
      <list-item v="université"/>
      <list-item v="hôpital"/>
      <list-item v="hôtel"/>
    </def-list>

    <def-list n="mes">
      <list-item v="enero"/>
      <list-item v="febrero"/>
      <list-item v="marzo"/>
      <list-item v="abril"/>
      <list-item v="mayo"/>
      <list-item v="junio"/>
      <list-item v="julio"/>
      <list-item v="agost"/>
      <list-item v="septiembre"/>
      <list-item v="octubre"/>
      <list-item v="noviembre"/>
      <list-item v="diciembre"/>
    </def-list>

    <def-list n="v_amb_a">
      <list-item v="soumettre"/>
      <list-item v="aller"/>
    </def-list>

    <def-list n="v_no_part">
      <list-item v="aller"/>
      <list-item v="partir"/>
      <list-item v="arriver"/>
      <list-item v="venir"/>
      <list-item v="passer"/>
      <list-item v="sortir"/>
    </def-list>

    <def-list n="vbcop">
      <list-item v="semblar"/>
    </def-list>

    <def-list n="v_amb_en">
      <list-item v="entrer"/>
      <list-item v="fêter"/>
      <list-item v="célébrer"/>
      <list-item v="vivre"/>
      <list-item v="habiter"/>
      <list-item v="mourir"/>
      <list-item v="naître"/>
      <list-item v="être"/>
    </def-list>

    <def-list n="auxser">
      <list-item v="accorrere"/>
      <list-item v="addivenire"/>
      <list-item v="affiorare"/>
      <list-item v="allibire"/>
      <list-item v="ammattire"/>
      <list-item v="ammuffire"/>
      <list-item v="andare"/>
      <list-item v="apparire"/>
      <list-item v="arrivare"/>
      <list-item v="arrossire"/>
      <list-item v="assurgere"/>
      <list-item v="avvizzire"/>
      <list-item v="balenare"/>
      <list-item v="bastare"/>
      <list-item v="cadere"/>
      <list-item v="capitare"/>
      <list-item v="cascare"/>
      <list-item v="comparire"/>
      <list-item v="costare"/>
      <list-item v="crollare"/>
      <list-item v="decadere"/>
      <list-item v="decedere"/>
      <list-item v="decorrere"/>
      <list-item v="decrescere"/>
      <list-item v="defungere"/>
      <list-item v="dimagrire"/>
      <list-item v="dipendere"/>
      <list-item v="dispiacere"/>
      <list-item v="divenire"/>
      <list-item v="diventare"/>
      <list-item v="durare"/>
      <list-item v="emergere"/>
      <list-item v="entrare"/>
      <list-item v="esistere"/>
      <list-item v="essere"/>
      <list-item v="giacere"/>
      <list-item v="giungere"/>
      <list-item v="implodere"/>
      <list-item v="incorrere"/>
      <list-item v="insorgere"/>
      <list-item v="insorgere"/>
      <list-item v="intervenire"/>
      <list-item v="morire"/>
      <list-item v="nascere"/>
      <list-item v="occorrere"/>
      <list-item v="parere"/>
      <list-item v="partire"/>
      <list-item v="permanere"/>
      <list-item v="piacere"/>
      <list-item v="provenire"/>
      <list-item v="restare"/>
      <list-item v="ricadere"/>
      <list-item v="rimanere"/>
      <list-item v="risorgere"/>
      <list-item v="risultare"/>
      <list-item v="ritornare"/>
      <list-item v="riuscire"/>
      <list-item v="sbucare"/>
      <list-item v="scadere"/>
      <list-item v="scappare"/>
      <list-item v="scomparire"/>
      <list-item v="sembrare"/>
      <list-item v="sfuggire"/>
      <list-item v="sparire"/>
      <list-item v="sopraggiungere"/>
      <list-item v="sopravvenire"/>
      <list-item v="sorgere"/>
      <list-item v="sovvenire"/>
      <list-item v="spiacere"/>
      <list-item v="stare"/>
      <list-item v="sussistere"/>
      <list-item v="svanire"/>
      <list-item v="svenire"/>
      <list-item v="tornare"/>
      <list-item v="uscire"/>
      <list-item v="valere"/>
      <list-item v="venire "/>
   </def-list>

    <def-list n="vbnoref">
      <list-item v="andare"/>
      <list-item v="cadere"/>
      <list-item v="scappare"/>
      <list-item v="morire"/>
      <list-item v="svenire"/>
      <list-item v="restare"/>
      <list-item v="ridere"/>
      <list-item v="arrosire"/>
    </def-list>


     


  </section-def-lists>


  <section-def-macros>
  <!--  <def-macro n="f_lexicadj" npar="1">
      <choose>
	<when>
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="buen"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="buon"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="gran"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="grande"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="primer"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>  
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="primo"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="mal"/>
	      </equal>
	      <equal> 
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="mal"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="tercer"/>
	      </equal>
	      <equal> 
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="terzo"/>
	  </let>
	</when>
      </choose>
    </def-macro> -->

   <def-macro n="canvia_fts" npar="1">
     <choose>
       <when>
	 <test>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="fts"/>
	   </equal>
	 </test>
	 <let>
	   <clip pos="1" side="tl" part="temps"/>
	   <lit-tag v="pis"/>
	 </let>
       </when>
     </choose>
   </def-macro>
	   

    <def-macro n="f_prep" npar="1">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="lem"/>
	      <lit v="à"/>
	    </equal>
	  </test>
	  <let>
	    <var n="tipusprep"/>
	    <lit-tag v="a"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="lem"/>
	      <lit v="en"/>
	    </equal>
	  </test>
	  <let>
	    <var n="tipusprep"/>
	    <lit-tag v="en"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="lem"/>
	      <lit v="de"/>
	    </equal>
	  </test>
	  <let>
	    <var n="tipusprep"/>
	    <lit-tag v="de"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tipusprep"/>
	    <lit-tag v=""/>
	  </let>
	</otherwise>
      </choose>
    </def-macro>

   <def-macro n="check_ifi" npar="1">
      <let>
	<var n="verb"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </equal>
	  </test>
	<choose>
	  <when>
	     <test>
	       <in caseless="yes">
		 <clip pos="1" side="tl" part="lem"/>
		 <list n="auxser"/>
	       </in>
	    </test>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="essere_pp"/>
	    </let>
	  <append n="verb">
          <get-case-from pos="1">
	    <lit v="essere"/>          
	   </get-case-from>
	    <lit-tag v="vbser"/>	    
            <lit-tag v="pri"/>
	    <clip pos="1" side="tl" part="pers"/>
	    <clip pos="1" side="tl" part="nbr"/>
	    <lit v="$ ^"/>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <lit-tag v="pp.m.sg"/>
	  </append>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="avere_pp"/>
	    </let>
	</when>
	<otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="avere_pp"/>
	    </let>
	  <append n="verb">
          <get-case-from pos="1">
	    <lit v="avere"/>
          </get-case-from>
	    <lit-tag v="vbhaver"/>	    
            <lit-tag v="pri"/>
	    <clip pos="1" side="tl" part="pers"/>
	    <clip pos="1" side="tl" part="nbr"/>
	    <lit v="$ ^"/>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <lit-tag v="pp.m.sg"/>
	  </append>
	</otherwise>
      </choose>
     </when>
     <otherwise>
       <let>
	  <var n="lemachunk"/>
          <lit v="verb"/>
       </let>
       <let>
	  <var n="verb"/>
          <concat>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
          </concat>
       </let>
     </otherwise>
    </choose>
    </def-macro>

    <def-macro n="tipus_verb" npar="1">
      <choose>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="v_amb_a"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipusverb"/>
	    <lit-tag v="vba"/>
	  </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="v_amb_en"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipusverb"/>
	    <lit-tag v="vben"/>
	  </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="v_no_part"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipusverb"/>
	    <lit-tag v="nopart"/>
	  </let>	  
	</when>
	<otherwise>
	  <let>
	    <var n="tipusverb"/>
	    <lit-tag v="nodef"/>
	  </let>
	</otherwise>
      </choose>
<!--			<choose>
    <when>
	  <test>
	  <in caseless="yes">
	  <clip pos="1" side="sl" part="lem"/>
	  <list n="vbcop"/>
	  </in>
	  </test>
	  <let>
	  <clip pos="1" side="sl" part="a_verb"/>
	  <lit-tag v="vbcop"/>
	  </let>
	  </when>
	  </choose>-->
    </def-macro>

    <def-macro n="tipus_nom" npar="1">
      <choose>
	<when>
	  <test>
	    <or>
	      <in caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<list n="nloc"/>
	      </in>
	      <equal>
		<clip pos="1" side="sl" part="tipus_np"/>
		<lit-tag v="loc"/>
	      </equal>
	    </or>
	  </test>
	  <let>
	    <var n="tipusnom"/>
	    <lit-tag v="loc"/>
	  </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="mes"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipusnom"/>
	    <lit-tag v="mes"/>
	  </let>
	</when>
      </choose>
    </def-macro>


<!--    <def-macro n="firstWord" npar="1" c="from es-en">
      <choose>
	<when>
          <test>
	    <equal> 
	      <var n="EOS"/>
	      <lit v="true"/>
	    </equal>
          </test>
          <choose>
            <when>
	      <test>
	        <equal>
	          <clip pos="1" side="sl" part="a_np_acr"/>
	          <lit v=""/>
	        </equal>
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	    </when>
          </choose>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="Aa"/>
	  </let>
	</when>
	<otherwise> 
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>-->

  <def-macro n="firstWord" npar="1" c="from ita-spa">
      <let>
        <var n="caseFirstWord"/>
        <case-of pos="1" side="sl" part="lem"/>
      </let>
      <choose>
	<when>
	  <test>
	    <equal>
	      <case-of pos="1" side="sl" part="lem"/>
	      <lit v="Aa"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
                <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_np_acr"/>
                    <lit v=""/>
                  </equal>
		  <equal> 
                    <clip pos="1" side="sl" part="a_num"/>
                    <lit v=""/>
		  </equal> 
                </and>
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	    </when>
          </choose>
        </when>
        <when>
          <test>
            <equal>
              <case-of pos="1" side="sl" part="lem"/>
              <lit v="AA"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_np_acr"/>
                    <lit v=""/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_num"/>
                    <lit v=""/>
                  </equal>
                  <equal>
                    <var n="EOS"/>
                    <lit v="true"/>
                  </equal>
                  <!-- and length(<clip pos="1" side="sl" part="lem"/> == 1) -->
                </and>
              </test>
              <let>
                <var n="caseFirstWord"/>
                <lit v="Aa"/>
              </let>
              <modify-case>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
	</when>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>


   <def-macro n="f_bcond" npar="2"><!--Para mirar si el blanco contiene o no formato. Hay que poner esta función en las reglas en que desaparezca alguna palabra, con tal de decidir si el blanco de la palabra eliminada debe eliminarse también o conservarse. Si contiene formato hay que conservarla, si no contiene formato hay que eliminarla para que no aparezcan dos espacios seguidos. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>



    <def-macro n="f_treuGDND" npar="1">
      <choose>
	<!--To determine value of variables of gender and
	    number and propagate to other rules.  Variables are
	    not used again in this rule -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="mf"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="mf"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <!-- If word has GD or ND, we try to assign the
		 gender or number of the previous rule. If there is no
		 value for the gender or number variable from previous
		 rules, gender will be masculine and number singular.-->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <var n="genero"/>
		  <lit-tag v="f"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="f"/>
	      </let>
	    </when>
	    <otherwise>
	      <let>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </let>
	      <let>
		<var n="genero"/>
		<lit-tag v="m"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <var n="numero"/>
		  <lit-tag v="pl"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <otherwise>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </let>
	      <let>
		<var n="numero"/>
		<lit-tag v="sg"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_concord1" npar="1">
      <choose>
	<!--To determine value of variables of gender and
	    number , and put in chunk tags -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>

	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <equal>
		<clip pos="1" side="sl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="mf"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>


	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sp"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="ND"/>
	  </let>
	</when>
      </choose>




   <!--   <choose>
	<when>
	  <test>
	    <!-+- If word has GD or ND, we try to assign the
		 gender or number of the previous rule. If there is no
		 value for the gender or number variable from previous
		 rules, gender will be masculine and number singular.-+->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <var n="genero"/>
		  <lit-tag v="f"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="f"/>
	      </let>
	    </when>
	    <otherwise>
	      <let>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </let>
	      <let>
		<var n="genero"/>
		<lit-tag v="m"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <var n="numero"/>
		  <lit-tag v="pl"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <otherwise>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </let>
	      <let>
		<var n="numero"/>
		<lit-tag v="sg"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose> -->
    </def-macro>
    

    <def-macro n="f_concord2" npar="2">
      <choose>
	<when>
	  <test>
	    <!-- do the main and second parameter gender agree?-->
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <!-- do the main and second parameter number agree?-->
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="true"/>
	  </let>
	  <!-- there is gender and number agreement-->
	</when>
	<otherwise>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="false"/>
	  </let>
	  <!-- there isn't gender and number agreement-->
	</otherwise>
      </choose>
      <choose>
	<when>
	  <test>
	    <!-- Propagate the main parameter gender if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <!-- Propagate the main parameter number if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <!-- Which is the rule general gender? -->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <or>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </and>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </and>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </and>
	    </or>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>

      </choose>
      <choose>
	<when>
	  <test>
	    <!-- Which is the rule general number? -->
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="ND"/>
	  </let>
	</when>
	<!--       <otherwise>
	     <let>
	     <var n="genero"/>
	     <lit-tag v="m"/>
	     </let>
	     </otherwise>-->
      </choose>
      <!-- Determine gender and number value if they are undetermined -->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>
    
    <def-macro n="f_concord3" npar="3">
      <choose>
	<!-- Look whether in source language there is concordance between first and second element -->
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="true"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="false"/>
	  </let>
	</otherwise>
      </choose>
      <choose>
	<!-- Look whether in source language there is concordance between second and third element -->
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concSegundo"/>
	    <lit v="true"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="concSegundo"/>
	    <lit v="false"/>
	  </let>
	</otherwise>
      </choose>
      <choose>
	<!-- Propagate the main parameter gender if it has been modified during the translation -->
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<!-- Propagate the main parameter number if it has been modified during the translation -->
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<!-- Determine the rule general gender. Priority order: main, second and third element -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="3" side="sl" part="gen"/>
	  </let>
	</when>
	
	<!--			<when>
	    <test>
	    <or>
	    <and>
	    <equal>
	    <clip pos="1" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    <equal>
	    <clip pos="2" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    <equal>
	    <clip pos="3" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    </and>
	    </test>
	    <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	    </let>
	    </when>-->
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	  </let>
	</otherwise>
      </choose>

      <choose>
	<!-- Determine the rule general number. Priority order: main, second and third element -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="3" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="ND"/>
	  </let>
	</when>
	
      </choose>
      <choose>
	<!-- Assign values to GD and ND -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>
    
    <def-macro n="f_concord4" npar="4">
      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="true"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="concPrimero"/>
	    <lit v="false"/>
	  </let>
	</otherwise>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concSegundo"/>
	    <lit v="true"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="concSegundo"/>
	    <lit v="false"/>
	  </let>
	</otherwise>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let>
	    <var n="concTercero"/>
	    <lit v="true"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="concTercero"/>
	    <lit v="false"/>
	  </let>
	</otherwise>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="3" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="4" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="4" side="sl" part="gen"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	  </let>
	</otherwise>
	<!--				<when>
	    <test>
	    <and>
	    <equal>
	    <clip pos="1" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    <equal>
	    <clip pos="2" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    <equal>
	    <clip pos="3" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    <equal>
	    <clip pos="4" side="tl" part="gen"/>
	    <lit-tag v="GD"/>
	    </equal>
	    </and>
	    </test>
	    <let>
	    <var n="genero"/>
	    <lit-tag v="GD"/>
	    </let>
	    </when>-->
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	

	<!--<when>
	    <test>
	    <and>
	    <equal>
	    <clip pos="1" side="tl" part="nbr"/>
	    <lit-tag v="ND"/>
	    </equal>
	    <equal>
	    <clip pos="2" side="tl" part="nbr"/>
	    <lit-tag v="ND"/>
	    </equal>
	    <equal>
	    <clip pos="3" side="tl" part="nbr"/>
	    <lit-tag v="ND"/>
	    </equal>
	    <equal>
	    <clip pos="4" side="tl" part="nbr"/>
	    <lit-tag v="ND"/>
	    </equal>
	    </and>
	    </test>
	    <let>
	    <var n="numero"/>
	    <lit-tag v="ND"/>
	    </let>
	    </when>-->
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="3" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="4" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="4" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="4" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="ND"/>
	  </let>
	</when>
	
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>

  </section-def-macros> 

  <section-rules>




    <!--*************************************** REGLES DE SN ******************************************** -->

    <rule comment="REGLA: NOM (per a collocar la cua en les multiparaules amb g) (apalancamiento = effetto leva)">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord1">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
        <when>
        <test>
           <in>
            <clip pos="1" side="sl" part="lemh"/>
            <list n="mes"/>
           </in>
        </test>
           <let>
             <var n="lemachunk"/>
             <lit v="mes"/>
           </let>
        </when>
        <otherwise>
           <let>
             <var n="lemachunk"/>
             <lit v="nom"/>
           </let>
        </otherwise>
        </choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	  <!--    <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag> -->
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: NUM (dos = due)">
      <pattern>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord1">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
        <when>
        <test>
          <or>         
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="11"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="12"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="13"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="14"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="15"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="16"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="17"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="18"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="19"/>
           </begins-with>
           <begins-with>
            <clip pos="1" side="sl" part="lem"/>
            <lit v="20"/>
           </begins-with>
         </or>
        </test>
           <let>
             <var n="lemachunk"/>
             <lit v="year"/>
           </let>
        </when>
        <otherwise>
           <let>
             <var n="lemachunk"/>
             <lit v="num"/>
           </let>
        </otherwise>
        </choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="NUM"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="REGLA: ANTROPÒNIM (Inmaculada = Immacolata)">
      <pattern>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

 <rule comment="REGLA: LOCATIVE (Roma = Roma)">
      <pattern>
	<pattern-item n="loc"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="loc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM (El coche = La macchina)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: PREDET DET NOM (Todos los días = Tutti i giorni)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="predet_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM (el tercero = il terzo)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
        <choose>
        <when>
          <test>
            <contains-substring>
               <clip pos="2" side="sl" part="lem"/>
               <lit v=":"/>
          </contains-substring>
          </test>
	<out>
	  <chunk name="det_ore_num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu> 
	    <b pos="1"/>
            <lu>
             <lit v="ora"/>
             <lit-tag v="n.f"/>
             <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	     <clip pos="1" side="tl" part="nbr_sp"/>	
            </lu>
            <b/>
	    <lu>     
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	    </lu>
	  </chunk>
	</out>	 
         </when> 
        <otherwise>
         <choose>
          <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/>
		<lit v="cada"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="cada_num"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="det_num"/>
	    </let>
	  </otherwise>		
	</choose>
	<out>
          <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	    </lu>
	  </chunk>
	</out>	  
       </otherwise>
       </choose>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM (tres chicos = tre ragazzi)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	    <out>  
	      <chunk name="num_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="genero"/></tag>
		  <tag><var n="numero"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_num"/>
		  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
		  <clip pos="1" side="tl" part="gen_mf"/>	 
		  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
		  <clip pos="1" side="tl" part="nbr_sp"/>	 
		</lu> 
		<b pos="1"/>
		<lu>     
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
		  <clip pos="2" side="tl" part="gen_mf"/>	 
		  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr_sp"/>	 
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
      </action>
    </rule>



    <rule comment="REGLA: NOM ADJ (flor amarilla = fiore giallo)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	
	<out>
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM (buen trabajo = buon lavoro)">
      <pattern>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: ADV ADJ (muy bonito = molto bello)">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="REGLA: DET ADV ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord3">
	  <with-param pos="4"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="DET NUMERAL NOM (Los cinco niños = I cinque bambini)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
      <choose>
        <when>
          <test>
          <and>
          <contains-substring>
               <clip pos="2" side="sl" part="lem"/>
               <lit v=":"/>
          </contains-substring>
          <equal>
               <clip pos="3" side="sl" part="lem"/>
               <lit v="hora"/>
          </equal> 
          </and>
          </test>
	<out>
	  <chunk name="det_ore_num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	    </lu>
	  </chunk>
	</out>
         </when>
         <otherwise>
        <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/>
		<lit v="cada"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="cada_num_nom"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="det_num_nom"/>
	    </let>
	  </otherwise>		
	</choose>

	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
       </otherwise>
       </choose>
      </action>
    </rule>


    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom_adj_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADJ (El árbol verde  = L'albero verde)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test> 
	      <equal>
		<clip pos="3" side="sl" part="a_adj"/>
		<lit-tag v="adj.pos"/>
	      </equal>
	    </test>
	<out>
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>

	<out>
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	  </otherwise>
	</choose>
      </action>
    </rule>
    


    <rule comment="REGLA: DET NOM ADJ ADJ (El perro ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test> 
	      <equal>
		<clip pos="4" side="sl" part="a_adj"/>
		<lit-tag v="adj.pos"/>
	      </equal>
	    </test>
	<out>
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>

	<out>
	  <chunk name="det_nom_adj_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	  </otherwise>
	</choose>
      </action>
    </rule>
    

    <rule comment="REGLA: DET ADJ (El grande = Il grande)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="a_adj"/>
		<lit-tag v="vblex"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="det_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="det_adj"/>
	    </let>
	  </otherwise>		
	</choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET ADJ NOM (Unos importantes ingresos = Delle importanti entrate)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET ADJ cnj	 ADJ NOM (Un soleado y bonito día = Una soleggiata e bella giornata)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adjec"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord4">
	  <with-param pos="5"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_adj_cnjcoo_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="5" side="tl" part="gen_mf"/>	 
	      <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr_sp"/>	 
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADV ADJ NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adv"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord3">
	  <with-param pos="4"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADJ NOM (Cuatro estresantes horas = quattro stressanti ore)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADJ cnj	 ADJ NOM (Un gran e importante cambio)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adjec"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adjec"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="f_concord4">
	  <with-param pos="5"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_adj_cnjcoo_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b pos="3"/>
	    
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="5" side="tl" part="gen_mf"/>	 
	      <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr_sp"/>	 
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    
    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    

    <rule comment="REGLA: NUM NOM ADV ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: NOM ADJ cnjcoo ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom_adj_cnjcoo_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="temps"/>
	      <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="4" side="tl" part="gen_mf"/>	 
	      <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr_sp"/>	 
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADJ cnjcoo ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adjec"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adjec"/>
      </pattern>
      <action>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="5"/>
	</call-macro>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom_adj_cnjcoo_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="3" side="tl" part="gen_mf"/>	 
	      <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr_sp"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="temps"/>
	      <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="5" side="tl" part="gen_mf"/>	 
	      <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr_sp"/>	 
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>


   <rule comment="REGLA: COMPAR ADJ QUE">
      <pattern>
	<pattern-item n="compar"/>
	<pattern-item n="adj"/>
	<pattern-item n="que_compar"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="comp_adj_que" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="2" side="tl" part="gen_mf"/>	 
	      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr_sp"/>	 
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="di"/>
	      <lit-tag v="pr"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  
   <rule comment="REGLA: COMPAR QUE">
      <pattern>
	<pattern-item n="compar"/>
	<pattern-item n="que_compar"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="comp_que" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="comp_que"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <lit v="di"/>
	      <lit-tag v="pr"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    


    <rule comment="REGLA: ADJECTIU (quan no acompanya res o va amb desconeguda)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="genero"/></tag>
	      <tag><var n="numero"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 
    
 <rule comment="REGLA: PARTICIPIO">
      <pattern>
	<pattern-item n="pptot"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="gen" link-to="2"/>	 
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>	 
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGLA: PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <let>
	      <var n="lemachunk"/>
	      <clip pos="1" side="sl" part="lem"/> 
	</let>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>

<rule comment="REGLA: ADV ">
      <pattern>
	<pattern-item n="adv_preadv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <let>
             <var n="tipusadv"/>
             <clip pos="1" side="tl" part="lem"/>
        </let>
	<out>
	  <chunk namefrom="tipusadv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="ADV"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="REGLA: DET(quan no acompanya res o va amb desconeguda)">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>	 
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>	 
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 
    
    <rule comment="REGLA: cnj">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="CNJ"/></tag>
	      <tag><clip pos="1" side="tl" part="a_cnj"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 

	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 
    
    
    <rule> <!-- REGLA: PRONOM -->
      <pattern>
	<pattern-item n="prn"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test> 
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test> 
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </let>
	  </when>
	</choose>	
	<out>  
	  <chunk name="pronom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>	 
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	      <let>
		<var n="genero"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	      <let>
		<var n="numero"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
      </action>
    </rule>




    <rule comment="REGLA: hay : c'è (gender is calculated in interchunk stage) ">
      <pattern>
	<pattern-item n="hay"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
          <out>
	  <chunk name="hay" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
            <lu>
             <lit v="ci"/>
             <lit-tag v="prn.pro.adv"/>
            </lu>
            <b/>
	    <lu>   
	      <lit v="essere"/>
	      <lit-tag v="vbser"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>	 
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="REGLA: VERB ">
      <pattern>
	<pattern-item n="verb"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="deber# de"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/>
		<lit v="hay"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="hay"/>
	    </let>
          <out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>	 
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	  </when>
	  <otherwise>
	  <call-macro n="check_ifi">
	  <with-param pos="1"/>
	  </call-macro>	
        <out>
            <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	
	      
	    </tags> 
	    <lu>
              <var n="verb"/>
	    </lu>
	  </chunk>
        </out> 
        </otherwise>
	</choose>
      </action>
    </rule>



  <rule comment="REGLA: VERB ENC">
      <pattern>
	<pattern-item n="verb"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="verb_enc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <mlu>
	      <lu>   
		<clip pos="1" side="tl" part="lemh"/> 
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="gen"/>	 
		<clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </lu> 
	      <lu>
		<clip pos="2" side="tl" part="whole"/> 
		<clip pos="1" side="tl" part="lemq"/>
	      </lu>
	    </mlu>
	  </chunk>
	</out>
      </action>
    </rule> 

  <rule comment="REGLA: VERB ENC ENC">
      <pattern>
	<pattern-item n="verb"/>
	<pattern-item n="prnenc"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="verb_enc_enc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <mlu>
	      <lu>   
		<clip pos="1" side="tl" part="lemh"/> 
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="gen"/>	 
		<clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </lu> 
	      <lu>
		<clip pos="2" side="tl" part="whole"/> 
	      </lu>
	      <lu>
		<clip pos="3" side="tl" part="whole"/> 
		<clip pos="1" side="tl" part="lemq"/>
	      </lu>
	    </mlu>
	  </chunk>
	</out>
      </action>
    </rule> 
    
  
   
 <rule comment="REGLA: HABER PP ">
      <pattern>
	<pattern-item n="haber"/>
	<pattern-item n="ppmsg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	     <test>
	       <in caseless="yes">
		 <clip pos="2" side="tl" part="lem"/>
		 <list n="auxser"/>
	       </in>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="essere"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="essere_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="avere_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen"/>	 
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 



   
 <rule comment="REGLA: HABER PP ">
      <pattern>
	<pattern-item n="haber"/>
	<pattern-item n="ppmsg"/>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	     <test>
	       <in caseless="yes">
		 <clip pos="2" side="tl" part="lem"/>
		 <list n="auxser"/>
	       </in>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="essere"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="essere_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="avere_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
            <lu>
	      <clip pos="3" side="tl" part="whole"/> 
            </lu>
            <b pos="2"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen"/>	 
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 

<rule comment="REGLA: HABER MOD INF ">
      <pattern>
	<pattern-item n="haber"/>
	<pattern-item n="mod"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	       <in caseless="yes">
		 <clip pos="3" side="tl" part="lem"/>
		 <list n="auxser"/>
	       </in>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="essere"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="ser_mod_inf"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lemachunk"/>
	      <lit v="haber_mod_inf"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lemachunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen"/>	 
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: ESTAR PP ">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
        <let>
	  <clip pos="1" side="tl" part="lem"/>
	  <lit v="essere"/>
	</let>
	<let>
	  <clip pos="1" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="pers"/>
		<lit v=""/>
	      </equal>
	    </test>
	<out>
	  <chunk name="estar_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen" link-to="4"/>	 
	      <clip pos="2" side="tl" part="nbr" link-to="5" />
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>
	<out>
	  <chunk name="estar_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="gen" link-to="5"/>	 
	      <clip pos="2" side="tl" part="nbr" link-to="6" />
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	  </otherwise>
	</choose>
      </action>
    </rule> 
    
    <rule comment="REGLA: CABER INF"> <!--luca-->
      <pattern>
	<pattern-item n="caber"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="lem"/>
	  <lit v="essere# possibile"/>
	</let>
	<let>
	  <clip pos="1" side="tl" part="a_verb"/>
	  <lit-tag v="vblex"/>
	</let>
	<out>
	  <chunk name="caber_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>  
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule> 
   
  <rule comment="REGLA: ESTAR SIENDO ">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="siendo"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	   <clip pos="1" side="tl" part="lem"/>
	   <lit v="essere"/>
	</let>
	<let>
	  <clip pos="1" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<out>
	  <chunk name="verb" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
      </action>
    </rule>

    <rule comment="REGLA: HABER sido PP ">
      <pattern>
	<pattern-item n="haber"/>
	<pattern-item n="sido"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="lem"/>
	  <lit v="essere"/>
	</let>
	<let>
	  <clip pos="1" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<clip pos="3" side="sl" part="nbr"/>
	      </equal>
	    </test>		
	    <out>
	      <chunk name="haber_sido_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="gen"/>	 
		  <clip pos="1" side="tl" part="nbr" link-to="6"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="gen" link-to="5"/>	 
		  <clip pos="2" side="tl" part="nbr" link-to="6"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="gen" link-to="5"/>	 
		  <clip pos="3" side="tl" part="nbr" link-to="6"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--si número no coincide en sl, tampoco debe hacerlo en tl (no se enlaza nbr con el chunk) -->	    
	    <out>
	      <chunk name="haber_sido_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="gen"/>	 
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="gen" link-to="5"/>	 
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="gen" link-to="5"/>	 
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
      </action>
    </rule> 


    <rule comment="REGLA: IR A INF">
      <pattern>
	<pattern-item n="ir"/>
	<pattern-item n="a"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="imp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="prs"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pri"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		  </or>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="imp"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="imp"/>
		</let>
	      </when>
	    </choose>
	      <out>
		<chunk name="verb" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="3" side="tl" part="temps"/></tag>
		    <tag><clip pos="1" side="tl" part="pers"/></tag>
		    <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		  </tags>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="temps"/>
		    <clip pos="1" side="tl" part="pers"/>	 
		    <clip pos="1" side="tl" part="nbr" />
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out>	      
	      <call-macro n="f_bcond">
	          <with-param pos="1"/>
	          <with-param pos="2"/>
	      </call-macro>
	     <call-macro n="f_bcond">
	          <with-param pos="2"/>
	          <with-param pos="3"/>
	      </call-macro>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="lem"/>
		  <lit v="stare"/>
		</let>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="ger"/>
		</let> 
		<out>
		<chunk name="stare_inf" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="1" side="tl" part="temps"/></tag>
		    <tag><clip pos="1" side="tl" part="pers"/></tag>
		    <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		  </tags> 
		  <lu>
		    <clip pos="1" side="tl" part="whole"/> 
		  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="temps"/>
		    <clip pos="3" side="tl" part="gen"/>	 
		    <clip pos="3" side="tl" part="nbr" />
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out> 
	      <call-macro n="f_bcond">
	          <with-param pos="2"/>
	          <with-param pos="3"/>
	      </call-macro>
	      </when>
	      <otherwise>
	      <out>
		<chunk name="ir_a_inf" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="1" side="tl" part="temps"/></tag>
		    <tag><clip pos="1" side="tl" part="pers"/></tag>
		    <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		  </tags> 
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="temps"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>	 
		    <clip pos="1" side="tl" part="nbr" />
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="whole"/> 
		  </lu>
		  <b pos="2"/>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="temps"/>
		    <clip pos="3" side="tl" part="gen"/>	 
		    <clip pos="3" side="tl" part="nbr" />
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

  <rule comment="REGLA: PROCL IR A INF">
      <pattern>
	<pattern-item n="prnpro"/>
	<pattern-item n="ir"/>
	<pattern-item n="a"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="2"/>
	</call-macro>
	<out>  
	  <chunk name="pronom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	    <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="imp"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="prs"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="pri"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		  </or>
		</test>
		<let>
		  <clip pos="4" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="imp"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="temps"/>
		  <lit-tag v="imp"/>
		</let>
	      </when>
	    </choose>
	      <out>
		<chunk name="verb" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="4" side="tl" part="temps"/></tag>
		    <tag><clip pos="2" side="tl" part="pers"/></tag>
		    <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
		  </tags>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/> 
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="temps"/>
		    <clip pos="2" side="tl" part="pers"/>	 
		    <clip pos="2" side="tl" part="nbr" />
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out>	      
	       <call-macro n="f_bcond">
	          <with-param pos="2"/>
	          <with-param pos="3"/>
	      </call-macro> 
              <call-macro n="f_bcond">
	          <with-param pos="3"/>
	          <with-param pos="4"/>
	      </call-macro>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="lem"/>
		  <lit v="stare"/>
		</let>
		<let>
		  <clip pos="4" side="tl" part="temps"/>
		  <lit-tag v="ger"/>
		</let> 
		<out>
		<chunk name="stare_inf" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="2" side="tl" part="temps"/></tag>
		    <tag><clip pos="2" side="tl" part="pers"/></tag>
		    <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
		  </tags> 
		  <lu>
		    <clip pos="2" side="tl" part="whole"/> 
		  </lu>
		  <b pos="2"/>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/> 
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="temps"/>
		    <clip pos="4" side="tl" part="gen"/>	 
		    <clip pos="4" side="tl" part="nbr" />
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out> 
	       <call-macro n="f_bcond">
	          <with-param pos="3"/>
	          <with-param pos="4"/>
	      </call-macro>
	      </when>
	      <otherwise>
	      <out>
		<chunk name="ir_a_inf" case="caseFirstWord">
		  <tags>
		    <tag><lit-tag v="SV"/></tag>
		    <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		    <tag><clip pos="2" side="tl" part="temps"/></tag>
		    <tag><clip pos="2" side="tl" part="pers"/></tag>
		    <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
		  </tags> 
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>	 
		    <clip pos="2" side="tl" part="nbr" />
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		  <b pos="2"/>
		  <lu>
		    <clip pos="3" side="tl" part="whole"/> 
		  </lu>
		  <b pos="3"/>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/> 
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="temps"/>
		    <clip pos="4" side="tl" part="gen"/>	 
		    <clip pos="4" side="tl" part="nbr" />
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu>
		</chunk>
	      </out>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>   



    <rule comment="REGLA: HACE DET NOM ">
      <pattern>
	<pattern-item n="hacer"/>
	<pattern-item n="adjdetnum"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="f_concord2">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="3" side="sl" part="lem"/>
		<list n="temporales"/>
	      </in>
	    </test>
	    <out>
	      <chunk name="hacer_det_temp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SADV"/></tag>	      
	    </tags>
	    <lu>    
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>	 
	      <clip pos="3" side="tl" part="nbr"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>	 
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>
	<out>
	  <chunk name="hacer_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>	 
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/> 
	    <lu>    
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>	 
	      <clip pos="3" side="tl" part="nbr"/>	 
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	  </otherwise>

	</choose>
      </action>
    </rule>

    <rule> <!-- hora -->
      <pattern>
	<pattern-item n="de"/>
	<pattern-item n="time"/>
	<pattern-item n="a"/>
	<pattern-item n="time"/>
      </pattern>
      <action>
      <call-macro n="firstWord">
	<with-param pos="1"/>
      </call-macro>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="da"/>
	  </let>
      <choose>
	<when>
	  <test>
	    <or>
	      <begins-with>
		<clip pos="2" side="sl" part="lem"/>
		<lit v="01:"/>
	      </begins-with>
	      <begins-with>
		<clip pos="2" side="sl" part="lem"/>
		<lit v="1:"/>
	      </begins-with>
	    </or>
	  </test>
	  <let>
	    <var n="articulo1"/>
	    <lit v="il"/>
	  </let>
	  <append n="articulo1">
	    <lit-tag v="det.def.f.sg"/>
	  </append>
	</when>
	<otherwise>
	  <let>
	    <var n="articulo1"/>
	    <lit v="il"/>
	  </let>
	  <append n="articulo1">
	    <lit-tag v="det.def.f.pl"/>
	  </append>
	</otherwise>
      </choose>
      <choose>
	<when>
	  <test>
	    <or>
	      <begins-with>
		<clip pos="4" side="sl" part="lem"/>
		<lit v="01:"/>
	      </begins-with>
	      <begins-with>
		<clip pos="4" side="sl" part="lem"/>
		<lit v="1:"/>
	      </begins-with>
	    </or>
	  </test>
	  <let>
	    <var n="articulo2"/>
	    <lit v="il"/>
	  </let>
	  <append n="articulo2">
	    <lit-tag v="det.def.f.sg"/>
	  </append>
	</when>
	<otherwise>
	  <let>
	    <var n="articulo2"/>
	    <lit v="il"/>
	  </let>
	  <append n="articulo2">
	    <lit-tag v="det.def.f.pl"/>
	  </append>
	</otherwise>	  
	</choose>
	<out>
	  <chunk name="de_time_a_time" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SP"/></tag>	      
	    </tags> 
	    <lu>    
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <var n="articulo1"/>
	    </lu>
	    <b/>
	    <lu>    
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>  
	    <lu>    
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b pos="3"/> 
	    <lu> 
	      <var n="articulo2"/>
	    </lu>
	    <b/> 
	    <lu>    
	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
      </rule>
      


    <rule> <!-- REGLA: procl verbo-->
      <pattern>
	<pattern-item n="prnpro"/>
	<pattern-item n="vblex"/>
      </pattern>
      <action>
	<call-macro n="f_treuGDND">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	    <!--  <and>
		<in caseless="yes">
		  <clip pos="2" side="tl" part="lem"/>
		  <list n="vbnoref"/>
		</in>-->
		<or>
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="tipoenc_pro"/>
		      <lit-tag v="ref.p3.mf.sp"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="pers"/>
		      <lit-tag v="p3"/>
		    </equal>
		  </and>
		  <and>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <clip pos="2" side="sl" part="pers"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		</and>
	      </or>
<!--	      </and>
-->
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>	      
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="whole"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/> 
              <with-param pos="2"/>
	    </call-macro>
	  </when>
	<otherwise>
          <choose>
            <when>
              <test>
               <and>          
		  <equal>
		    <var n="tipusadv"/>
		    <lit v="non"/>
		  </equal>
               <or>
                  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
                  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
	       </or>	 
               </and>
	      </test>    
          <out>
	    <chunk name="inf_enc" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="2" side="tl" part="a_verb"/></tag>
		<tag><clip pos="2" side="tl" part="temps"/></tag>
		<tag><clip pos="2" side="tl" part="pers"/></tag>
		<tag><clip pos="2" side="tl" part="gen"/></tag>
		<tag><clip pos="2" side="tl" part="nbr"/></tag>	      
	      </tags>
              <mlu>
	      <lu>   
		<clip pos="2" side="tl" part="lem"/>
		<clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="inf"/> 
	      </lu>
	      <lu>   
		<clip pos="1" side="tl" part="lem"/> 
                <lit-tag v="prn.enc"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="gen"/>	 
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="lemq"/>
	      </lu>
             </mlu>
	    </chunk>
	  </out>
         </when>
         <otherwise>
	  <out>
	    <chunk name="pro_verbcj" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="2" side="tl" part="a_verb"/></tag>
		<tag><clip pos="2" side="tl" part="temps"/></tag>
		<tag><clip pos="2" side="tl" part="pers"/></tag>
		<tag><clip pos="2" side="tl" part="gen"/></tag>
		<tag><clip pos="2" side="tl" part="nbr"/></tag>	      
	      </tags>
	      <lu>   
		<clip pos="1" side="tl" part="whole"/> 
	      </lu>
	      <b pos="1"/>
	      <lu>   
		<clip pos="2" side="tl" part="lemh"/> 
		<clip pos="2" side="tl" part="a_verb"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="pers"/>
		<clip pos="2" side="tl" part="gen"/>	 
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="lemq"/>
	      </lu>
	    </chunk>
	  </out>
        </otherwise>
        </choose>
	</otherwise>
	</choose>
      </action>
    </rule>



    <rule> <!-- REGLA: procl procl verbo-->
      <pattern>
	<pattern-item n="prnpro"/>
	<pattern-item n="prnpro"/>
	<pattern-item n="vblex"/>
      </pattern>
      <action>
	<call-macro n="f_treuGDND">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_treuGDND">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	<!--     <and>
		<test>
		  <clip pos="3" side="tl" part="lem"/>
		  <list n="vbnoref"/>
		</in>-->
		<or>
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="tipoenc_pro"/>
		      <lit-tag v="ref.p3.mf.sp"/>
		    </equal>
		    <equal>
		      <clip pos="3" side="sl" part="pers"/>
		      <lit-tag v="p3"/>
		    </equal>
		  </and>
		  <and>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <clip pos="3" side="sl" part="pers"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="3" side="sl" part="nbr"/>
		  </equal>
                  <not>
                  <equal>
		    <var n="tipusadv"/>
		    <lit v="non"/>
		  </equal>
                  </not>    
		</and>
	      </or>
<!--	      </and>-->
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>	      
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="whole"/> 
		</lu>

                <b pos="2"/>

		<lu>   
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/> 
              <with-param pos="2"/>
	    </call-macro>
	  </when>
	<otherwise>
          <choose>
            <when>
            <test>
             <and>          
		  <equal>
		    <var n="tipusadv"/>
		    <lit v="non"/>
		  </equal>
               <or>
                  <equal>
		    <clip pos="3" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
                  <equal>
		    <clip pos="3" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
	       </or>	 
               </and>
           </test>
          <out>
	    <chunk name="inf_enc" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="3" side="tl" part="a_verb"/></tag>
		<tag><clip pos="3" side="tl" part="temps"/></tag>
		<tag><clip pos="3" side="tl" part="pers"/></tag>
		<tag><clip pos="3" side="tl" part="gen"/></tag>
		<tag><clip pos="3" side="tl" part="nbr"/></tag>	      
	      </tags>
              <mlu>
	      <lu>   
		<clip pos="3" side="tl" part="lem"/>
		<clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="inf"/> 
	      </lu>
	      <lu>   
		<clip pos="2" side="tl" part="lem"/> 
                <lit-tag v="prn.enc"/>
		<clip pos="2" side="tl" part="pers"/>
		<clip pos="2" side="tl" part="gen"/>	 
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
             </mlu>
	    </chunk>
	  </out>
         </when>
         <otherwise>
	  <out>
	    <chunk name="pro_pro_verbcj" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="3" side="tl" part="a_verb"/></tag>
		<tag><clip pos="3" side="tl" part="temps"/></tag>
		<tag><clip pos="3" side="tl" part="pers"/></tag>
		<tag><clip pos="3" side="tl" part="gen"/></tag>
		<tag><clip pos="3" side="tl" part="nbr"/></tag>	      
	      </tags>
	      <lu>   
		<clip pos="1" side="tl" part="whole"/> 
	      </lu>
	      <b pos="1"/>
	      <lu>   
		<clip pos="2" side="tl" part="whole"/> 
	      </lu>
	      <b pos="2"/>
	      <lu>   
		<clip pos="3" side="tl" part="lemh"/> 
		<clip pos="3" side="tl" part="a_verb"/>
		<clip pos="3" side="tl" part="temps"/>
		<clip pos="3" side="tl" part="pers"/>
		<clip pos="3" side="tl" part="gen"/>	 
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </chunk>
	  </out>
        </otherwise>
        </choose>
	</otherwise>
	</choose>
      </action>
    </rule>


<rule> <!-- REGLA: verbo noreflexivo encl-->
      <pattern>
	<pattern-item n="verbnoref"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>
	<call-macro n="f_treuGDND">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="1" side="tl" part="lem"/>
		<list n="vbnoref"/>
	      </in>
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>	      
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="whole"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="verbcj_enc" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="1" side="tl" part="a_verb"/></tag>
		<tag><clip pos="1" side="tl" part="temps"/></tag>
		<tag><clip pos="1" side="tl" part="pers"/></tag>
		<tag><clip pos="1" side="tl" part="gen"/></tag>
		<tag><clip pos="1" side="tl" part="nbr"/></tag>	      
	      </tags>
	      <mlu>   
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="gen"/>	 
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<lu>
		  <clip pos="2" side="tl" part="whole"/> 
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </mlu>
	      </chunk>
	    </out>
	  </otherwise>
	     
	</choose>
      </action>
</rule>

 

<rule comment="REGLA: REF PROCL VERB ">
      <pattern>
	<pattern-item n="prnref"/>
	<pattern-item n="prnpro"/>
	<pattern-item n="vblex"/>
      </pattern>
      <action>
	<call-macro n="f_treuGDND">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="3"/>
	</call-macro>
	<out>
	  <chunk name="ref_pro_vb" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="pers"/>
	      <clip pos="3" side="tl" part="gen"/>	 
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 

<rule comment="REGLA: Continuar/seguir + ger = continuare a + inf (continúa siendo : continua a essere) ">
      <pattern>
	<pattern-item n="verbcontinuar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
          <when>
            <test>
            <or>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="continuar"/>   
              </equal>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="seguir"/>   
              </equal>
            </or>           
            </test>
              <let>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="continuare"/>   
              </let>
              <let>
                 <var n="tipusprep"/>
                <lit v="a"/>   
              </let>           
          </when>
         </choose>
        <choose>
          <when>
            <test>
            <or>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="empezar"/>   
              </equal>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="comenzar"/>   
              </equal>
            </or>           
            </test>
              <let>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="cominciare"/>   
              </let>
              <let>
                 <var n="tipusprep"/>
                <lit v="per"/>   
              </let>
          </when>
         </choose>
        <choose>
          <when>
            <test>
            <or>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="acabar"/>   
              </equal>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="terminar"/>   
              </equal>
            </or>
            </test>
              <let>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="finire"/>   
              </let>
              <let>
                 <var n="tipusprep"/>
                <lit v="per"/>   
              </let>           
          </when>
         </choose>
	  <call-macro n="check_ifi">
	  <with-param pos="1"/>
	  </call-macro>
	<out>
	  <chunk name="verb_prep_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="verb"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="tipusprep"/>
              <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 
 
<rule comment="REGLA: Conseguir/lograr + inf = riuscire a(d) + inf (logará llegar : riuscira ad arrivare) ">
      <pattern>
	<pattern-item n="verbconseguir"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="canvia_fts">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
          <when>
            <test>
            <or>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="conseguir"/>   
              </equal>
              <equal>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="lograr"/>   
              </equal>
            </or>           
            </test>
              <let>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="riuscire"/>   
              </let>
              <let>
                 <var n="tipusprep"/>
                <lit v="a"/>   
              </let>           
          </when>
         </choose>
	  <call-macro n="check_ifi">
	  <with-param pos="1"/>
	  </call-macro>
	<out>
	  <chunk name="verb_prep_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
              <var n="verb"/>
	      <!--<clip pos="1" side="tl" part="whole"/>-->
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="tipusprep"/>
              <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule> 
 
  


    <rule> <!-- REGLA: reset variables-->
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <clip pos="1" side="sl" part="nbr"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genero"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  </section-rules>
</transfer>
