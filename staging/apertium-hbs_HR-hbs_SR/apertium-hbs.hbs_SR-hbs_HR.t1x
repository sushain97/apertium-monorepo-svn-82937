<?xml version="1.0" encoding="UTF-8"?>

<!-- -*- nxml -*- -->

<transfer>

<section-def-cats>
  <def-cat n="CAT__adj_">
    <cat-item tags="adj.*"/>
    <cat-item tags="adj"/>
  </def-cat>

 <def-cat n="CAT__adjpp_">
    <cat-item tags="adj.*"/>
    <cat-item tags="vblex.perf.tv.pp.*"/>
    <cat-item tags="vblex.imperf.tv.pp.*"/>
    <cat-item tags="vblex.perf.iv.pp.*"/>
    <cat-item tags="vblex.imperf.iv.pp.*"/>
    <cat-item tags="vblex.perf.ref.pp.*"/>
    <cat-item tags="vblex.imperf.ref.pp.*"/>
  </def-cat>

  <def-cat n="CAT__adv_">
    <cat-item tags="adv.*"/>
    <cat-item tags="adv"/>
  </def-cat>
  <def-cat n="CAT__cnjcoo_">
    <cat-item tags="cnjcoo.*"/>
    <cat-item tags="cnjcoo"/>
  </def-cat>
  <def-cat n="CAT__cnjsub_">
    <cat-item tags="cnjsub.*"/>
    <cat-item tags="cnjsub"/>
  </def-cat>
  <def-cat n="CAT__da_">
    <cat-item lemma="da" tags="cnjsub.*"/>
    <cat-item lemma="da" tags="cnjsub"/>
    <cat-item lemma="da" tags="part.*"/>
    <cat-item lemma="da" tags="part"/>
    <!-- <cat-item lemma="dati" tags="vblex.*"/> --> <!-- until we fix tagger-->
  </def-cat>
  <def-cat n="CAT__se_">
    <cat-item lemma="sebe" tags="prn.ref.clt.pers.mfn.sp.acc"/>
  </def-cat>
  <def-cat n="CAT__da_li_">
    <cat-item lemma="da li" tags="part.itg"/>
    <cat-item lemma="da li" tags="cnjsub"/>
  </def-cat>
  <def-cat n="CAT__htjeticlt_">
    <cat-item lemma="htjeti" tags="vbmod.clt.futI.*"/>
  </def-cat>
  <def-cat n="CAT__vbclt_">
    <cat-item tags="vbser.clt.*"/>
    <cat-item tags="vbmod.clt.*"/>
  </def-cat>
  <def-cat n="CAT__vbhtjetibitineg_">
    <cat-item lemma="htjeti" tags="vbmod.clt.futI.*"/>
    <cat-item lemma="biti" tags="vbser.clt.pres.*"/>
  </def-cat>

  <def-cat n="CAT__trebati_">    
    <cat-item lemma="trebati" tags="vbmod.lp.nt.*"/> <!-- gender agreement problematic -->
    <cat-item lemma="trebati" tags="vbmod.pres.p3.sg"/>
    <cat-item lemma="trebati" tags="vblex.*.lp.nt.*"/> <!-- gender agreement problematic + tagger problem -->
    <cat-item lemma="trebati" tags="vblex.*.pres.p3.sg"/> <!-- tagger problem -->
    <cat-item lemma="treba" tags="n.*"/> <!-- tagger mistake -->
  </def-cat>

 <def-cat n="CAT__posadj_">
    <cat-item lemma="pos" tags="adj.*"/>
  </def-cat>

  <def-cat n="CAT__n_">
    <cat-item tags="n.*"/>
    <cat-item tags="n"/>
  </def-cat>
  <def-cat n="CAT__np_">
    <cat-item tags="np.*"/>
    <cat-item tags="np"/>
  </def-cat>
  <def-cat n="CAT__alln_">
    <cat-item tags="np.*"/>
    <cat-item tags="n.*"/>
    <cat-item tags="n"/>
    <cat-item tags="np"/>
  </def-cat>
  <def-cat n="CAT__num_">
    <cat-item tags="num.*"/>
    <cat-item tags="num"/>
  </def-cat>
  <def-cat n="CAT__part_">
    <cat-item tags="part.*"/>
    <cat-item tags="part"/>
  </def-cat>

  <def-cat n="CAT__nepart_">
    <cat-item lemma="ne" tags="part.neg"/>
  </def-cat>

  <def-cat n="CAT__pr_">
    <cat-item tags="pr.*"/>
    <cat-item tags="pr"/>
  </def-cat>
  <def-cat n="CAT__prn_">
    <cat-item tags="prn.*"/>
    <cat-item tags="prn"/>
  </def-cat>
  <def-cat n="CAT__relprn_">
    <cat-item lemma="koji" tags="prn.rel.*"/>
  </def-cat>
  <def-cat n="CAT__premprn_"> <!-- premodifying pronouns -->
    <cat-item tags="prn.dem.*"/>
    <cat-item tags="prn.ref.pos.*"/>
    <cat-item tags="prn.pos.*"/>
    <cat-item tags="prn.tot.*"/>
    <!-- <cat-item tags="prn.itg.*"/>
    <cat-item tags="prn.rel.*"/>  have fun future me -->
  </def-cat>
  <def-cat n="CAT__vblex_">
    <cat-item tags="vblex.*"/>
    <cat-item tags="vblex"/>
  </def-cat>
  <def-cat n="CAT__vbmod_">
    <cat-item tags="vbmod.*"/>
    <cat-item tags="vbmod"/>
  </def-cat>
 <def-cat n="CAT__vbmodals_"> <!-- extend when others are found-->
    <cat-item lemma="htjeti" tags="vbmod.*"/>
    <cat-item lemma="htjeti" tags="vblex.*"/>
    <cat-item lemma="moći" tags="vbmod.*"/>
    <cat-item lemma="moći" tags="vblex.*"/>
    <cat-item lemma="znati" tags="vblex.*"/>
    <cat-item lemma="trebati" tags="vblex.*"/>
    <cat-item lemma="morati" tags="vbmod.*"/>
    <cat-item lemma="morati" tags="vblex.*"/>
    <cat-item lemma="smjeti" tags="vblex.*"/>
    <cat-item lemma="željeti" tags="vblex.*"/>
    <cat-item lemma="voljeti" tags="vblex.*"/>
    <cat-item lemma="umjeti" tags="vblex.*"/>
  </def-cat>

  <def-cat n="CAT__vbser_">
    <cat-item tags="vbser.*"/>
    <cat-item tags="vbser"/>
  </def-cat>

  <def-cat n="CAT__vbseraor_">
    <cat-item tags="vbser.*.aor.*"/>
  </def-cat>

  <def-cat n="CAT__vb_">
    <cat-item tags="vblex.*"/>
    <cat-item tags="vbmod.*"/>
    <cat-item tags="vbser.*"/>
  </def-cat>

  <def-cat n="CAT__vbinf_">
    <cat-item tags="vblex.*.inf"/>
    <cat-item tags="vbmod.inf"/>
    <cat-item tags="vbser.inf"/>
  </def-cat>
  
  <def-cat n="CAT__vbtrans_">
    <cat-item tags="vblex.*.tv.lp.*"/>
    <cat-item tags="vblex.*.tv.pres.*"/>    
  </def-cat>  
  
  <def-cat n="CAT__vblexlp_">
    <cat-item tags="vblex.*.*.lp.*"/>    
  </def-cat>  

  <def-cat n="CAT__vbtransref_">
    <cat-item tags="vblex.*.tv.lp.*"/>
    <cat-item tags="vblex.*.tv.pres.*"/>  
    <cat-item tags="vblex.*.ref.lp.*"/>
    <cat-item tags="vblex.*.ref.pres.*"/>
  </def-cat>  

 <def-cat n="CAT__vblexpp_">
    <cat-item tags="vblex.*.pp.*"/>
  </def-cat>

  <def-cat n="CAT__vblexmodpres_">
    <cat-item tags="vblex.*.*.pres.*"/>
    <cat-item tags="vbmod.pres.*"/>
  </def-cat>
  
  <def-cat n="CAT__vblexpres_">
    <cat-item tags="vblex.*.*.pres.*"/>
    <cat-item tags="vbser.futII.pres.*"/>
  </def-cat>



<def-cat n="CAT__HASGENDER_NUMBER">
    <cat-item tags="*.m.*"/>
     <cat-item tags="*.f.*"/>
     <cat-item tags="*.sg.*"/>
     <cat-item tags="*.pl.*"/>
     </def-cat>  
<def-cat n="CAT__ND_GD">
    <cat-item tags="*.mf.*"/>
    <cat-item tags="*.sp.*"/>
    <cat-item tags="*.mf.sp.*"/>
    <cat-item tags="*.sp.mf.*"/>
    <cat-item tags="*.mf.*.sp.*"/>
    <cat-item tags="*.sp.*.mf.*"/>
  </def-cat>
  <def-cat n="sent">
    <cat-item tags="sent"/>
    <cat-item tags="RESsent.sent"/>
  </def-cat>
  <def-cat n="comma">
    <cat-item tags="cm"/>
  </def-cat>
  <def-cat n="any">
    <cat-item tags="*"/>
  </def-cat>
</section-def-cats>
<section-def-attrs> 

    <def-attr n="a_adjpp">
      <attr-item tags="adj"/>
      <attr-item tags="vblex.perf.tv.pp"/>
      <attr-item tags="vblex.imperf.tv.pp"/>
      <attr-item tags="vblex.perf.iv.pp"/>
      <attr-item tags="vblex.imperf.iv.pp"/>
      <attr-item tags="vblex.perf.ref.pp"/>
      <attr-item tags="vblex.imperf.ref.pp"/>
    </def-attr>

  <def-attr n="a_adj">
      <attr-item tags="adj"/>
    </def-attr>

<!--  <def-attr n="a_posadj">
      <attr-item tags="???"/>
    </def-attr>-->

    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="np"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.top"/>
      <attr-item tags="np.cog"/>
      <attr-item tags="np.al"/>
    </def-attr>
    
    
    <def-attr n="a_prn">
      <attr-item tags="prn"/>
      <attr-item tags="prn.dem"/>
      <attr-item tags="prn.rel"/>
      <attr-item tags="prn.tot"/>
      <attr-item tags="prn.pos"/>
      <attr-item tags="prn.pers"/>
      <attr-item tags="prn.itg"/>
      <attr-item tags="prn.neg"/>
      <attr-item tags="prn.ind"/>
    </def-attr>

<def-attr n="learned_verbcat">
    <attr-item tags="vblex"/>
    <attr-item tags="vbmod"/>
    <attr-item tags="vbser"/>
  </def-attr>
  <def-attr n="learned_adjtype">
    <attr-item tags="comp"/>
    <attr-item tags="pos"/>
    <attr-item tags="pst"/>
    <attr-item tags="ssup"/>
    <attr-item tags="sup"/>
  </def-attr>
  <def-attr n="learned_advtype">
    <attr-item tags="comp"/>
    <attr-item tags="itg"/>
    <attr-item tags="pst"/>
    <attr-item tags="ssup"/>
    <attr-item tags="sup"/>
  </def-attr>
  <def-attr n="learned_case">
    <attr-item tags="acc"/>
    <attr-item tags="dat"/>
    <attr-item tags="gen"/>
    <attr-item tags="ins"/>
    <attr-item tags="loc"/>
    <attr-item tags="nom"/>
    <attr-item tags="voc"/>
  </def-attr>
  <def-attr n="learned_person">
    <attr-item tags="p1"/>
    <attr-item tags="p2"/>
    <attr-item tags="p3"/>
  </def-attr>
  <def-attr n="learned_definiteness">
    <attr-item tags="def"/>
    <attr-item tags="ind"/>
  </def-attr>
  <def-attr n="learned_gender">
    <attr-item tags="f"/>
    <attr-item tags="m"/>
    <attr-item tags="ma"/>
    <attr-item tags="mfn"/>
    <attr-item tags="mi"/>
    <attr-item tags="nt"/>
  </def-attr>
  <def-attr n="learned_isadv">
    <attr-item tags="adv"/>
  </def-attr>
  <def-attr n="learned_isadvcg">
    <attr-item tags="@Adv←"/>
  </def-attr>
  <def-attr n="learned_isclt">
    <attr-item tags="clt"/>
  </def-attr>
  <def-attr n="learned_ispos">
    <attr-item tags="pos"/>
  </def-attr>
  <def-attr n="learned_isrefprn">
    <attr-item tags="ref"/>
  </def-attr>
  <def-attr n="learned_isrefvb">
    <attr-item tags="ref"/>
  </def-attr>
  <def-attr n="learned_issfx">
    <attr-item tags="sfx"/>
  </def-attr>
  <def-attr n="learned_isvbneg">
    <attr-item tags="neg"/>
  </def-attr>
  <def-attr n="learned_nptype">
    <attr-item tags="al"/>
    <attr-item tags="ant"/>
    <attr-item tags="cog"/>
    <attr-item tags="org"/>
    <attr-item tags="top"/>
  </def-attr>
  <def-attr n="learned_number">
    <attr-item tags="du"/>
    <attr-item tags="pl"/>
    <attr-item tags="sg"/>
    <attr-item tags="sp"/>
  </def-attr>
  <def-attr n="learned_numtype">
    <attr-item tags="coll"/>
    <attr-item tags="ord"/>
    <attr-item tags="percent"/>
  </def-attr>
  <def-attr n="learned_parttype">
    <attr-item tags="itg"/>
    <attr-item tags="neg"/>
  </def-attr>
  <def-attr n="learned_person">
    <attr-item tags="p1"/>
    <attr-item tags="p2"/>
    <attr-item tags="p3"/>
  </def-attr>
  <def-attr n="learned_premprntype">
    <attr-item tags="dem"/>
    <attr-item tags="ref"/>
    <attr-item tags="ref.pos"/>
    <attr-item tags="tot"/>
    <attr-item tags="pos"/>
<!--    <attr-item tags="itg"/>
    <attr-item tags="rel"/> in case future me decides to deal with this-->
  </def-attr>
  <def-attr n="learned_verbaspect">
    <attr-item tags="imperf"/>
    <attr-item tags="perf"/>
  </def-attr>
  <def-attr n="learned_relprntype">
    <attr-item tags="rel"/>
  </def-attr>
  <def-attr n="learned_verbtime">
    <attr-item tags="aor"/>
    <attr-item tags="futI"/>
    <attr-item tags="futII.pres"/>
    <attr-item tags="futII"/>
    <attr-item tags="imp"/>
    <attr-item tags="inf"/>
    <attr-item tags="lp"/>
    <attr-item tags="past"/>
    <attr-item tags="pii"/>
    <attr-item tags="pp"/>
    <attr-item tags="pprs"/>
    <attr-item tags="pres"/>
  </def-attr>
  <def-attr n="learned_verbtype">
    <attr-item tags="iv"/>
    <attr-item tags="tv"/>
  </def-attr>
  <def-attr n="learned_gen">
    <attr-item tags="m"/>
    <attr-item tags="f"/>
    <attr-item tags="mf"/>
    <attr-item tags="GD"/>
  </def-attr>
  <def-attr n="learned_num">
    <attr-item tags="sg"/>
    <attr-item tags="pl"/>
    <attr-item tags="sp"/>
    <attr-item tags="ND"/>
  </def-attr>
</section-def-attrs>
<section-def-vars>
  <def-var n="gender"/>
  <def-var n="number"/>
  <def-var n="caseFirstWord"/>	
  <def-var n="EOS" v="true"/>
  <def-var n="punct"/>
</section-def-vars>

<section-def-lists>

  <def-list n="only_def_in_HR">
      <list-item v="ekvilibristički"/>
      <list-item v="evolucijski"/>
      <list-item v="gospodarstveni"/>
      <list-item v="prvostupanjski"/>
      <list-item v="vanjski"/>
  </def-list>

</section-def-lists>
<section-def-macros>


<def-macro n="f_agreement" npar="2">
  <choose>
     <when>	  
	  <test> 
		<and>
			<or>
				<equal><!-- do the main and second parameter agree in gender in SL?-->
					<clip pos="2" side="sl" part="learned_gender"/>
					<clip pos="1" side="sl" part="learned_gender"/>
				</equal>
				<or>
					<and>
						<equal><!-- do the main and second parameter agree in gender in SL?-->
							<clip pos="1" side="sl" part="learned_gender"/>	
							<lit-tag n="ma"/>
						</equal>
						<equal><!-- do the main and second parameter agree in gender in SL?-->
							<clip pos="2" side="sl" part="learned_gender"/>
							<lit-tag n="mi"/>
						</equal>
					</and>
					<and>
						<equal><!-- do the main and second parameter agree in gender in SL?-->
							<clip pos="1" side="sl" part="learned_gender"/>
							<lit-tag n="mi"/>
						</equal>
						<equal><!-- do the main and second parameter agree in gender in SL?-->
							<clip pos="2" side="sl" part="learned_gender"/>
							<lit-tag n="ma"/>
						</equal>
					</and>
				</or>
			</or>
	            <equal><!-- do the main and second parameter agree in number in SL?-->
		       <clip pos="2" side="sl" part="learned_number"/>
		       <clip pos="1" side="sl" part="learned_number"/>
		    </equal>
	            <equal><!-- do the main and second parameter agree in case in SL?-->
		       <clip pos="2" side="sl" part="learned_case"/>
		       <clip pos="1" side="sl" part="learned_case"/>
		    </equal>
		</and>
	  </test>
          <!-- if yes, then make them agree in TL as well -->
          <let><clip pos="1" side="tl" part="learned_gender"/><clip pos="2" side="tl" part="learned_gender"/></let> 
          <let><clip pos="1" side="tl" part="learned_number"/><clip pos="2" side="tl" part="learned_number"/></let> 
          <let><clip pos="1" side="tl" part="learned_case"/><clip pos="2" side="tl" part="learned_case"/></let> 
	</when>
	<otherwise> 
				<let><clip pos="1" side="tl" part="learned_gender"/><clip pos="1" side="sl" part="learned_gender"/></let> 
		        <let><clip pos="1" side="tl" part="learned_number"/><clip pos="1" side="sl" part="learned_number"/></let> 
		        <let><clip pos="1" side="tl" part="learned_case"/><clip pos="1" side="sl" part="learned_case"/></let> 
	</otherwise>
      </choose>
    </def-macro>

<def-macro n="f_bcond" npar="2">
<!--To test whether a blank contains format information.
If no format information is present it is removed. -->
  <choose>
    <when>
      <test>
        <not>
	 <equal>
	   <b pos="1"/>
	   <lit v=" "/>
	 </equal>
	 </not>
      </test>
      <out>
        <b pos="1"/>
      </out>
    </when>
  </choose>
</def-macro>

<def-macro n="f_gender_num" npar="1">
<!--To set the global value storing the TL gender of the last seen word. -->
  <choose>
    <when>
      <test>
        <equal>
          <clip pos="1" side="tl" part="learned_gender"/>
          <lit-tag v="m"/>
        </equal>
      </test>
      <let><var n="gender"/><lit-tag v="m"/></let>
    </when>
    <when>
      <test>
        <equal>
          <clip pos="1" side="tl" part="learned_gender"/>
          <lit-tag v="f"/>
        </equal>
      </test>
      <let><var n="gender"/><lit-tag v="f"/></let>
    </when>
  </choose>
  <choose>
    <when>
      <test>
        <equal>
          <clip pos="1" side="tl" part="learned_number"/>
          <lit-tag v="sg"/>
        </equal>
      </test>
      <let><var n="number"/><lit-tag v="sg"/></let>
    </when>
    <when>
      <test>
        <equal>
          <clip pos="1" side="tl" part="learned_number"/>
          <lit-tag v="pl"/>
        </equal>
      </test>
      <let><var n="number"/><lit-tag v="pl"/></let>
    </when>
  </choose>
</def-macro>

<def-macro n="f_set_definiteness" npar="1">
  <choose>
    <when>
     <test>
       <in caseless="yes">
	 <clip pos="1" side="tl" part="lem"/>
	 <list n="only_def_in_HR"/>
       </in>
     </test>
     <let><clip pos="1" side="tl" part="learned_definiteness"/><lit-tag v="def"/></let>
    </when>
    <otherwise>
      <let>
         <clip pos="1" side="tl" part="learned_definiteness"/>
         <clip pos="1" side="sl" part="learned_definiteness"/>
      </let>
    </otherwise>
 </choose>
</def-macro>

  <def-macro n="firstWord" npar="1">
      <choose>
	<when>
	  <test>
	    <equal> 
	      <var n="EOS"/>
	      <lit v="true"/>
	    </equal> 
	  </test>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="Aa"/>
	  </let>
	</when>
	<otherwise> 
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>
</section-def-macros>
<section-rules>


    <!-- Noun phrases -->

    <rule comment="noun">
      <pattern>
	<pattern-item n="CAT__n_"/>
      </pattern>      
      <action>
        <out>
          <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


 <rule comment="adj or pp definiteness">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

 <rule comment="adj nom agreement, crveni paradajz -> crvena rajčica,  uzgojeni paradajz -> uzgojena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

 <rule comment="possessive adjective agreement, vojnikov paradajz; Mislavov računar -> vojnikova rajčica, Mislavovo računalo">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>

		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="3" side="tl" part="learned_gender"/>
		      <clip pos="3" side="tl" part="learned_number"/>
		      <clip pos="3" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
 </rule>


    <rule comment="adj adj nom, veliki crveni paradajz -> velika crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

 <rule comment="posadj + adj + nom agreement, vojnikov crveni paradajz; Mislavov veliki računar -> vojnikova crvena rajčica, Mislavovo veliko računalo">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
	   </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="3"/>
		<with-param pos="4"/>
       </call-macro> 
       
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="4" side="tl" part="learned_gender"/>
		      <clip pos="4" side="tl" part="learned_number"/>
		      <clip pos="4" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
 </rule>

 <rule comment="adj + posadj + nom agreement, crveni vojnikov paradajz; veliki Mislavov računar -> crvena vojnikova rajčica, veliko Mislavovo računalo">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
	   </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="1"/>
		<with-param pos="4"/>
       </call-macro> 
       
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="3" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
			<b pos="1"/>
		<mlu>
		  <lu>
			  <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_nom"/>
		      <clip pos="2" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_adjpp"/>
		      <clip pos="3" side="tl" part="learned_adjtype"/>
		      <clip pos="4" side="tl" part="learned_gender"/>
		      <clip pos="4" side="tl" part="learned_number"/>
		      <clip pos="4" side="tl" part="learned_case"/>
		      <clip pos="3" side="tl" part="learned_definiteness"/>
		      <clip pos="3" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
            <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
 </rule>


    <rule comment="adj adv adj nom, veliki danas crveni paradajz -> velika danas crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adv_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>       
      <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>  
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>


    <rule comment="adj adj adj nom.  veliki lepi crveni paradajz -> velika lijepa crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>


    <rule comment="adj adv adj adj nom.  veliki danas lepi crveni paradajz -> velika danas lijepa crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adv_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="5"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="5"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="4"/>
       <with-param pos="5"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="4"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	     <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adjpp"/>
	      <clip pos="4" side="tl" part="learned_adjtype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	        <clip pos="4" side="tl" part="learned_definiteness"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="learned_gender"/>
	      <clip pos="5" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

    <rule comment="adj adj adv adj nom.  veliki lepi danas crveni paradajz -> velika lijepa danas crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adv_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="5"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="5"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="4"/>
       <with-param pos="5"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="4"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	     <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adjpp"/>
	      <clip pos="4" side="tl" part="learned_adjtype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	        <clip pos="4" side="tl" part="learned_definiteness"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="learned_gender"/>
	      <clip pos="5" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>


 <rule comment="prn + nom agreement, moj računar -> moje računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>
    


    <rule comment="prn + adj + nom agreement, naš brzi računar -> naše brzo računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

<rule comment="prn + posadj + nom agreement, onaj Mislavov računar -> ono Mislavovo računalo">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
		<pattern-item n="CAT__n_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<mlu>
				<lu>
					<clip pos="2" side="tl" part="lemh"/>
					<clip pos="2" side="tl" part="a_nom"/>
					<clip pos="2" side="tl" part="learned_gender"/>
				</lu> 
				<lu>  
					<clip pos="3" side="tl" part="lemh"/>
					<clip pos="3" side="tl" part="a_adjpp"/>
					<clip pos="3" side="tl" part="learned_adjtype"/>
					<clip pos="4" side="tl" part="learned_gender"/>
					<clip pos="4" side="tl" part="learned_number"/>
					<clip pos="4" side="tl" part="learned_case"/>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<clip pos="3" side="tl" part="lemq"/>
				</lu>
	        </mlu>    
			<b pos="2"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
		</out>
	</action>
</rule>
    
<rule comment="prn + adv + adj + nom agreement, naš jako brzi računar -> naše jako brzo računalo">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom agreement, naš veliki brzi računar -> naše veliko brzo računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	</out>
      </action>
    </rule>

<rule comment="nom + prn.rel agreement: forma koja je čitljiva > oblik koji je čitljiv">
      <pattern>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
	<out>
  	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	        <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="2" side="tl" part="learned_relprntype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
        
	</out>
      </action>
    </rule>

 <rule comment="nom + vbser + adj agreement: forma je čitljiva > oblik je čitljiv">
      <pattern>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="3"/>
		<with-param pos="1"/>
		</call-macro>    
	<out>
  	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	        <b pos="1"/>
	    <lu>
   	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
        
	</out>
      </action>
    </rule>

 <rule comment="nom + vbser + posadj agreement: forma je autorova > oblik je autorov">
      <pattern>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="4"/>
		<with-param pos="1"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="1" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="1" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="4" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
  	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	        <b pos="1"/>
	    <lu>
   	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
		<mlu>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_nom"/>
				<clip pos="3" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_adjpp"/>
				<clip pos="4" side="tl" part="learned_adjtype"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="learned_definiteness"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
        </mlu>  
        
	</out>
      </action>
    </rule>

 <rule comment="nom + relprn + vbser + adj agreement: računar koji je brz > računalo koje je brzo">
      <pattern>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="4"/>
		<with-param pos="1"/>
		</call-macro>   
       <call-macro n="f_set_definiteness">
         <with-param pos="4"/>
       </call-macro>    
	<out>
  	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	        <b pos="1"/>
		<lu>
	      <clip pos="2" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="2" side="tl" part="learned_relprntype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
			<b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
		<lu>  
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_adjpp"/>
				<clip pos="4" side="tl" part="learned_adjtype"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="learned_definiteness"/>
				<clip pos="4" side="tl" part="lemq"/>
		</lu>        
	</out>
      </action>
    </rule>

 <rule comment="nom + relprn + vbser + posadj agreement: računar koji je autorov > računalo koje je autorovo">
      <pattern>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="5"/>
		<with-param pos="1"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="1" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="1" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="5" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
  	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	        <b pos="1"/>
		<lu>
	      <clip pos="2" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="2" side="tl" part="learned_relprntype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
			<b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
		<mlu>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_adjpp"/>
				<clip pos="5" side="tl" part="learned_adjtype"/>
				<clip pos="5" side="tl" part="learned_gender"/>
				<clip pos="5" side="tl" part="learned_number"/>
				<clip pos="5" side="tl" part="learned_case"/>
				<clip pos="5" side="tl" part="learned_definiteness"/>
				<clip pos="5" side="tl" part="lemq"/>
			</lu>
        </mlu>  
        
	</out>
      </action>
    </rule>

 <rule comment="adj + nom + relprn agreement, crveni paradajz koji -> crvena rajčica koja,  uzgojeni paradajz koji -> uzgojena rajčica koja">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>	    
	</out>
      </action>
    </rule>

 <rule comment="posadj + nom + relprn agreement, vojnikov paradajz koji; Mislavov računar koji -> vojnikova rajčica koja, Mislavovo računalo koje">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>

		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="3" side="tl" part="learned_gender"/>
		      <clip pos="3" side="tl" part="learned_number"/>
		      <clip pos="3" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
 </rule>


    <rule comment="adj + adj + nom + relprn, veliki crveni paradajz koji -> velika crvena rajčica koja">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>		    


	</out>
      </action>
    </rule>

 <rule comment="posadj + adj + nom + relprn agreement, vojnikov crveni paradajz koji; Mislavov veliki računar koji -> vojnikova crvena rajčica koja, Mislavovo veliko računalo koje">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
	   </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="3"/>
		<with-param pos="4"/>
       </call-macro> 
       
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="4" side="tl" part="learned_gender"/>
		      <clip pos="4" side="tl" part="learned_number"/>
		      <clip pos="4" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
 </rule>


    <rule comment="adj + adj + adj + nom + relprn.  veliki lepi crveni paradajz koji -> velika lijepa crvena rajčica koja">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
    </rule>


 <rule comment="prn + nom + relprn agreement, moj računar koji-> moje računalo koje">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>		    

	</out>
      </action>
    </rule>
    


    <rule comment="prn + adj + nom + relprn agreement, naš brzi računar koji -> naše brzo računalo koji">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
    </rule>

<rule comment="prn + posadj + nom + relprn agreement, onaj Mislavov računar koji -> ono Mislavovo računalo koje">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__relprn_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<mlu>
				<lu>
					<clip pos="2" side="tl" part="lemh"/>
					<clip pos="2" side="tl" part="a_nom"/>
					<clip pos="2" side="tl" part="learned_gender"/>
				</lu> 
				<lu>  
					<clip pos="3" side="tl" part="lemh"/>
					<clip pos="3" side="tl" part="a_adjpp"/>
					<clip pos="3" side="tl" part="learned_adjtype"/>
					<clip pos="4" side="tl" part="learned_gender"/>
					<clip pos="4" side="tl" part="learned_number"/>
					<clip pos="4" side="tl" part="learned_case"/>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<clip pos="3" side="tl" part="lemq"/>
				</lu>
	        </mlu>    
			<b pos="2"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="3"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		    
		</out>
	</action>
</rule>
    
<rule comment="prn + adv + adj + nom + relprn agreement, naš jako brzi računar koji -> naše jako brzo računalo koje">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__relprn_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		    
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom + relprn agreement, naš veliki brzi računar koji -> naše veliko brzo računalo koje">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
    </rule>

 <rule comment="adj + nom + vbser + adj agreement, crveni paradajz je odličan -> crvena rajčica je odlična,  uzgojeni paradajz je odličan -> uzgojena rajčica je odlična">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
	</pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="4"/>
		<with-param pos="2"/>
		</call-macro>
        <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
        <call-macro n="f_set_definiteness">
         <with-param pos="4"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adjpp"/>
	      <clip pos="4" side="tl" part="learned_adjtype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="learned_definiteness"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>	
	   </out>
      </action>
    </rule>

 <rule comment="posadj + nom + vbser + adj agreement, vojnikov paradajz je odličan; Mislavov računar je odličan -> vojnikova rajčica je odlična, Mislavovo računalo je odlično">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="5"/>
		<with-param pos="3"/>
		</call-macro>
        <call-macro n="f_set_definiteness">
         <with-param pos="5"/>
       </call-macro>
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="3" side="tl" part="learned_gender"/>
		      <clip pos="3" side="tl" part="learned_number"/>
		      <clip pos="3" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_adjpp"/>
	      <clip pos="5" side="tl" part="learned_adjtype"/>
	      <clip pos="5" side="tl" part="learned_gender"/>
	      <clip pos="5" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="learned_definiteness"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>	
	   </out>
      </action>
 </rule>


    <rule comment="adj + adj + nom + vbser + adj, veliki crveni paradajz je odličan -> velika crvena rajčica je odlična">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="5"/>
		<with-param pos="3"/>
		</call-macro>
        <call-macro n="f_set_definiteness">
         <with-param pos="5"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_adjpp"/>
	      <clip pos="5" side="tl" part="learned_adjtype"/>
	      <clip pos="5" side="tl" part="learned_gender"/>
	      <clip pos="5" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="learned_definiteness"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>	
	</out>
      </action>
    </rule>

 <rule comment="posadj + adj + nom + vbser + adj agreement, vojnikov crveni paradajz je odličan; Mislavov veliki računar je odličan -> vojnikova crvena rajčica je odlična, Mislavovo veliko računalo je odlično">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
	   </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="3"/>
		<with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
		<with-param pos="6"/>
		<with-param pos="4"/>
		</call-macro>
        <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>       
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="4" side="tl" part="learned_gender"/>
		      <clip pos="4" side="tl" part="learned_number"/>
		      <clip pos="4" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_adjpp"/>
	      <clip pos="6" side="tl" part="learned_adjtype"/>
	      <clip pos="6" side="tl" part="learned_gender"/>
	      <clip pos="6" side="tl" part="learned_number"/>
	      <clip pos="6" side="tl" part="learned_case"/>
	      <clip pos="6" side="tl" part="learned_definiteness"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>	
	</out>
      </action>
 </rule>


    <rule comment="adj + adj + adj + nom + vbser + adj.  veliki lepi crveni paradajz koji je krasan -> velika lijepa crvena rajčica koja je krasna">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="6"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_adjpp"/>
	      <clip pos="6" side="tl" part="learned_adjtype"/>
	      <clip pos="6" side="tl" part="learned_gender"/>
	      <clip pos="6" side="tl" part="learned_number"/>
	      <clip pos="6" side="tl" part="learned_case"/>
	      <clip pos="6" side="tl" part="learned_definiteness"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>	
	</out>
      </action>
    </rule>


 <rule comment="prn + nom + vbser + adj agreement, moj računar je brz -> moje računalo je brzo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>
	   <call-macro n="f_agreement">
       <with-param pos="4"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="4"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_adjpp"/>
	      <clip pos="4" side="tl" part="learned_adjtype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="learned_definiteness"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>		    
	</out>
      </action>
    </rule>
    

    <rule comment="prn + adj + nom + vbser + adj agreement, naš brzi računar je jeben -> naše brzo računalo je jebeno">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="5"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="5"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_adjpp"/>
	      <clip pos="5" side="tl" part="learned_adjtype"/>
	      <clip pos="5" side="tl" part="learned_gender"/>
	      <clip pos="5" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="learned_definiteness"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>		
	    </out>
      </action>
    </rule>

<rule comment="prn + posadj + nom + vbser + adj agreement, onaj Mislavov računar je jeben -> ono Mislavovo računalo je jebeno">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__vbser_"/>
		<pattern-item n="CAT__adjpp_"/>      
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>
		<call-macro n="f_agreement">
			<with-param pos="6"/>
			<with-param pos="4"/>
		</call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
   		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<mlu>
				<lu>
					<clip pos="2" side="tl" part="lemh"/>
					<clip pos="2" side="tl" part="a_nom"/>
					<clip pos="2" side="tl" part="learned_gender"/>
				</lu> 
				<lu>  
					<clip pos="3" side="tl" part="lemh"/>
					<clip pos="3" side="tl" part="a_adjpp"/>
					<clip pos="3" side="tl" part="learned_adjtype"/>
					<clip pos="4" side="tl" part="learned_gender"/>
					<clip pos="4" side="tl" part="learned_number"/>
					<clip pos="4" side="tl" part="learned_case"/>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<clip pos="3" side="tl" part="lemq"/>
				</lu>
	        </mlu>    
			<b pos="2"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_adjpp"/>
	      <clip pos="6" side="tl" part="learned_adjtype"/>
	      <clip pos="6" side="tl" part="learned_gender"/>
	      <clip pos="6" side="tl" part="learned_number"/>
	      <clip pos="6" side="tl" part="learned_case"/>
	      <clip pos="6" side="tl" part="learned_definiteness"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>		
		</out>
	</action>
</rule>
    
<rule comment="prn + adv + adj + nom + vbser + adj agreement, naš jako brzi računar je jeben -> naše jako brzo računalo je jebeno">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__vbser_"/>
		<pattern-item n="CAT__adjpp_"/>      
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
		<call-macro n="f_agreement">
			<with-param pos="6"/>
			<with-param pos="4"/>
		</call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
       		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_adjpp"/>
	      <clip pos="6" side="tl" part="learned_adjtype"/>
	      <clip pos="6" side="tl" part="learned_gender"/>
	      <clip pos="6" side="tl" part="learned_number"/>
	      <clip pos="6" side="tl" part="learned_case"/>
	      <clip pos="6" side="tl" part="learned_definiteness"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>		
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom + vbser + adj agreement, naš veliki brzi računar je jeben -> naše veliko brzo računalo je jebeno">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>      
	</pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
		<call-macro n="f_agreement">
			<with-param pos="6"/>
			<with-param pos="4"/>
		</call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
   	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_adjpp"/>
	      <clip pos="6" side="tl" part="learned_adjtype"/>
	      <clip pos="6" side="tl" part="learned_gender"/>
	      <clip pos="6" side="tl" part="learned_number"/>
	      <clip pos="6" side="tl" part="learned_case"/>
	      <clip pos="6" side="tl" part="learned_definiteness"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>		
	</out>
      </action>
    </rule>

 <rule comment="adj + nom + vbser + posadj agreement, crveni paradajz je Mislavov -> crvena rajčica je Mislavova,  uzgojeni paradajz je Mislavov -> uzgojena rajčica je Mislavova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="5"/>
		<with-param pos="2"/>
		</call-macro>         
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="5" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
		<mlu>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_adjpp"/>
				<clip pos="5" side="tl" part="learned_adjtype"/>
				<clip pos="5" side="tl" part="learned_gender"/>
				<clip pos="5" side="tl" part="learned_number"/>
				<clip pos="5" side="tl" part="learned_case"/>
				<clip pos="5" side="tl" part="learned_definiteness"/>
				<clip pos="5" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>


    <rule comment="adj + adj + nom, veliki crveni paradajz je Mislavov -> velika crvena rajčica je Mislavova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="6"/>
		<with-param pos="3"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="6" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<mlu>
			<lu>
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_nom"/>
				<clip pos="5" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>	

    <rule comment="adj + adj + adj + nom.  veliki lepi crveni paradajz  je Mislavov -> velika lijepa crvena rajčica je Mislavova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="7"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="7" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<mlu>
			<lu>
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_nom"/>
				<clip pos="6" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>	

 <rule comment="prn + nom + vbser + posadj agreement, onaj računar je Mislavov -> ono računalo je Mislavovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="5"/>
		<with-param pos="2"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="5" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
	    <lu>
   	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="3"/>
		<mlu>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_adjpp"/>
				<clip pos="5" side="tl" part="learned_adjtype"/>
				<clip pos="5" side="tl" part="learned_gender"/>
				<clip pos="5" side="tl" part="learned_number"/>
				<clip pos="5" side="tl" part="learned_case"/>
				<clip pos="5" side="tl" part="learned_definiteness"/>
				<clip pos="5" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>	
    


    <rule comment="prn + adj + nom + vbser + posadj agreement, onaj brzi računar je Mislavov -> ono brzo računalo je Mislavovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="6"/>
		<with-param pos="3"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="6" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<mlu>
			<lu>
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_nom"/>
				<clip pos="5" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>	

<rule comment="prn + adv + adj + nom + vbser + posadj agreement, onaj jako brzi računar je Mislavov -> ono jako brzo računalo je Mislavovo">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__vbser_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
		<call-macro n="f_agreement">
		<with-param pos="7"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="7" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>			
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<mlu>
			<lu>
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_nom"/>
				<clip pos="6" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
			</lu>
        </mlu> 
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom + vbser + posadj agreement, ovaj veliki brzi računar je Mislavov -> ovo veliko brzo računalo je Mislavovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
		<call-macro n="f_agreement">
		<with-param pos="7"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="7" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<mlu>
			<lu>
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_nom"/>
				<clip pos="6" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
			</lu>
        </mlu> 
       </out>
      </action>
    </rule>

 <rule comment="adj + nom + relprn + vbser + posadj agreement, crveni paradajz koj je velik -> crvena rajčica koja je velika,  uzgojeni paradajz koji je velik -> uzgojena rajčica koja je velika">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="5"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="5"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
			<b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<lu>  
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_adjpp"/>
				<clip pos="5" side="tl" part="learned_adjtype"/>
				<clip pos="5" side="tl" part="learned_gender"/>
				<clip pos="5" side="tl" part="learned_number"/>
				<clip pos="5" side="tl" part="learned_case"/>
				<clip pos="5" side="tl" part="learned_definiteness"/>
				<clip pos="5" side="tl" part="lemq"/>
		</lu>        
	</out>
      </action>
    </rule>

 <rule comment="posadj + nom + relprn + vbser + posadj agreement, vojnikov paradajz koji je velik; Mislavov računar koji je velik -> vojnikova rajčica koja je velika, Mislavovo računalo koje je veliko">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="6"/>
       <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>

		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="3" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="3" side="tl" part="learned_gender"/>
		      <clip pos="3" side="tl" part="learned_number"/>
		      <clip pos="3" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
		<lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
			<b pos="3"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
		</lu> 	</out>
      </action>
 </rule>


    <rule comment="adj + adj + nom, veliki crveni paradajz koji je neobuzdan -> velika crvena rajčica koja je neobuzdana">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="6"/>
       <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
    </rule>

 <rule comment="posadj + adj + nom + relprn + vbser + posadj agreement, vojnikov crveni paradajz koji je odličan; Mislavov veliki računar koji je odličan -> vojnikova crvena rajčica koja je odlična, Mislavovo veliko računalo koje je odlično">
      <pattern>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
	   </call-macro>
       <call-macro n="f_agreement">
		<with-param pos="3"/>
		<with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="7"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="7"/>
       </call-macro>      
		<choose>
	      <when>
	        <test>
				<or>
					<equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="nt"/>
	               </equal>
	               <equal>
						<clip pos="4" side="tl" part="learned_gender"/>
						<lit-tag v="f"/>
	               </equal>
				</or>       
	        </test>
	               <let>
					 <clip pos="2" side="tl" part="learned_definiteness"/>
	                 <lit-tag v="def"/>
	               </let>

	      </when>
	     </choose>
	<out>
		<mlu>
		  <lu>
			  <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="learned_gender"/>
	      </lu> 
	      <lu>  
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_adjpp"/>
		      <clip pos="2" side="tl" part="learned_adjtype"/>
		      <clip pos="4" side="tl" part="learned_gender"/>
		      <clip pos="4" side="tl" part="learned_number"/>
		      <clip pos="4" side="tl" part="learned_case"/>
		      <clip pos="2" side="tl" part="learned_definiteness"/>
		      <clip pos="2" side="tl" part="lemq"/>
	      </lu>
        </mlu>    
			<b pos="1"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
 </rule>


    <rule comment="adj + adj + adj + nom.  veliki lepi crveni paradajz koji je odličan -> velika lijepa crvena rajčica koja je odlična">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="7"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="7"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
    </rule>


 <rule comment="prn + nom + relprn + vbser + posadj agreement, moj računar koji je odličan -> moje računalo koje je odlično">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="5"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="5"/>
       </call-macro>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
			<b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<lu>  
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_adjpp"/>
				<clip pos="5" side="tl" part="learned_adjtype"/>
				<clip pos="5" side="tl" part="learned_gender"/>
				<clip pos="5" side="tl" part="learned_number"/>
				<clip pos="5" side="tl" part="learned_case"/>
				<clip pos="5" side="tl" part="learned_definiteness"/>
				<clip pos="5" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
    </rule>
    


    <rule comment="prn + adj + nom + relprn + vbser + posadj agreement, naš brzi računar koji je odličan -> naše brzo računalo koje je odlično">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="6"/>
       <with-param pos="3"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="6"/>
       </call-macro>
  	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
    </rule>

<rule comment="prn + posadj + nom + relprn + vbser + posadj agreement, onaj Mislavov računar koji je odličan -> ono Mislavovo računalo koje je odlično">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
		<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>
       <call-macro n="f_agreement">
       <with-param pos="7"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="7"/>
       </call-macro>
	<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<mlu>
				<lu>
					<clip pos="2" side="tl" part="lemh"/>
					<clip pos="2" side="tl" part="a_nom"/>
					<clip pos="2" side="tl" part="learned_gender"/>
				</lu> 
				<lu>  
					<clip pos="3" side="tl" part="lemh"/>
					<clip pos="3" side="tl" part="a_adjpp"/>
					<clip pos="3" side="tl" part="learned_adjtype"/>
					<clip pos="4" side="tl" part="learned_gender"/>
					<clip pos="4" side="tl" part="learned_number"/>
					<clip pos="4" side="tl" part="learned_case"/>
					<clip pos="3" side="tl" part="learned_definiteness"/>
					<clip pos="3" side="tl" part="lemq"/>
				</lu>
	        </mlu>    
			<b pos="2"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
		</lu> 
		</out>
	</action>
</rule>
    
<rule comment="prn + adv + adj + nom + relprn + vbser + posadj agreement, naš jako brzi računar koji je jeben -> naše jako brzo računalo koje je jebeno">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
       <call-macro n="f_agreement">
       <with-param pos="7"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="7"/>
       </call-macro>
	   <out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
		</lu> 
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom + relprn + vbser + posadj agreement, naš veliki brzi računar koji je jeben -> naše veliko brzo računalo koje je jebeno">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__adjpp_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
       <call-macro n="f_agreement">
       <with-param pos="7"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="7"/>
       </call-macro>
   	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
		</lu> 
	</out>
      </action>
    </rule>

 <rule comment="adj + nom + relprn + vbser + posadj agreement, crveni paradajz koji je Filipov -> crvena rajčica koji je Filipov,  uzgojeni paradajz koji je Filipov-> uzgojena rajčica koja je Filipova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="6"/>
		<with-param pos="2"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="6" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
			<b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<mlu>
			<lu>
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_nom"/>
				<clip pos="5" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>

    <rule comment="adj + adj + nom + relprn + vbser + posadj , veliki crveni paradajz koji je Filipov -> velika crvena rajčica koja je FIlipova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="7"/>
		<with-param pos="3"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="7" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<mlu>
			<lu>
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_nom"/>
				<clip pos="6" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>

    <rule comment="adj + adj + adj + nom + relprn + vbser + posadj .  veliki lepi crveni paradajz koji je Filipov -> velika lijepa crvena rajčica koja je Filipova">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>  
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="8"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="8" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<mlu>
			<lu>
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_nom"/>
				<clip pos="7" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="8" side="tl" part="lemh"/>
				<clip pos="8" side="tl" part="a_adjpp"/>
				<clip pos="8" side="tl" part="learned_adjtype"/>
				<clip pos="8" side="tl" part="learned_gender"/>
				<clip pos="8" side="tl" part="learned_number"/>
				<clip pos="8" side="tl" part="learned_case"/>
				<clip pos="8" side="tl" part="learned_definiteness"/>
				<clip pos="8" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>


 <rule comment="prn + nom + relprn + vbser + posadj  agreement, onaj računar koji je Filipov -> ono računalo koje je Filipovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
		<call-macro n="f_agreement">
		<with-param pos="6"/>
		<with-param pos="2"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="2" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="6" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	        <b pos="2"/>
		<lu>
	      <clip pos="3" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="3" side="tl" part="learned_relprntype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
			<b pos="3"/>
	    <lu>
   	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
		<mlu>
			<lu>
				<clip pos="5" side="tl" part="lemh"/>
				<clip pos="5" side="tl" part="a_nom"/>
				<clip pos="5" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_adjpp"/>
				<clip pos="6" side="tl" part="learned_adjtype"/>
				<clip pos="6" side="tl" part="learned_gender"/>
				<clip pos="6" side="tl" part="learned_number"/>
				<clip pos="6" side="tl" part="learned_case"/>
				<clip pos="6" side="tl" part="learned_definiteness"/>
				<clip pos="6" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>
    


    <rule comment="prn + adj + nom + relprn + vbser + posadj  agreement, onaj brzi računar koji je Filipov -> ono brzo računalo koje je Filipovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="3"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="3"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
		<call-macro n="f_agreement">
		<with-param pos="7"/>
		<with-param pos="3"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="3" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="7" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	        <b pos="3"/>
		<lu>
	      <clip pos="4" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="4" side="tl" part="learned_relprntype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
			<b pos="4"/>
	    <lu>
   	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="5"/>
		<mlu>
			<lu>
				<clip pos="6" side="tl" part="lemh"/>
				<clip pos="6" side="tl" part="a_nom"/>
				<clip pos="6" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_adjpp"/>
				<clip pos="7" side="tl" part="learned_adjtype"/>
				<clip pos="7" side="tl" part="learned_gender"/>
				<clip pos="7" side="tl" part="learned_number"/>
				<clip pos="7" side="tl" part="learned_case"/>
				<clip pos="7" side="tl" part="learned_definiteness"/>
				<clip pos="7" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>

    
<rule comment="prn + adv + adj + nom + relprn + vbser + posadj  agreement, onaj jako brzi računar koji je Filipov -> ono jako brzo računalo koje je Filipovo">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__relprn_"/>
		<pattern-item n="CAT__vbser_"/>
		<pattern-item n="CAT__alln_"/>		  
		<pattern-item n="CAT__posadj_"/>
	</pattern>
	<action>
		<call-macro n="f_agreement">
			<with-param pos="1"/>
			<with-param pos="4"/>
		</call-macro>  
		<call-macro n="f_agreement">
			<with-param pos="3"/>
			<with-param pos="4"/>
		</call-macro> 
		<call-macro n="f_set_definiteness">
			<with-param pos="3"/>
		</call-macro>
		<call-macro n="f_agreement">
		<with-param pos="8"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="8" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="8" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="4" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
			<lu>
				<clip pos="4" side="tl" part="lemh"/>
				<clip pos="4" side="tl" part="a_nom"/>
				<clip pos="4" side="tl" part="learned_gender"/>
				<clip pos="4" side="tl" part="learned_number"/>
				<clip pos="4" side="tl" part="learned_case"/>
				<clip pos="4" side="tl" part="lemq"/>
			</lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<mlu>
			<lu>
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_nom"/>
				<clip pos="7" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="8" side="tl" part="lemh"/>
				<clip pos="8" side="tl" part="a_adjpp"/>
				<clip pos="8" side="tl" part="learned_adjtype"/>
				<clip pos="8" side="tl" part="learned_gender"/>
				<clip pos="8" side="tl" part="learned_number"/>
				<clip pos="8" side="tl" part="learned_case"/>
				<clip pos="8" side="tl" part="learned_definiteness"/>
				<clip pos="8" side="tl" part="lemq"/>
			</lu>
        </mlu>  
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom + relprn + vbser + posadj  agreement, ovaj veliki brzi računar koji je Filipov -> ovo veliko brzo računalo koje je Filipovo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__relprn_"/>
	<pattern-item n="CAT__vbser_"/>
	<pattern-item n="CAT__alln_"/>		  
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
       <call-macro n="f_agreement">
       <with-param pos="1"/>
       <with-param pos="4"/>
       </call-macro>  
       <call-macro n="f_agreement">
       <with-param pos="2"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_agreement">
       <with-param pos="3"/>
       <with-param pos="4"/>
       </call-macro> 
       <call-macro n="f_set_definiteness">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="f_set_definiteness">
         <with-param pos="3"/>
       </call-macro>       
		<call-macro n="f_agreement">
		<with-param pos="8"/>
		<with-param pos="4"/>
		</call-macro>   
		<choose>
			<when>
				<test>
					<or>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="nt"/>
						</equal>
						<equal>
							<clip pos="4" side="tl" part="learned_gender"/>
							<lit-tag v="f"/>
						</equal>
					</or>       
				</test>
				<let>
					<clip pos="8" side="tl" part="learned_definiteness"/>
					<lit-tag v="def"/>
				</let>
			</when>
		</choose>		 
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
  	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="4" side="tl" part="learned_case"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	        <b pos="4"/>
		<lu>
	      <clip pos="5" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="5" side="tl" part="learned_relprntype"/>
	      <clip pos="4" side="tl" part="learned_gender"/>
	      <clip pos="4" side="tl" part="learned_number"/>
	      <clip pos="5" side="tl" part="learned_case"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
			<b pos="5"/>
	    <lu>
   	      <clip pos="6" side="tl" part="whole"/>
	    </lu>
            <b pos="6"/>
		<mlu>
			<lu>
				<clip pos="7" side="tl" part="lemh"/>
				<clip pos="7" side="tl" part="a_nom"/>
				<clip pos="7" side="tl" part="learned_gender"/>
			</lu> 
			<lu>  
				<clip pos="8" side="tl" part="lemh"/>
				<clip pos="8" side="tl" part="a_adjpp"/>
				<clip pos="8" side="tl" part="learned_adjtype"/>
				<clip pos="8" side="tl" part="learned_gender"/>
				<clip pos="8" side="tl" part="learned_number"/>
				<clip pos="8" side="tl" part="learned_case"/>
				<clip pos="8" side="tl" part="learned_definiteness"/>
				<clip pos="8" side="tl" part="lemq"/>
			</lu>
        </mlu>  
	</out>
      </action>
    </rule>

<!-- This is to deal with mistagged proper nouns (patterns like: opustošeni Putin, ovaj ženin...) --> 

 <rule comment="adj nom agreement, crveni paradajz -> crvena rajčica,  uzgojeni paradajz -> uzgojena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
            <b pos="1"/>
        <mlu>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="3" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>

    <rule comment="adj adj nom, veliki crveni paradajz -> velika crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
        <mlu>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="4" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>

    <rule comment="adj adv adj nom, veliki danas crveni paradajz -> velika danas crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adv_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
    </pattern>
      <action>       
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	        <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>  
            <b pos="3"/>
        <mlu>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="5" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>


    <rule comment="adj adj adj nom.  veliki lepi crveni paradajz -> velika lijepa crvena rajčica">
      <pattern>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>  
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_adjpp"/>
	      <clip pos="1" side="tl" part="learned_adjtype"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
                <clip pos="1" side="tl" part="learned_definiteness"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	        <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	        <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
        <mlu>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="5" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>

 <rule comment="prn + nom agreement, moj računar -> moje računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
   	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
        <mlu>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="3" side="tl" part="whole"/>
          </lu>
         </mlu>
     	</out>
      </action>
    </rule>
    


    <rule comment="prn + adj + nom agreement, naš brzi računar -> naše brzo računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
        <mlu>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="4" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>

    
<rule comment="prn + adv + adj + nom agreement, naš jako brzi računar -> naše jako brzo računalo">
	<pattern>
		<pattern-item n="CAT__premprn_"/>
		<pattern-item n="CAT__adv_"/>
		<pattern-item n="CAT__adjpp_"/>
		<pattern-item n="CAT__n_"/>
		<pattern-item n="CAT__posadj_"/>
	</pattern>
	<action>
		<out>
			<lu>
				<clip pos="1" side="tl" part="lemh"/>
				<lit-tag n="prn"/>
				<clip pos="1" side="tl" part="learned_premprntype"/>
				<clip pos="1" side="tl" part="learned_person"/>
				<clip pos="1" side="tl" part="learned_gender"/>
				<clip pos="1" side="tl" part="learned_number"/>
				<clip pos="1" side="tl" part="learned_case"/>
				<clip pos="1" side="tl" part="lemq"/>
			</lu>
			<b pos="1"/>
			<lu>
				<clip pos="2" side="tl" part="whole"/>
			</lu>
            <b pos="2"/>
			<lu>
				<clip pos="3" side="tl" part="lemh"/>
				<clip pos="3" side="tl" part="a_adjpp"/>
				<clip pos="3" side="tl" part="learned_adjtype"/>
				<clip pos="3" side="tl" part="learned_gender"/>
				<clip pos="3" side="tl" part="learned_number"/>
				<clip pos="3" side="tl" part="learned_case"/>
				<clip pos="3" side="tl" part="learned_definiteness"/>
				<clip pos="3" side="tl" part="lemq"/>
			</lu>
			<b pos="3"/>
        <mlu>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="5" side="tl" part="whole"/>
          </lu>
         </mlu>
		</out>
	</action>
</rule>



<rule comment="prn + adj + adj + nom agreement, naš veliki brzi računar -> naše veliko brzo računalo">
      <pattern>
	<pattern-item n="CAT__premprn_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__adjpp_"/>
	<pattern-item n="CAT__n_"/>
	<pattern-item n="CAT__posadj_"/>
      </pattern>
      <action>      
	<out>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit-tag n="prn"/>
	      <clip pos="1" side="tl" part="learned_premprntype"/>
	      <clip pos="1" side="tl" part="learned_person"/>
	      <clip pos="1" side="tl" part="learned_gender"/>
	      <clip pos="1" side="tl" part="learned_number"/>
	      <clip pos="1" side="tl" part="learned_case"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_adjpp"/>
	      <clip pos="2" side="tl" part="learned_adjtype"/>
	      <clip pos="2" side="tl" part="learned_gender"/>
	      <clip pos="2" side="tl" part="learned_number"/>
	      <clip pos="2" side="tl" part="learned_case"/>
	      <clip pos="2" side="tl" part="learned_definiteness"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_adjpp"/>
	      <clip pos="3" side="tl" part="learned_adjtype"/>
	      <clip pos="3" side="tl" part="learned_gender"/>
	      <clip pos="3" side="tl" part="learned_number"/>
	      <clip pos="3" side="tl" part="learned_case"/>
	      <clip pos="3" side="tl" part="learned_definiteness"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="3"/>
        <mlu>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="5" side="tl" part="whole"/>
          </lu>
         </mlu>
	</out>
      </action>
    </rule>
    

<!-- end this weird section --> 
    

<!-- end noun phrases --> 

<!-- Start verb related phrases -->

<rule comment="RULE: treba/trebalo + da + vb.pres = trebati.infofromvb + vblex.inf. Treba da lupam -> Trebam lupati, trebalo da okonča -> Trebao okončati">
  <pattern>
    <pattern-item n="CAT__trebati_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vblexmodpres_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
               <equal>
                 <clip pos="1" side="tl" part="learned_verbtime"/>
                 <lit-tag v="lp"/>
               </equal>
        </test>
       <out>
          <lu>
           <get-case-from pos="1">
            <lit v="trebati"/>
           </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <lit-tag v="nt"/> <!-- default gender until we have any idea on where to get it from -->
            <clip pos="3" side="sl" part="learned_number"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="sl" part="learned_verbcat"/>
            <clip pos="3" side="sl" part="learned_verbaspect"/>
            <clip pos="3" side="sl" part="learned_verbtype"/>
            <clip pos="3" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
      </out>
     </when>
     <otherwise>
       <out>
          <lu>
           <get-case-from pos="1">
            <lit v="trebati"/>
           </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="3" side="sl" part="learned_person"/>
            <clip pos="3" side="sl" part="learned_number"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="sl" part="learned_verbcat"/>
            <clip pos="3" side="sl" part="learned_verbaspect"/>
            <clip pos="3" side="sl" part="learned_verbtype"/>
            <clip pos="3" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
     </otherwise>
    </choose>
    <call-macro n="f_bcond">
       <with-param pos="2"/>
       <with-param pos="3"/>
    </call-macro>
</action>
</rule>


<rule comment="RULE: treba/trebalo + da + se + vb.pres = trebati.infofromvb + se + vblex.inf. Treba da se vb -> se treba + vb">
  <pattern>
    <pattern-item n="CAT__trebati_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__se_"/>
    <pattern-item n="CAT__vb_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
               <equal>
                 <clip pos="1" side="tl" part="learned_verbtime"/>
                 <lit-tag v="lp"/>
               </equal>
        </test>
       <out>
          <lu>
           <get-case-from pos="1">
            <clip pos="3" side="tl" part="lem"/>
           </get-case-from>
           <clip pos="3" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
           <get-case-from pos="3">
            <lit v="trebati"/>
           </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <lit-tag v="nt"/> <!-- default gender until we have any idea on where to get it from -->
            <clip pos="4" side="sl" part="learned_number"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>
     </when>
     <otherwise>
       <out>
          <lu>
           <get-case-from pos="1">
            <clip pos="3" side="tl" part="lem"/>
           </get-case-from>
           <clip pos="3" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
            <lit v="trebati"/>
            </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="4" side="sl" part="learned_person"/>
            <clip pos="4" side="sl" part="learned_number"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <lit-tag v="vblex"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
          </lu>
        </out>
     </otherwise>
    </choose>
    <call-macro n="f_bcond">
       <with-param pos="2"/>
       <with-param pos="3"/>
    </call-macro>
</action>
</rule>


<rule comment="RULE: trebalo + vbser + da + vbser + pp = trebati.infofromvblex + vbser + vbser.inf + pp. trebalo bi da bude provjeren -> trebao bi biti provjeren">
  <pattern>
    <pattern-item n="CAT__trebati_"/>
   <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__da_"/>
   <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__vblexpp_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test> 
          <or>
               <equal>
                 <clip pos="5" side="tl" part="learned_gender"/>
                 <lit-tag v="ma"/>
               </equal>   
               <equal>
                 <clip pos="5" side="tl" part="learned_gender"/>
                 <lit-tag v="mi"/>
               </equal> 
           </or>
        </test>
        <let> 
              <clip pos="1" side="tl" part="learned_gender"/>
              <lit-tag v="m"/>
        </let>
       </when>
       <otherwise>
        <let> 
              <clip pos="1" side="tl" part="learned_gender"/>
              <clip pos="5" side="tl" part="learned_gender"/>
        </let>
       </otherwise>
       </choose>
       <out>
          <lu>
             <get-case-from pos="1">
            <lit v="trebati"/>
           </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="1" side="tl" part="learned_verbtime"/>
            <clip pos="1" side="tl" part="learned_gender"/>
            <clip pos="5" side="tl" part="learned_number"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <lit-tag v="vbser"/>
            <clip pos="4" side="tl" part="learned_verbaspect"/>
            <clip pos="4" side="tl" part="learned_verbtype"/>
            <clip pos="4" side="tl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
      </out>
    <call-macro n="f_bcond">
       <with-param pos="3"/>
       <with-param pos="4"/>
    </call-macro>
</action>
</rule>

<rule comment="RULE: vbser + trebalo + da + vbser + pp = vbser +  trebati.infofromvblex + vbser.inf + pp. bi trebalo da bude provjeren -> bi trebao biti provjeren">
  <pattern>
   <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__trebati_"/>
    <pattern-item n="CAT__da_"/>
   <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__vblexpp_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test> 
          <or>
               <equal>
                 <clip pos="5" side="tl" part="learned_gender"/>
                 <lit-tag v="ma"/>
               </equal>   
               <equal>
                 <clip pos="5" side="tl" part="learned_gender"/>
                 <lit-tag v="mi"/>
               </equal> 
           </or>
        </test>
        <let> 
              <clip pos="2" side="tl" part="learned_gender"/>
              <lit-tag v="m"/>
        </let>
       </when>
       <otherwise>
        <let> 
              <clip pos="2" side="tl" part="learned_gender"/>
              <clip pos="5" side="tl" part="learned_gender"/>
        </let>
       </otherwise>
       </choose>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
          <get-case-from pos="2">
            <lit v="trebati"/>
          </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="2" side="tl" part="learned_verbtime"/>
            <clip pos="2" side="tl" part="learned_gender"/>
            <clip pos="5" side="tl" part="learned_number"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <lit-tag v="vbser"/>
            <clip pos="4" side="tl" part="learned_verbaspect"/>
            <clip pos="4" side="tl" part="learned_verbtype"/>
            <clip pos="4" side="tl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
      </out>
    <call-macro n="f_bcond">
       <with-param pos="4"/>
       <with-param pos="5"/>
    </call-macro>
</action>
</rule>

<rule comment="RULE: vbser + n + trebalo + da + vblex = vbser + n + trebati.infofromvblex + vblex.inf bi pregovori trebalo da počnu -> bi pregovori trebali početi">
  <pattern>
    <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__n_"/>
    <pattern-item n="CAT__trebati_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test> 
          <or>
               <equal>
                 <clip pos="2" side="tl" part="learned_gender"/>
                 <lit-tag v="ma"/>
               </equal>   
               <equal>
                 <clip pos="2" side="tl" part="learned_gender"/>
                 <lit-tag v="mi"/>
               </equal> 
           </or>
        </test>
        <let> 
              <clip pos="3" side="tl" part="learned_gender"/>
              <lit-tag v="m"/>
        </let>
       </when>
       <otherwise>
        <let> 
              <clip pos="3" side="tl" part="learned_gender"/>
              <clip pos="2" side="tl" part="learned_gender"/>
        </let>
       </otherwise>
       </choose>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="trebati"/>
            </get-case-from>
            <lit-tag v="vbmod"/>
            <clip pos="3" side="tl" part="learned_verbtime"/>
            <clip pos="3" side="tl" part="learned_gender"/>
            <clip pos="2" side="tl" part="learned_number"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <lit-tag v="vblex"/>
            <clip pos="5" side="tl" part="learned_verbaspect"/>
            <clip pos="5" side="tl" part="learned_verbtype"/>
            <clip pos="5" side="tl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
      </out>
    <call-macro n="f_bcond">
       <with-param pos="4"/>
       <with-param pos="5"/>
    </call-macro>
</action>
</rule>

<rule comment="RULE: vbmod + da + vblex.pres = vbmod + vblex.inf. Moram da lupam -> Moram lupati">
  <pattern>
    <pattern-item n="CAT__vbmodals_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="3" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="3" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="sl" part="learned_verbcat"/>
            <clip pos="3" side="sl" part="learned_verbaspect"/>
            <clip pos="3" side="sl" part="learned_verbtype"/>
            <clip pos="3" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vbmod + da + adv + vblex.pres = vbmod + adv + vblex.inf. Moram da jako lupam -> Moram jako lupati">
  <pattern>
    <pattern-item n="CAT__vbmodals_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__adv_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
	        <clip pos="3" side="tl" part="whole"/>
	      </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>          
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vbmod + adv + da + vblex.pres = vbmod + adv + vblex.inf. Moram jako da lupam -> Moram jako lupati">
  <pattern>
    <pattern-item n="CAT__vbmodals_"/>
    <pattern-item n="CAT__adv_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
	        <clip pos="2" side="tl" part="whole"/>
	      </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>          
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vblex.tv + da + vblex.pres/futII = vblex.tv + vblex.inf. Planiram da potrošim -> Planiram potrošiti">
  <pattern>
    <pattern-item n="CAT__vbtrans_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vblexpres_"/>
  </pattern>
  <action>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="sl" part="learned_verbcat"/>
            <clip pos="3" side="sl" part="learned_verbaspect"/>
            <clip pos="3" side="sl" part="learned_verbtype"/>
            <clip pos="3" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
</action>
</rule>


<rule comment="RULE: vblex.tv + da + se + vblex.pres/futII = vblex.tv + se + vblex.inf. Planiram da se naspavam -> Planiram se naspavati">
  <pattern>
    <pattern-item n="CAT__vbtrans_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__se_"/>    
    <pattern-item n="CAT__vblexpres_"/>
  </pattern>
  <action>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
			  <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>          
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
</action>
</rule>


<!-- if this VP is not at the beginning of the sentence, "se" should be at the beginning of the VP, Čovek mora da se lupa -> Čovjek se mora lupati.  -->
<rule comment="RULE: vbmodals + da + se + vblex.pres = vbmod/vblex + vblex.inf. Moram da se lupam -> Moram se lupati, početi da radim -> početi raditi">
  <pattern>
    <pattern-item n="CAT__vbmodals_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__se_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vblex + da + se + vblex.pres = vblex + vblex.inf. Uspela da se probije -> Uspjela se probiti">
  <pattern>
    <pattern-item n="CAT__vblex_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__se_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vblex.perf + vbser + da + se + vblex.pres = vblex.perf + vblex.inf. Uspjela je da se probije -> Uspjela se probiti">
  <pattern>
    <pattern-item n="CAT__vblex_"/>
    <pattern-item n="CAT__vbser_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__se_"/>
    <pattern-item n="CAT__vblex_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
           <equal>
             <clip pos="2" side="sl" part="learned_verbtime"/>
             <lit-tag v="pres"/>
           </equal> 
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="sl" part="learned_verbcat"/>
            <clip pos="5" side="sl" part="learned_verbaspect"/>
            <clip pos="5" side="sl" part="learned_verbtype"/>
            <clip pos="5" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE: vbmod/vblex + da + će + da + vblex.pres = vbmod/vblex + da + će + vblex.inf Znači da će da živi -> Znači da će živjeti">
  <pattern>
    <pattern-item n="CAT__vb_"/> <!-- not only vbmod, but all -->
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__htjeticlt_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vb_"/><!-- not only vblex, but all -->
  </pattern>
  <action>
    <out>
      <lu>
        <clip pos="1" side="tl" part="whole"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="whole"/>
      </lu>
      <b pos="2"/>
      <lu>
        <clip pos="3" side="tl" part="whole"/>
      </lu>
      <b pos="3"/>
      <lu>
        <clip pos="5" side="tl" part="lemh"/>
        <clip pos="5" side="sl" part="learned_verbcat"/>
        <clip pos="5" side="sl" part="learned_verbaspect"/>
        <clip pos="5" side="sl" part="learned_verbtype"/>
        <clip pos="5" side="sl" part="learned_isrefvb"/>
        <lit-tag v="inf"/>
        <clip pos="5" side="tl" part="lemq"/>
      </lu>
    </out>      
    <call-macro n="f_bcond">
      <with-param pos="4"/>
      <with-param pos="5"/>
    </call-macro>     
  </action>
</rule>


<!--
<rule comment="RULE: vbmod/vblex + da + vblex.pres + da + vblex.pres = vbmod/vblex + vblex.inf. + vblex.inf Moram da pocnem da lupam -> Moram poceti lupati">
  <pattern>
    <pattern-item n="CAT__vb_"/> 
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vb_"/>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vb_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <and>
               <equal>
                 <clip pos="3" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="5" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal>
           </and>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="sl" part="learned_verbcat"/>
            <clip pos="3" side="sl" part="learned_verbaspect"/>
            <clip pos="3" side="sl" part="learned_verbtype"/>
            <clip pos="3" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="sl" part="learned_verbcat"/>
            <clip pos="5" side="sl" part="learned_verbaspect"/>
            <clip pos="5" side="sl" part="learned_verbtype"/>
            <clip pos="5" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>     
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>
-->

<rule comment="RULE: vbmod/vblex + da + adv + vblex.pres = vbmod/vblex + adv + vblex.inf. Moram da danas lupam -> Moram danas lupati, početi da danas radim -> početi danas raditi">
  <pattern>
    <pattern-item n="CAT__vb_"/> <!-- not only vbmod, but all -->
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__adv_"/>
    <pattern-item n="CAT__vb_"/><!-- not only vblex, but all -->
  </pattern>
  <action>
    <choose>
      <when>
        <test>
          <or>
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="pres"/>
               </equal> 
               <equal>
                 <clip pos="4" side="tl" part="learned_verbtime"/>
                 <lit-tag v="futII.pres"/>
               </equal>
          </or>
        </test>
       <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="learned_verbcat"/>
            <clip pos="1" side="sl" part="learned_isclt"/>
            <clip pos="1" side="sl" part="learned_verbaspect"/>
            <clip pos="1" side="sl" part="learned_verbtype"/>
            <clip pos="1" side="sl" part="learned_isrefvb"/>
            <clip pos="1" side="sl" part="learned_verbtime"/>
            <clip pos="1" side="sl" part="learned_isadv"/>
            <clip pos="1" side="sl" part="learned_issfx"/>
            <clip pos="1" side="sl" part="learned_person"/>
            <clip pos="1" side="sl" part="learned_gender"/>
            <clip pos="1" side="sl" part="learned_number"/>
            <clip pos="1" side="sl" part="learned_case"/>
            <clip pos="1" side="sl" part="learned_definiteness"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="sl" part="learned_verbcat"/>
            <clip pos="4" side="sl" part="learned_verbaspect"/>
            <clip pos="4" side="sl" part="learned_verbtype"/>
            <clip pos="4" side="sl" part="learned_isrefvb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
      </out>      
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
     </when>
    <otherwise>
       <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/> 
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
      </out>
    </otherwise>
    </choose>
</action>
</rule>


<rule comment="RULE: da li + vb = vb + li. da li možeš -> možeš li">
  <pattern>
    <pattern-item n="CAT__da_li_"/>
    <pattern-item n="CAT__vblexmodpres_"/>
  </pattern>
  <action>
     <out>
          <lu>
            <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="sl" part="learned_verbcat"/>
            <clip pos="2" side="sl" part="learned_verbaspect"/>
            <clip pos="2" side="sl" part="learned_verbtype"/>
            <clip pos="2" side="sl" part="learned_isrefvb"/>
            <clip pos="2" side="sl" part="learned_verbtime"/>
            <clip pos="2" side="sl" part="learned_isadv"/>
            <clip pos="2" side="sl" part="learned_issfx"/>
            <clip pos="2" side="sl" part="learned_person"/>
            <clip pos="2" side="sl" part="learned_number"/>
            <clip pos="2" side="sl" part="learned_gender"/>
            <clip pos="2" side="sl" part="learned_case"/>
            <clip pos="2" side="sl" part="learned_definiteness"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="li"/>
            <lit-tag v="part.itg"/>
          </lu>
      </out>
</action>
</rule>

<rule comment="RULE: da li + vbclt = vb + li. da li sam/ću/bi -> jesam/hoću/bi li">
  <pattern>
    <pattern-item n="CAT__da_li_"/>
    <pattern-item n="CAT__vbclt_"/>
  </pattern>
  <action>
    <choose>
      <when>
        <test>
               <equal>
                 <clip pos="2" side="tl" part="learned_verbtime"/>
                 <lit-tag v="aor"/>
               </equal>
        </test>
     <out>
          <lu>
            <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="sl" part="learned_verbcat"/>
            <clip pos="2" side="sl" part="learned_isclt"/>
            <clip pos="2" side="sl" part="learned_verbaspect"/>
            <clip pos="2" side="sl" part="learned_verbtype"/>
            <clip pos="2" side="sl" part="learned_isrefvb"/>
            <clip pos="2" side="sl" part="learned_verbtime"/>
            <clip pos="2" side="sl" part="learned_isadv"/>
            <clip pos="2" side="sl" part="learned_issfx"/>
            <clip pos="2" side="sl" part="learned_person"/>
            <clip pos="2" side="sl" part="learned_number"/>
            <clip pos="2" side="sl" part="learned_gender"/>
            <clip pos="2" side="sl" part="learned_case"/>
            <clip pos="2" side="sl" part="learned_definiteness"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="li"/>
            <lit-tag v="part.itg"/>
          </lu>
      </out>

     </when>
     <otherwise>
		 <choose>
			<when>
				<test>
					<equal>
						<clip pos="2" side="sl" part="tags"/>
						<lit-tag v="vbser.clt.pres.p3.sg"/>
					</equal>
				</test>
				<out>
		          <lu>
					<get-case-from pos="1">
						<clip pos="2" side="tl" part="lemh"/>
		            </get-case-from>
		            <clip pos="2" side="sl" part="learned_verbcat"/>
		            <clip pos="2" side="sl" part="learned_isclt"/>
		            <clip pos="2" side="sl" part="learned_verbaspect"/>
		            <clip pos="2" side="sl" part="learned_verbtype"/>
		            <clip pos="2" side="sl" part="learned_isrefvb"/>
		            <lit-tag v="pres"/>
		            <clip pos="2" side="sl" part="learned_isadv"/>
		            <clip pos="2" side="sl" part="learned_issfx"/>
		            <clip pos="2" side="sl" part="learned_person"/>
		            <clip pos="2" side="sl" part="learned_number"/>
		            <clip pos="2" side="sl" part="learned_gender"/>
		            <clip pos="2" side="sl" part="learned_case"/>
		            <clip pos="2" side="sl" part="learned_definiteness"/>
		            <clip pos="2" side="tl" part="lemq"/>
		          </lu>
		          <b pos="1"/>
		          <lu>
		            <lit v="li"/>
		            <lit-tag v="part.itg"/>
		          </lu>
				</out>
			</when>
			<otherwise>
       <out>
          <lu>
	   <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="sl" part="learned_verbcat"/>
            <clip pos="2" side="sl" part="learned_verbaspect"/>
            <clip pos="2" side="sl" part="learned_verbtype"/>
            <clip pos="2" side="sl" part="learned_isrefvb"/>
            <lit-tag v="pres"/>
            <clip pos="2" side="sl" part="learned_isadv"/>
            <clip pos="2" side="sl" part="learned_issfx"/>
            <clip pos="2" side="sl" part="learned_person"/>
            <clip pos="2" side="sl" part="learned_number"/>
            <clip pos="2" side="sl" part="learned_gender"/>
            <clip pos="2" side="sl" part="learned_case"/>
            <clip pos="2" side="sl" part="learned_definiteness"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="li"/>
            <lit-tag v="part.itg"/>
          </lu>
      </out>
	</otherwise>
    </choose>

     </otherwise>
    </choose>
</action>
</rule>

<rule comment="RULE (at the beginning of sentence or after a comma): da + bi (vbser.aor) + vblex.lp = kako + bi (vbser.aor) + vblex.lp. Da bi izgledao -> Kako bi izgledao">
  <pattern>
    <pattern-item n="CAT__da_"/>
    <pattern-item n="CAT__vbseraor_"/>
    <pattern-item n="CAT__vblexlp_"/>
  </pattern>
  <action>
	  <choose>
		<when>
			<test>
                             <or>
				<equal caseless="no">
				  <clip pos="1" side="sl" part="lem"/>
				  <lit v="Da"/>
				</equal>
				<equal>
					<var n="punct"/>
					<lit v="true"/>
				</equal>
                             </or>
			</test>
	       <out>
	          <lu>
				<get-case-from pos="1">  
    	            <lit v="kako"/>
	            </get-case-from>
	            <lit-tag v="cnjsub"/>
	          </lu>
	          <b pos="1"/>
	          <lu>
	            <clip pos="2" side="tl" part="whole"/>
	          </lu>
	          <b pos="2"/>
	          <lu>
	            <clip pos="3" side="tl" part="whole"/>
	          </lu>
	        </out>
		  <let>
			<var n="punct"/>
			<lit v="false"/>
		  </let>
		</when>
		<otherwise>
		    <out>
			  <lu>
				<clip pos="1" side="tl" part="whole"/>	
			  </lu>
	          <b pos="1"/>
	          <lu>
				<clip pos="2" side="tl" part="whole"/>	
	          </lu>
	          <b pos="2"/>
	          <lu>
	            <clip pos="3" side="tl" part="whole"/>
	          </lu>
	        </out>
		</otherwise>
  	  </choose>
</action>
</rule>

<!-- end verb related phrases -->

<rule comment="RULE: ne/ni + vbhtjetibiti = nevb -> neće -> neće, ni sam -> nisam check">
  <pattern>
    <pattern-item n="CAT__nepart_"/>
    <pattern-item n="CAT__vbhtjetibitineg_"/>
  </pattern>
  <action>
    <out>
      <mlu>
        <lu>
          <clip pos="1" side="tl" part="whole"/>
        </lu>
        <lu>
          <clip pos="2" side="tl" part="whole"/>
        </lu>
      </mlu>
    </out>
  </action>
</rule>


<rule comment="RULE: np + pos = nppos -> Marko ov -> Markov check ">
  <pattern>
    <pattern-item n="CAT__np_"/>  
    <pattern-item n="CAT__posadj_"/>
  </pattern>
  <action>
       <out>
        <mlu>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="2" side="tl" part="whole"/>
          </lu>
         </mlu>
      </out>
</action>
</rule>


<rule comment="RULE: n + pos = nppos -> brod ov -> brodov check ">
  <pattern>
    <pattern-item n="CAT__n_"/>  
    <pattern-item n="CAT__posadj_"/>
  </pattern>
  <action>
       <out>
        <mlu>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <lu>
             <clip pos="2" side="tl" part="whole"/>
          </lu>
         </mlu>
      </out>
</action>
</rule>




<rule comment="RULE: inf + clt = infclt, pripremićemo -> pripremit ćemo">
  <pattern>
    <pattern-item n="CAT__vbinf_"/>
    <pattern-item n="CAT__htjeticlt_"/>
  </pattern>
  <action>
     <out>
       <mlu>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
       </mlu>
     </out>
</action>
</rule>





<rule comment=" RULE 36 punctuation">
<pattern><pattern-item n="sent"/></pattern><action> <let><var n="number"/> <lit-tag v="sg"/></let><let><var n="gender"/><lit-tag v="m"/></let> <out><lu><clip pos="1" side="tl" part="whole"/></lu></out></action><!--isolated word-->
</rule>

<rule comment=" RULE coma and sent">
<pattern><pattern-item n="comma"/></pattern><action> <let><var n="punct"/> <lit v="true"/></let><out><lu><clip pos="1" side="tl" part="whole"/></lu></out></action><!--isolated word-->
</rule>

<rule comment=" RULE 37 any word">
<pattern><pattern-item n="any"/></pattern><action>  <out><lu><clip pos="1" side="tl" part="whole"/></lu></out> </action><!--isolated word-->
</rule>


</section-rules>
</transfer>
